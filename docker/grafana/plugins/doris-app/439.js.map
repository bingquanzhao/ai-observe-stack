{"version":3,"file":"439.js?_cache=628e418786cac469a174","mappings":"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","sources":["webpack://doris-app/./store/discover.ts","webpack://doris-app/./types/type.ts","webpack://doris-app/./services/metaservice.ts","webpack://doris-app/./utils/data.ts"],"sourcesContent":["import { atom } from 'jotai';\nimport { atomWithStorage, selectAtom } from 'jotai/utils';\n// import { focusAtom } from 'jotai-optics'\nimport { atomWithLocation } from 'jotai-location';\nimport { DataSourceInstanceSettings, DataSourceJsonData } from '@grafana/data';\nimport { Dayjs } from 'dayjs';\nimport { DataFilterType, DiscoverCurrent, IntervalEnum, ShortcutItem } from 'types/type';\nimport { AggregatableEnum, DISCOVER_DEFAULT_STATUS, DISCOVER_SHORTCUTS, FieldTypeEnum, SearchableEnum } from 'utils/data';\n\nexport const locationAtom = atomWithLocation();\nexport const dataFilterAtom = atom<DataFilterType[]>([]);\nexport const discoverCurrentAtom = atomWithStorage<DiscoverCurrent>('discover-current', DISCOVER_DEFAULT_STATUS);\n\n// databases\nexport const databasesAtom = atom<any>([]);\nexport const settingDatabasesAtom = atom<any>([]);\nexport const tablesAtom = atomWithStorage<any>('discover-tables', []);\nexport const settingTablesAtom = atom<any>([]);\n\nexport const currentCatalogAtom = atomWithStorage<string>('discover-current-catalog', 'internal');\nexport const searchTypeAtom = atomWithStorage<'SQL' | 'Search' | 'Lucene'>('discover-search-type', 'Lucene');\nexport const currentDatabaseAtom = selectAtom(discoverCurrentAtom, current => current.database);\nexport const currentTableAtom = atomWithStorage<string>('discover-current-table', '');\nexport const currentClusterAtom = atom('');\nexport const currentTimeFieldAtom = selectAtom(discoverCurrentAtom, current => current.timeField);\nexport const currentDateAtom = atom<Dayjs[]>( DISCOVER_SHORTCUTS[2].range());\nexport const currentIndexAtom = atom<any>([]);\nexport const selectedIndexesAtom = atom<any>([]);\nexport const searchValueAtom = atom('');\nexport const searchFocusAtom = atom(false);\nexport const activeShortcutAtom = atom<ShortcutItem | undefined>(DISCOVER_SHORTCUTS[2]);\nexport const dorisInfoAtom = atom<any>({});\nexport const disabledOptionsAtom = atom<string[]>([]);\n\nexport const selectedFieldsAtom = atom<any[]>([]);\nexport const tableFieldsAtom = atomWithStorage<any[]>('discover-table-fields', []);\n\nexport const timeFieldsAtom = atomWithStorage<any[]>('discover-time-fields',[]);\nexport const tableDataAtom = atom<any[]>([]);\nexport const topDataAtom = atom<any[]>([]);\nexport const surroundingTableDataAtom = atom<any[]>([]);\nexport const tableDataChartsAtom = atom<any[]>([]);\nexport const intervalAtom = atom<IntervalEnum>(IntervalEnum.Auto);\nexport const tableTotalCountAtom = atom<number>(0);\nexport const tableEChartsDataAtom = atom<any[]>([]);\nexport const tableTracesDataAtom = atom<any>();\n\n// Filter Content Atom\nexport const searchableAtom = atom<SearchableEnum>(SearchableEnum.ANY);\nexport const aggregatableAtom = atom<AggregatableEnum>(AggregatableEnum.ANY);\nexport const fieldTypeAtom = atom<FieldTypeEnum>(FieldTypeEnum.ANY);\nexport const indexesAtom = atom<any[]>([]);\nexport const selectedRowAtom = atom<any>({});\nexport const tableFieldValuesAtom = atom<Array<{ label: string; value: string }>>([]);\n\nexport const pageAtom = atom<number>(1);\nexport const pageSizeAtom = atomWithStorage<number>('discover-pagination-size', 50);\n\n// Surrounding Data Atoms\nexport const surroundingDataFilterAtom = atom<DataFilterType[]>([]);\nexport const beforeTimeFieldPageSizeAtom = atom<number>(5);\nexport const afterTimeFieldPageSizeAtom = atom<number>(5);\nexport const beforeTimeAtom = atom<string>('');\nexport const afterTimeAtom = atom<string>('');\nexport const beforeCountAtom = atom<number>(0);\nexport const afterCountAtom = atom<number>(0);\nexport const surroundingTableFieldsAtom = atom<any[]>([]);\nexport const surroundingSelectedFieldsAtom = atom<any[]>([]);\n\nexport const datasourcesAtom = atom<Array<DataSourceInstanceSettings<DataSourceJsonData>>>([]);\nexport const selectedDatasourceAtom = atomWithStorage<DataSourceInstanceSettings<DataSourceJsonData> | undefined>('discover-selected-datasource', undefined);\nexport const timeRangeAtom = atom<any>({\n    from: DISCOVER_SHORTCUTS[2].range()[0].toDate(),\n    to: DISCOVER_SHORTCUTS[2].range()[1].toDate(),\n    raw: DISCOVER_SHORTCUTS[2].raw,\n});\n\n\nexport const discoverLoadingAtom = atom({\n    getTableData: false,\n    getTopData: false,\n    getSurroundingData: false,\n    getTableDataCharts: false,\n    getTableFieldValues: false,\n    getIndexes: false,\n    getTimeFields: false,\n    getTableFields: false,\n});\n","import dayjs, { Dayjs, ManipulateType } from \"dayjs\";\n\nexport interface QueryTableDataParams {\n    catalog: string;\n    database: string;\n    table: string;\n    cluster: string;\n    startDate: string;\n    endDate: string;\n    sort: string;\n    timeField: string;\n    data_filters: any[];\n    interval?: IntervalEnum;\n    interval_value?: number;\n    search_type: string;\n    search_value: string;\n    indexes?: string;\n    indexes_statement?: string;\n    page: string;\n    page_size: number;\n    lucene_where?: string;\n}\n\n\nexport interface SurroundingParams {\n    catalog: string;\n    database: string;\n    table: string;\n    cluster: string;\n    timeField: string;\n    time: string;\n    data_filters: any;\n    pageSize: string;\n    operator: '>' | '<';\n    theme: string | undefined;\n}\n\nexport interface DataFilterType {\n    fieldName: string;\n    operator: Operator;\n    value: Array<string | number>;\n    label?: string;\n    id: string;\n}\n\nexport type Operator =\n    | '='\n    | '!='\n    | 'in'\n    | 'not in'\n    | 'is null'\n    | 'is not null'\n    | 'between'\n    | 'not between'\n    | 'like'\n    | 'not like'\n    | 'match_all'\n    | 'match_any'\n    | 'match_phrase'\n    | 'match_phrase_prefix';\n\nexport interface DiscoverCurrent {\n    catalog: string;\n    database: string;\n    table: string;\n    cluster: string;\n    timeField: string;\n    date: [Dayjs, Dayjs] | [];\n}\n\nexport enum IntervalEnum {\n    Auto = 'auto',\n    Day = 'day',\n    Week = 'week',\n    Month = 'month',\n    Year = 'year',\n    Hour = 'hour',\n    Minute = 'minute',\n    Second = 'second',\n}\n\n\nexport type ShortcutItem = {\n    key: string;\n    text: string;\n    label: string;\n    range: (now?: dayjs.Dayjs) => dayjs.Dayjs[];\n    format: string;\n    type: string;\n    number: number;\n}\n\nexport interface QueryTableFieldsParams {\n    catalog: string;\n    database: string;\n    table: string;\n    describe_extend_variant_column?: string;\n}\n\nexport type FieldNode = {\n    name: string;\n    type: string;\n    children?: FieldNode[];\n    Null?: string;\n    Key?: string;\n    Default?: string | null;\n    Extra?: string;\n    Comment?: string;\n    Visible?: string;\n};\n\n\nexport interface RequestParams {\n    catalog: string;\n    database: string;\n    table: string;\n    describe_extend_variant_column?: boolean;\n}\n\nexport interface QueryTableIndexesParams {\n    catalog: string;\n    database: string;\n    table: string\n}\n\nexport interface QueryTableParams {\n    catalog: string;\n    database: string;\n}\n\nexport type AutoInterval = {\n    current_date_range: number;\n    current_type: ManipulateType;\n    interval_unit: ManipulateType;\n    interval_value: number;\n};\n\n\nexport type Frame = {\n    schema: {\n        fields: Array<{ name: string }>;\n    };\n    data: {\n        values: any[][];\n    };\n};\n\nexport type Result = {\n    frames: Frame[];\n};\n\nexport type Root = {\n    results: Record<string, Result>;\n};\n\nexport type QueryTracesParams = {\n    database: string;\n    table: string;\n    timeField: string;\n    startDate: string;\n    endDate: string;\n    service_name?: string;\n    operation?: string;\n    statusCode?: string;\n    minDuration?: string;\n    maxDuration?: string;\n    tags?: string;\n    page?: number;\n    page_size?: number;\n    sortBy?: string;\n};\n\nexport type TracesServicesParams = {\n  table: string;\n  timeField: string;\n  startDate: string;\n  endDate: string;\n};\n\nexport type TracesOperationsParams = {\n  table: string;\n  timeField: string;\n  startDate: string;\n  endDate: string;\n  service_name: string;\n};\n","import { toDataFrame } from '@grafana/data';\nimport { getBackendSrv } from '@grafana/runtime';\nimport { lastValueFrom } from 'rxjs';\n\ntype GetColumnParams = {\n    connectionId: string;\n    database: string;\n    table: string;\n    column: string;\n    datasourceType?: string;\n};\n\ntype ColumnMetadata = {\n    name: string;\n    dataType?: string;\n    columnType?: string;\n};\n\ntype GetIndexesParams = {\n    connectionId: string;\n    database: string;\n    table: string;\n    datasourceType?: string;\n};\n\nconst escapeSqlLiteral = (value: string) => value.replace(/'/g, \"''\");\n\nconst normalizeColumnType = ({ dataType, columnType }: { dataType?: string; columnType?: string }): string => {\n    const source = (columnType || dataType || '').trim();\n    if (!source) {\n        return '';\n    }\n\n    const lower = source.toLowerCase();\n\n    if (lower.startsWith('nullable(') && lower.endsWith(')')) {\n        const inner = source.slice(9, -1);\n        const normalizedInner = normalizeColumnType({ dataType: inner, columnType: undefined });\n        return normalizedInner ? `Nullable(${normalizedInner})` : source;\n    }\n\n    if (lower.startsWith('map')) {\n        return source.replace(/^map/i, 'Map');\n    }\n\n    if (lower.startsWith('array')) {\n        return source.replace(/^array/i, 'Array');\n    }\n\n    if (lower.startsWith('json') || lower.startsWith('variant')) {\n        return 'JSON';\n    }\n\n    if (lower === 'bool' || lower === 'boolean' || lower.startsWith('tinyint(1)')) {\n        return 'Bool';\n    }\n\n    if (lower.startsWith('tinyint')) {\n        return 'Int8';\n    }\n\n    if (lower.startsWith('smallint')) {\n        return 'Int16';\n    }\n\n    if (lower.startsWith('mediumint')) {\n        return 'Int32';\n    }\n\n    if (lower.startsWith('bigint') || lower.startsWith('int') || lower.startsWith('integer')) {\n        return 'Int64';\n    }\n\n    if (lower.startsWith('float') || lower.startsWith('double') || lower.startsWith('real')) {\n        return 'Float64';\n    }\n\n    if (lower.startsWith('decimal') || lower.startsWith('numeric')) {\n        return 'Float64';\n    }\n\n    if (lower.startsWith('date')) {\n        return source.replace(/^date/i, 'Date');\n    }\n\n    if (lower.startsWith('timestamp') || lower.startsWith('datetime')) {\n        return 'DateTime';\n    }\n\n    if (lower.startsWith('enum')) {\n        return source.replace(/^enum/i, 'Enum');\n    }\n\n    if (lower.startsWith('uuid')) {\n        return 'UUID';\n    }\n\n    if (lower.startsWith('ipv4')) {\n        return 'IPv4';\n    }\n\n    if (lower.startsWith('ipv6')) {\n        return 'IPv6';\n    }\n\n    if (lower.startsWith('tuple')) {\n        return source.replace(/^tuple/i, 'Tuple');\n    }\n\n    if (lower.startsWith('struct')) {\n        return source.replace(/^struct/i, 'Tuple');\n    }\n\n    if (lower.startsWith('char') || lower.startsWith('varchar') || lower.startsWith('text') || lower.startsWith('string')) {\n        return 'String';\n    }\n\n    return source;\n};\n\nexport async function getColumn({\n    connectionId,\n    database,\n    table,\n    column,\n    datasourceType = 'mysql',\n}: GetColumnParams): Promise<(ColumnMetadata & { normalizedType: string }) | null> {\n    if (!connectionId || !database || !table || !column) {\n        return null;\n    }\n\n    const query = `\nSELECT\n  COLUMN_NAME AS Field,\n  DATA_TYPE AS DataType,\n  COLUMN_TYPE AS ColumnType\nFROM information_schema.COLUMNS\nWHERE TABLE_SCHEMA = '${escapeSqlLiteral(database)}'\n  AND TABLE_NAME = '${escapeSqlLiteral(table)}'\n  AND COLUMN_NAME = '${escapeSqlLiteral(column)}'\nLIMIT 1;\n`;\n\n    const response$ = getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getColumn',\n                    datasource: { type: datasourceType, uid: connectionId },\n                    rawSql: query,\n                    format: 'table',\n                },\n            ],\n        },\n    });\n\n    try {\n        const { data, ok } = await lastValueFrom(response$);\n        if (!ok) {\n            return null;\n        }\n\n        const resultData = data as { results?: Record<string, any> };\n        const frame = resultData?.results?.getColumn?.frames?.[0];\n        if (!frame) {\n            return null;\n        }\n\n        const dataFrame = toDataFrame(frame);\n        const nameField = dataFrame.fields.find(field => field.name === 'Field') ?? dataFrame.fields[0];\n        const dataTypeField = dataFrame.fields.find(field => field.name === 'DataType');\n        const columnTypeField = dataFrame.fields.find(field => field.name === 'ColumnType');\n\n        const name = nameField?.values?.get?.(0);\n        if (!name) {\n            return null;\n        }\n\n        const dataTypeValue = dataTypeField?.values?.get?.(0);\n        const columnTypeValue = columnTypeField?.values?.get?.(0);\n\n        const columnInfo: ColumnMetadata = {\n            name: String(name),\n            dataType: dataTypeValue != null ? String(dataTypeValue) : undefined,\n            columnType: columnTypeValue != null ? String(columnTypeValue) : undefined,\n        };\n\n        const normalizedType = normalizeColumnType({\n            dataType: columnInfo.dataType,\n            columnType: columnInfo.columnType,\n        });\n\n        return {\n            ...columnInfo,\n            normalizedType,\n        };\n    } catch (error) {\n        console.error('Failed to fetch column metadata', error);\n        return null;\n    }\n}\n\nexport async function getInvertedIndexColumns({\n    connectionId,\n    database,\n    table,\n    datasourceType = 'mysql',\n}: GetIndexesParams): Promise<string[]> {\n    if (!connectionId || !database || !table) {\n        return [];\n    }\n\n    const query = `SHOW INDEXES FROM \\`${database}\\`.\\`${table}\\``;\n\n    const response$ = getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getInvertedIndexes',\n                    datasource: { type: datasourceType, uid: connectionId },\n                    rawSql: query,\n                    format: 'table',\n                },\n            ],\n        },\n    });\n\n    try {\n        const { data, ok } = await lastValueFrom(response$);\n        if (!ok) {\n            return [];\n        }\n\n        const resultData = data as { results?: Record<string, any> };\n        const frame =\n            resultData?.results?.getInvertedIndexes?.frames?.[0] ??\n            resultData?.results?.getIndexes?.frames?.[0];\n\n        if (!frame) {\n            return [];\n        }\n\n        const dataFrame = toDataFrame(frame);\n        const columnNameField =\n            dataFrame.fields.find(field => field.name === 'Column_name') ??\n            dataFrame.fields.find(field => field.name === 'COLUMN_NAME');\n        const indexTypeField =\n            dataFrame.fields.find(field => field.name === 'Index_type') ??\n            dataFrame.fields.find(field => field.name === 'INDEX_TYPE');\n\n        if (!columnNameField || !indexTypeField) {\n            return [];\n        }\n\n        const columnNames = Array.from(columnNameField.values ?? []);\n        const indexTypes = Array.from(indexTypeField.values ?? []);\n        const indexedColumns = new Set<string>();\n\n        for (let i = 0; i < columnNames.length; i += 1) {\n            const columnName = columnNames[i];\n            const indexType = indexTypes[i];\n            if (typeof columnName !== 'string' || columnName.length === 0) {\n                continue;\n            }\n            if (typeof indexType !== 'string') {\n                continue;\n            }\n\n            if (indexType.toUpperCase().includes('INVERT')) {\n                indexedColumns.add(columnName);\n            }\n        }\n\n        return Array.from(indexedColumns);\n    } catch (error) {\n        console.error('Failed to fetch inverted index metadata', error);\n        return [];\n    }\n}\n\n\nexport function getDatabases(selectdbDS: any) {\n    const response$ = getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getDatabases',\n                    datasource: {\n                        type: 'mysql',\n                        uid: selectdbDS.uid,\n                    },\n                    rawSql: 'SHOW DATABASES',\n                    format: 'table',\n                },\n            ],\n        },\n    });\n    return response$;\n}\n\nexport function getTablesService({ selectdbDS, database }: { selectdbDS: any; database: string }) {\n    return getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getTables',\n                    datasource: { type: 'mysql', uid: selectdbDS.uid },\n                    rawSql: `SHOW TABLES FROM \\`${database}\\``,\n                    format: 'table',\n                },\n            ],\n        },\n    });\n}\n\nexport function getFieldsService({ selectdbDS, database, table }: { selectdbDS: any; database: string; table: string }) {\n    return getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getFields',\n                    datasource: { type: 'mysql', uid: selectdbDS.uid },\n                    rawSql: `SHOW COLUMNS FROM \\`${database}\\`.\\`${table}\\``,\n                    format: 'table',\n                },\n            ],\n        },\n    });\n}\n\nexport function getColumnFromFieldService({ selectdbDS, database, table }: { selectdbDS: any; database: string; table: string }) {\n    // return getBackendSrv().fetch({\n    //     url: '/api/ds/query',\n    //     method: 'POST',\n    //     data: {\n    //         queries: [\n    //             {\n    //                 refId: 'getColumnFromFieldService',\n    //                 datasource: { type: 'mysql', uid: selectdbDS.uid },\n    //                 rawSql: `SHOW COLUMNS FROM \\`${database}\\`.\\`${table}\\``,\n    //                 format: 'table',\n    //             },\n    //         ],\n    //     },\n    // });\n}\n\nexport function getIndexesService({ selectdbDS, database, table }: { selectdbDS: any; database: string; table: string }) {\n    return getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getIndexes',\n                    datasource: { type: 'mysql', uid: selectdbDS.uid },\n                    rawSql: `SHOW INDEXES FROM \\`${database}\\`.\\`${table}\\``,\n                    format: 'table',\n                },\n            ],\n        },\n    });\n}\n","import { getAutoInterval } from '../constants';\nimport dayjs, { Dayjs, ManipulateType } from 'dayjs';\nimport { flatten, orderBy, some } from 'lodash-es';\nimport { nanoid } from 'nanoid';\nimport { DiscoverCurrent, DataFilterType, AutoInterval, IntervalEnum } from 'types/type';\nimport jsTokens from 'js-tokens';\nimport localeData from 'dayjs/plugin/localeData';\nimport { DataFrame, FieldType } from '@grafana/data';\nimport utc from 'dayjs/plugin/utc';\nimport { isIgnorableHighlightToken } from './utils';\ndayjs.extend(utc);\ndayjs.extend(localeData);\n\nexport const OPERATORS: string[] = [\n    '=',\n    '!=',\n    'in',\n    'not in',\n    'is null',\n    'is not null',\n    'like',\n    'not like',\n    'between',\n    'not between',\n    'match_any',\n    'match_all',\n    'match_phrase',\n    'match_phrase_prefix',\n];\nexport const SQL_OPERATORS: string[] = ['=', '!=', '>', '<', '>=', '<=', 'LIKE', 'IN', 'AND', 'OR', 'BETWEEN'];\nexport const TIME_FIELD_TYPES = ['DATETIME', 'DATE', 'DATETIMEV2', 'DATEV2', 'TIME'];\nexport function isValidTimeFieldType(fieldType: string): boolean {\n    // 提取基础字段类型（移除括号及其内容）\n    const baseFieldType = fieldType.split('(')[0];\n    return TIME_FIELD_TYPES.includes(baseFieldType);\n}\nexport const CAN_SEARCH_FIELD_TYPE = ['STRING', 'ARRAY', 'NUMBER', 'VARIANT'];\nexport const ENABLE_SEARCH_FIELD_TYPE = ['DATETIME', 'TIMESTAMP', 'TIME'];\nexport const getFieldType = (columnType: string | undefined) => {\n    if (!columnType) {\n        return '';\n    }\n    const currentColumnType = FIELD_TYPES.find(item => item.value.some(val => columnType.toLocaleUpperCase().includes(val)));\n    return currentColumnType?.key;\n};\n\nexport const DISCOVER_DEFAULT_STATUS: DiscoverCurrent = {\n    catalog: 'internal',\n    database: '',\n    table: '',\n    cluster: '',\n    timeField: '',\n    date: [],\n};\n\nexport enum SearchableEnum {\n    ANY = 'ANY',\n    YES = 'YES',\n    NO = 'NO',\n}\nexport enum AggregatableEnum {\n    ANY = 'ANY',\n    YES = 'YES',\n    NO = 'NO',\n}\n\nexport const SEARCHABLE = [\n    {\n        label: `Any`,\n        value: SearchableEnum.ANY,\n    },\n    {\n        label: 'Yes',\n        value: SearchableEnum.YES,\n    },\n    {\n        label: 'No',\n        value: SearchableEnum.NO,\n    },\n];\n\nexport const AGGREGATABLE = [\n    {\n        label: `Any`,\n        value: AggregatableEnum.ANY,\n    },\n    {\n        label: 'Yes',\n        value: AggregatableEnum.YES,\n    },\n    {\n        label: 'No',\n        value: AggregatableEnum.NO,\n    },\n];\n\nexport enum FieldTypeEnum {\n    ANY = 'ANY',\n    STRING = 'STRING',\n    NUMBER = 'NUMBER',\n    DATE = 'DATE',\n}\n\nexport enum ParamsKeyEnum {\n    sqlCatalog = 'sqlCatalog',\n    sqlDatabase = 'sqlDatabase',\n    startDate = 'startDateRange',\n    endDate = 'endDateRange',\n    sqlSearch = 'sqlSearch',\n    selectedTable = 'selectedTable',\n    dateInterval = 'dateInterval',\n    selectedField = 'selectedField',\n    dataFilter = 'dataFilter',\n    selectedTimeField = 'selectedTimeField',\n    sortedField = 'sortedField',\n    searchType = 'searchType',\n    selectedIndex = 'selectedIndex',\n    selectedCluster = 'selectedCluster',\n}\n\nexport function getFilterSQL({ fieldName, operator, value }: DataFilterType): string {\n    const valueString = value.map((e: any) => {\n        if (typeof e === 'string') {\n            return `'${e}'`;\n        } else {\n            return e;\n        }\n    });\n\n    if (\n        operator === '=' ||\n        operator === '!=' ||\n        operator === 'like' ||\n        operator === 'not like' ||\n        operator === 'match_all' ||\n        operator === 'match_any' ||\n        operator === 'match_phrase' ||\n        operator === 'match_phrase_prefix'\n    ) {\n        return `\\`${fieldName}\\` ${operator} ${valueString[0]}`;\n    }\n\n    if (operator === 'is null' || operator === 'is not null') {\n        return `\\`${fieldName}\\` ${operator}`;\n    }\n\n    if (operator === 'between' || operator === 'not between') {\n        return `\\`${fieldName}\\` ${operator} ${valueString[0]} AND ${valueString[1]}`;\n    }\n\n    if (operator === 'in' || operator === 'not in') {\n        return `\\`${fieldName}\\` ${operator} (${valueString})`;\n    }\n\n    return '';\n}\n\nexport function addSqlFilter(sql: string, dataFilterValue: DataFilterType): string {\n    let result = sql;\n    if (!sql.toUpperCase().includes('WHERE')) {\n        result += ' WHERE';\n    } else {\n        result += ' AND';\n    }\n\n    result += ` (${getFilterSQL(dataFilterValue)})`;\n\n    return result;\n}\n\nfunction isWrappedInQuotes(inputString: string): boolean {\n    const pattern = /([\"'])(.*?)\\1/;\n    return pattern.test(inputString);\n}\n\nexport function getIndexesStatement(indexes: any[], allField: any[], keywords: string) {\n    let operator: 'MATCH_ANY' | 'MATCH_PHRASE' | 'MATCH_PHRASE_PREFIX' | '=' = 'MATCH_ANY';\n\n    let searchValue = keywords.trim();\n\n    if (!searchValue || !indexes) {\n        return '';\n    }\n\n    if (isWrappedInQuotes(keywords)) {\n        operator = 'MATCH_PHRASE';\n    } else {\n        searchValue = `'${searchValue}'`;\n    }\n    const indexesNames = indexes.map(item => item.columnName);\n    return indexesNames.reduce((prevValue, currValue) => {\n        const currentField = allField.find(field => `${field.value}` === currValue);\n        const currentFieldType = getFieldType(currentField.Type)?.toUpperCase();\n        if (currentFieldType === 'NUMBER') {\n            operator = '=';\n        }\n        if (currentFieldType === 'STRING' || currentFieldType === 'ARRAY') {\n            if (isWrappedInQuotes(keywords)) {\n                operator = 'MATCH_PHRASE';\n            } else {\n                operator = 'MATCH_ANY';\n            }\n        }\n        const canSearchField = CAN_SEARCH_FIELD_TYPE.includes(currentFieldType as string);\n        if (canSearchField) {\n            if (prevValue) {\n                return `${prevValue} OR \\`${currValue}\\` ${operator} ${searchValue}`;\n            } else {\n                return `\\`${currValue}\\` ${operator} ${searchValue}`;\n            }\n        }\n        return prevValue;\n    }, '');\n}\n\nexport const DISCOVER_SHORTCUTS = [\n    {\n        key: nanoid(),\n        text: `Last 5 Minutes`,\n        label: `Last 5 Minutes`,\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-5, 'minute').startOf('second'), now],\n        format: 'HH:mm',\n        raw: {\n            from: 'now-5m',\n            to: 'now',\n        },\n        type: 'minute',\n        number: -5,\n    },\n    {\n        key: nanoid(),\n        text: `Last 15 Minutes`,\n        label: `Last 15 Minutes`,\n        raw: {\n            from: 'now-15m',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-15, 'minute').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'minute',\n        number: -15,\n    },\n    {\n        key: nanoid(),\n        text: `Last 1 Hour`,\n        label: `Last 1 Hour`,\n        raw: {\n            from: 'now-1h',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-1, 'hour').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'hour',\n        number: -1,\n    },\n    {\n        key: nanoid(),\n        text: `Last 1 Day`,\n        label: `Last 1 Day`,\n        raw: {\n            from: 'now-1d',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-1, 'day').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'day',\n        number: -1,\n    },\n    {\n        key: nanoid(),\n        text: `Last 7 Days`,\n        label: `Last 1 Days`,\n        raw: {\n            from: 'now-7d',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-7, 'day').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'day',\n        number: -7,\n    },\n    {\n        key: nanoid(),\n        text: `Last 1 Month`,\n        label: `Last 1 Month`,\n        raw: {\n            from: 'now-1M',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-1, 'month').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'month',\n        number: -1,\n    },\n    {\n        key: nanoid(),\n        text: `Last 3 Months`,\n        label: `Last 3 Months`,\n        raw: {\n            from: 'now-3M',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-3, 'month').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'month',\n        number: -3,\n    },\n    {\n        key: nanoid(),\n        text: `Last 1 Year`,\n        label: `Last 1 Year`,\n        raw: {\n            from: 'now-1y',\n            to: 'now',\n        },\n        range: (now: dayjs.Dayjs = dayjs()) => [now.add(-1, 'year').startOf('second'), now],\n        format: 'HH:mm',\n        type: 'year',\n        number: -1,\n    },\n];\n\nexport const SURROUNDING_LOGS_OPERATORS = [\n    {\n        label: '5',\n        value: '5',\n    },\n    {\n        label: '10',\n        value: '10',\n    },\n];\n\nexport function getLatestTime(id: string) {\n    if (!id) {\n        return null;\n    }\n    const selectedItem = DISCOVER_SHORTCUTS.find(item => item.key === id);\n    return selectedItem?.range();\n}\n\nexport const TIME_INTERVALS = [\n    {\n        value: 'auto',\n        label: `Auto`,\n    },\n    {\n        value: 'second',\n        label: `Second`,\n    },\n    {\n        value: 'minute',\n        label: `Minute`,\n    },\n    {\n        value: 'hour',\n        label: `Hour`,\n    },\n    {\n        value: 'day',\n        label: `Day`,\n    },\n    {\n        value: 'week',\n        label: `Week`,\n    },\n    {\n        value: 'month',\n        label: `Month`,\n    },\n    {\n        value: 'year',\n        label: `Year`,\n    },\n];\n\nexport const PAGESIZE_OPTIONS = [10, 20, 50, 100, 200];\n\nexport const FIELD_TYPES = [\n    {\n        key: 'STRING',\n        value: ['VARCHAR', 'STRING', 'CHAR', 'TEXT'],\n        icon: '',\n    },\n    {\n        key: 'NUMBER',\n        value: ['INT', 'LARGEINT', 'SMALLINT', 'TINYINT', 'DECIMAL', 'BIGINT', 'FLOAT', 'DOUBLE'],\n        icon: '',\n    },\n    {\n        key: 'DATE',\n        value: ['DATE', 'DATETIME', 'DATEV2', 'DATETIMEV2'],\n        icon: '',\n    },\n    {\n        key: 'JSONB',\n        value: ['JSONB'],\n        icon: '',\n        complex: true,\n    },\n    {\n        key: 'ARRAY',\n        value: ['ARRAY'],\n        icon: '',\n        complex: true,\n    },\n    {\n        key: 'BOOLEAN',\n        value: ['BOOLEAN'],\n        icon: '',\n    },\n    {\n        key: 'BITMAP',\n        value: ['BITMAP'],\n        icon: '',\n        complex: true,\n    },\n    {\n        key: 'HLL',\n        value: ['HLL'],\n        icon: '',\n        complex: true,\n    },\n    {\n        key: 'VARIANT',\n        value: ['VARIANT'],\n        icon: '',\n        complex: true,\n    },\n    {\n        key: 'JSON',\n        value: ['JSON'],\n        icon: '',\n        complex: true,\n    },\n];\n\nexport function encodeBase64(str: string) {\n    return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (match, p1) => String.fromCharCode(parseInt('0x' + p1, 10))));\n}\n\nexport function decodeBase64(base64: string) {\n    return decodeURIComponent(\n        Array.from(atob(base64))\n            .map(c => '%' + c.charCodeAt(0).toString(16).padStart(2, '0'))\n            .join(''),\n    );\n}\n\nexport const isComplexType = (columnType: string | undefined) => {\n    if (!columnType) {\n        return false;\n    }\n    const currentColumnType = FIELD_TYPES.find(item => item.value.some(val => columnType.toLocaleUpperCase().includes(val)));\n    if (currentColumnType) {\n        return !!currentColumnType.complex;\n    }\n    return true;\n};\n\nexport function formatDate(interval: ManipulateType) {\n    let date_format = 'YYYY-MM-DD HH:mm:ss';\n    switch (interval) {\n        case 'year':\n            date_format = 'YYYY';\n            break;\n        case 'month':\n            date_format = 'YYYY-MM';\n            break;\n        case 'week':\n            date_format = 'YYYY-MM-DD';\n            break;\n        case 'day':\n            date_format = 'YYYY-MM-DD';\n            break;\n        case 'hour':\n            date_format = 'YYYY-MM-DD HH:mm:ss';\n            break;\n        case 'minute':\n            date_format = 'YYYY-MM-DD HH:mm:ss';\n            break;\n        case 'second':\n        default:\n            date_format = 'YYYY-MM-DD HH:mm:ss';\n            break;\n    }\n    return date_format;\n}\n\nexport function resetDate(date: Dayjs, interval: ManipulateType) {\n    let date_reset = date;\n    switch (interval) {\n        case 'year':\n            date_reset.set('month', 1).set('date', 1).set('hour', 0).set('minute', 0).set('second', 0);\n            break;\n        case 'month':\n            date_reset.set('date', 1).set('hour', 0).set('minute', 0).set('second', 0);\n            break;\n        case 'week':\n            date_reset.set('hour', 0).set('minute', 0).set('second', 0);\n            break;\n        case 'day':\n            date_reset.set('hour', 0).set('minute', 0).set('second', 0);\n            break;\n        case 'hour':\n            date_reset.set('minute', 0).set('second', 0);\n            break;\n        case 'minute':\n            date_reset.set('second', 0);\n            break;\n        case 'second':\n        default:\n            break;\n    }\n    return date_reset;\n}\n\nexport function getDateRange(startDate: Dayjs, endDate: Dayjs, interval: any) {\n    const DATE_FORMAT = formatDate(interval.interval_unit);\n    if (dayjs(startDate, DATE_FORMAT).isSame(dayjs(endDate, DATE_FORMAT), interval.interval_unit)) {\n        return [endDate];\n    }\n    let date: any = resetDate(startDate, interval.interval_unit);\n    const formatStartDate = date.format(DATE_FORMAT);\n    const dates = [formatStartDate];\n    do {\n        date = dayjs(date).add(interval.interval_value, interval.interval_unit);\n        if (dayjs(date).isBefore(endDate)) {\n            dates.push(date.format(DATE_FORMAT));\n        }\n    } while (dayjs(date).isBefore(endDate));\n    return dates;\n}\n\nexport function getChartsData(tableDataCharts: any[], currentDate: [Dayjs, Dayjs]) {\n    const selectInterval: AutoInterval = getAutoInterval(currentDate);\n    const [startDate, endDate] = currentDate;\n    const intervalUnit: any = selectInterval.interval_unit || IntervalEnum.Auto;\n    const timeInterval: any = intervalUnit === IntervalEnum.Auto ? selectInterval : { interval_value: 1, interval_unit: intervalUnit };\n    const dates = getDateRange(startDate as Dayjs, endDate as Dayjs, timeInterval);\n    const tableDataMap = new Map();\n    const result: any[] = [];\n    const DATE_FORMAT_FROM_INTERVAL = formatDate(timeInterval.interval_unit);\n\n    tableDataCharts.forEach(e => {\n        const currentLocale = dayjs.locale();\n        const date = dayjs.utc(e['TT']).locale(currentLocale).format(DATE_FORMAT_FROM_INTERVAL);\n        tableDataMap.set(date, e['sum(cnt)']);\n    });\n    dates.forEach(date => {\n        const newDate = dayjs(date).format(DATE_FORMAT_FROM_INTERVAL);\n        if (!tableDataMap.get(newDate)) {\n            tableDataMap.set(newDate, null);\n        }\n    });\n\n    tableDataMap.forEach((value, key) => {\n        result.push({\n            TT: key,\n            ['sum(cnt)']: value,\n        });\n    });\n    return orderBy(result, ['TT'], ['asc']);\n}\n\nexport function convertColumnToRow(frame: any): Array<Record<string, any>> {\n    const fieldNames = frame.schema.fields.map((f: any) => f.name);\n    const columns = frame.data.values;\n\n    if (columns.length === 0) {\n        return [];\n    }\n\n    const numRows = columns[0].length;\n    const rows: Array<Record<string, any>> = [];\n\n    for (let i = 0; i < numRows; i++) {\n        const row: Record<string, any> = {};\n        for (let j = 0; j < columns.length; j++) {\n            row[fieldNames[j]] = columns[j][i];\n            if (isValidTimeFieldType(frame.schema.fields[j].type.toUpperCase())) {\n                // 如果是时间字段，转换为 Dayjs 对象\n                row[fieldNames[j]] = formatTimestampToDateTime(row[fieldNames[j]], frame.schema.fields[j].precision || 3);\n            }\n            if (frame.schema.fields[j].type === 'VARIANT') {\n                // 如果是 VARIANT 类型，转换为 JSON 对象\n                try {\n                    row[fieldNames[j]] = JSON.parse(row[fieldNames[j]]);\n                } catch (e) {\n                    console.error(`Error parsing VARIANT field ${fieldNames[j]}:`, e);\n                }\n            }\n        }\n        rows.push(row);\n    }\n\n    return rows;\n}\n\n// 通过查询 Doris 的字段判断类型，不依赖 Grafana 类型\nexport function convertColumnToRowViaFieldsType(frame: any, fields: any): Array<Record<string, any>> {\n    const fieldNames = frame.schema.fields.map((f: any) => f.name);\n    const columns = frame.data.values;\n\n    if (columns.length === 0) {\n        return [];\n    }\n\n    const numRows = columns[0].length;\n    const rows: Array<Record<string, any>> = [];\n\n    for (let i = 0; i < numRows; i++) {\n        const row: Record<string, any> = {};\n        for (let j = 0; j < columns.length; j++) {\n            row[fieldNames[j]] = columns[j][i];\n            if (isValidTimeFieldType(frame.schema.fields[j].type.toUpperCase())) {\n                // 如果是时间字段，转换为 Dayjs 对象\n                row[fieldNames[j]] = formatTimestampToDateTime(row[fieldNames[j]], frame.schema.fields[j].precision || 3);\n                // row[fieldNames[j]] = dayjs.utc(row[fieldNames[j]]).locale(currentLocale).format('YYYY-MM-DD HH:mm:ss.SSS');\n            }\n            const currentFieldInfo = fields.filter((item: any) => item.Field === frame.schema.fields[j].name)[0];\n            // 如果是 VARIANT 类型，转换为 JSON 对象\n            if (currentFieldInfo && currentFieldInfo.Type.toUpperCase() === 'VARIANT') {\n                try {\n                    row[fieldNames[j]] = JSON.parse(row[fieldNames[j]]);\n                } catch (e) {\n                    console.error(`Error parsing VARIANT field ${fieldNames[j]}:`, e);\n                }\n            }\n        }\n        rows.push(row);\n    }\n\n    return rows;\n}\n\n// 格式化时间戳为 DATETIME([number]) 格式\nexport function formatTimestampToDateTime(timestamp: any, precision = 3) {\n    const currentLocale = dayjs.locale();\n    // 基础格式：YYYY-MM-DD HH:mm:ss\n    let formatString = 'YYYY-MM-DD HH:mm:ss';\n\n    // 根据精度添加毫秒部分\n    if (precision > 0) {\n        formatString += `.${'S'.repeat(precision)}`;\n    }\n    // 转换时间戳并格式化\n    return dayjs.utc(timestamp).locale(currentLocale).format(formatString);\n}\n\nexport function formatTracesResData(frame: any) {\n    const { data } = frame;\n    const traceDataFrame: DataFrame = {\n        name: 'Trace ID',\n        refId: frame.schema?.refId || 'Trace ID',\n        fields: frame.schema?.fields.map((f: any, i: number) => ({\n            name: f.name,\n            type: f.type,\n            values: data.values[i],\n            typeInfo: f.typeInfo,\n            config: {},\n        })),\n        length: data.values[0].length,\n    };\n    try {\n        traceDataFrame.fields.forEach(f => {\n            if (f.name === 'serviceTags' || f.name === 'tags') {\n                f.type = FieldType.other;\n                f.values = f.values.map(item => JSON.parse(item));\n            }\n        });\n    } catch (err) {\n        console.log('err:', err);\n    }\n    console.log('traceDataFrame', traceDataFrame);\n    return traceDataFrame;\n}\n\nfunction getSearchTableData(tokenizeFields: any[], tableResult: any[]) {\n    const result: any = [...tokenizeFields];\n    tableResult.forEach(tableItem => {\n        result.forEach((token: any) => {\n            token['searchValue'] = tableItem[token.columnName];\n        });\n    });\n    return result;\n}\n\nfunction searchField(data: any[], searchString: string) {\n    return some(data, item => item.columnName === searchString);\n}\n\nfunction parseKeywords(keyword: string) {\n    if (keyword.length >= 2 && keyword[0] === keyword[keyword.length - 1] && (keyword[0] === `'` || keyword[0] === `\"`)) {\n        keyword = keyword.substring(1, keyword.length - 1);\n    }\n    return keyword;\n}\n\nfunction highlightDelimiter(inputStr: string, delimiter: string) {\n    const highlighted = inputStr.replace(new RegExp(`${delimiter}`, 'g'), `<mark>${delimiter}</mark>`);\n    return highlighted;\n}\n\nfunction insertUnderscore(arr: string[]) {\n    return arr.reduce((result: string[], item: string, index) => {\n        result.push(item);\n        if (index < arr.length - 1) {\n            result.push('_');\n        }\n        return result;\n    }, []);\n}\n\nfunction compare_ignore_quotes(s1: string, s2: string) {\n    // 移除双引号和单引号\n    const cleanS1 = s1.replace(/['\"]/g, '');\n    const cleanS2 = s2.replace(/['\"]/g, '');\n    // 比较\n    return cleanS1 === cleanS2;\n}\n\ntype SearchResultItem = { [key: string]: any };\nexport function generateHighlightedResults(data: { search_value: string; indexes: string[] }, result: SearchResultItem[]) {\n    const keyword: string = data.search_value || '';\n    const searchTableData = getSearchTableData(data.indexes, result);\n\n    // Detect simple Lucene \"field:value\" pattern so we can highlight the specified field\n    // even when `indexes` (tokenizeFields) is empty. Example: \"service_name:frontend\"\n    const luceneFieldMatch = keyword && keyword.match(/^\\s*([^\\s:]+)\\s*:/);\n    const luceneField = luceneFieldMatch ? luceneFieldMatch[1].replace(/['\"]+/g, '') : null;\n\n    const keywordsTokens: string[] = flatten(\n        Array.from(jsTokens(keyword))\n            .filter(item => item.type !== 'Punctuator')\n            .map(item => {\n                let res = item.value.toLowerCase();\n                return item.value.includes('_') ? item.value.split('_').map(str => str.toLowerCase()) : res;\n            }),\n    );\n\n    const _sourceResult = result.map(item => {\n        let itemSource = '';\n\n        for (const key in item) {\n            let highlightValue: any = item[key];\n            let itemValue: any = item[key];\n\n            if (typeof highlightValue === 'object') {\n                highlightValue = JSON.stringify(highlightValue);\n                itemValue = JSON.stringify(itemValue);\n            }\n\n            if (keyword && (searchField(searchTableData, key) || (luceneField && key === luceneField))) {\n                const strValue = typeof itemValue === 'string' ? itemValue : itemValue + '';\n\n                if (isWrappedInQuotes(keyword)) {\n                    const parsedKeyword = parseKeywords(keyword);\n                    if (parsedKeyword === strValue) {\n                        // highlightValue = `<mark>${itemValue}</mark>`;\n                        highlightValue = itemValue;\n                    } else if (strValue.includes(parsedKeyword)) {\n                        // highlightValue = highlightDelimiter(strValue, parsedKeyword);\n                          highlightValue = strValue;\n                    }\n                } else {\n                    const tokenizedAns = Array.from(jsTokens(strValue)).map(item => item.value);\n                    let ans: string[] = [];\n\n                    if (tokenizedAns.includes(keyword)) {\n                        ans = tokenizedAns;\n                    } else {\n                        const ansWithUnderscore = flatten(\n                            tokenizedAns.map(item => {\n                                if (item.includes('_')) {\n                                    return insertUnderscore(item.split('_'));\n                                }\n                                return item;\n                            }),\n                        );\n                        ans = ansWithUnderscore;\n                    }\n\n                    if (ans.length > 0) {\n                        highlightValue = ans.reduce((acc: string, curr: string) => {\n                            // if (\n                            //     keywordsTokens.filter(token => !isIgnorableHighlightToken(token)).find(token => compare_ignore_quotes(token, curr.toLowerCase())) ||\n                            //     compare_ignore_quotes(keyword.toLowerCase(), curr.toLowerCase())\n                            // ) {\n                            //     return acc + `<mark>${curr}</mark>`;\n                            // }\n                            return acc + curr;\n                        }, '');\n                    }\n                }\n            }\n\n            // ✅ 这里改成用 data-trace-id + class，方便事件委托识别\n            if (key === 'trace_id') {\n                const traceId = typeof itemValue === 'string' ? itemValue : String(itemValue);\n\n                const content = highlightValue || traceId;\n\n                highlightValue = `<a \n                href=\"javascript:void(0)\" \n                class=\"trace-link\" \n                data-trace-id=\"${traceId}\"\n            >${content}</a>`;\n            }\n            itemSource += `<span class=\"field-key\">${key}:</span>${highlightValue} `;\n        }\n\n        return {\n            _original: item,\n            _source: itemSource.trim(),\n        };\n    });\n\n    return _sourceResult;\n}\n\nexport const QUERY_TRACE_FIELDS = ['trace_id','span_id','parent_span_id','span_name','service_name']\n\n"],"names":["atom","atomWithStorage","selectAtom","atomWithLocation","IntervalEnum","AggregatableEnum","DISCOVER_DEFAULT_STATUS","DISCOVER_SHORTCUTS","FieldTypeEnum","SearchableEnum","locationAtom","dataFilterAtom","discoverCurrentAtom","databasesAtom","settingDatabasesAtom","tablesAtom","settingTablesAtom","currentCatalogAtom","searchTypeAtom","currentDatabaseAtom","current","database","currentTableAtom","currentClusterAtom","currentTimeFieldAtom","timeField","currentDateAtom","range","currentIndexAtom","selectedIndexesAtom","searchValueAtom","searchFocusAtom","activeShortcutAtom","dorisInfoAtom","disabledOptionsAtom","selectedFieldsAtom","tableFieldsAtom","timeFieldsAtom","tableDataAtom","topDataAtom","surroundingTableDataAtom","tableDataChartsAtom","intervalAtom","Auto","tableTotalCountAtom","tableEChartsDataAtom","tableTracesDataAtom","searchableAtom","ANY","aggregatableAtom","fieldTypeAtom","indexesAtom","selectedRowAtom","tableFieldValuesAtom","pageAtom","pageSizeAtom","surroundingDataFilterAtom","beforeTimeFieldPageSizeAtom","afterTimeFieldPageSizeAtom","beforeTimeAtom","afterTimeAtom","beforeCountAtom","afterCountAtom","surroundingTableFieldsAtom","surroundingSelectedFieldsAtom","datasourcesAtom","selectedDatasourceAtom","undefined","timeRangeAtom","from","toDate","to","raw","discoverLoadingAtom","getTableData","getTopData","getSurroundingData","getTableDataCharts","getTableFieldValues","getIndexes","getTimeFields","getTableFields","toDataFrame","getBackendSrv","lastValueFrom","escapeSqlLiteral","value","replace","normalizeColumnType","dataType","columnType","source","trim","lower","toLowerCase","startsWith","endsWith","inner","slice","normalizedInner","getColumn","connectionId","table","column","datasourceType","query","response$","fetch","url","method","data","queries","refId","datasource","type","uid","rawSql","format","resultData","nameField","dataTypeField","columnTypeField","ok","frame","results","frames","dataFrame","fields","find","field","name","values","get","dataTypeValue","columnTypeValue","columnInfo","String","normalizedType","error","console","getInvertedIndexColumns","getInvertedIndexes","columnNameField","indexTypeField","columnNames","Array","indexTypes","indexedColumns","Set","i","length","columnName","indexType","toUpperCase","includes","add","getDatabases","selectdbDS","getTablesService","getFieldsService","getColumnFromFieldService","getIndexesService","getAutoInterval","dayjs","flatten","orderBy","some","nanoid","jsTokens","localeData","FieldType","utc","extend","OPERATORS","SQL_OPERATORS","TIME_FIELD_TYPES","isValidTimeFieldType","fieldType","baseFieldType","split","CAN_SEARCH_FIELD_TYPE","ENABLE_SEARCH_FIELD_TYPE","getFieldType","currentColumnType","FIELD_TYPES","item","val","toLocaleUpperCase","key","catalog","cluster","date","SEARCHABLE","label","AGGREGATABLE","ParamsKeyEnum","getFilterSQL","fieldName","operator","valueString","map","e","addSqlFilter","sql","dataFilterValue","result","isWrappedInQuotes","inputString","pattern","test","getIndexesStatement","indexes","allField","keywords","searchValue","indexesNames","reduce","prevValue","currValue","currentField","currentFieldType","Type","canSearchField","text","now","startOf","number","SURROUNDING_LOGS_OPERATORS","getLatestTime","id","selectedItem","TIME_INTERVALS","PAGESIZE_OPTIONS","icon","complex","encodeBase64","str","btoa","encodeURIComponent","match","p1","fromCharCode","parseInt","decodeBase64","base64","decodeURIComponent","atob","c","charCodeAt","toString","padStart","join","isComplexType","formatDate","interval","date_format","resetDate","date_reset","set","getDateRange","startDate","endDate","DATE_FORMAT","interval_unit","isSame","formatStartDate","dates","interval_value","isBefore","push","getChartsData","tableDataCharts","currentDate","selectInterval","intervalUnit","timeInterval","tableDataMap","Map","DATE_FORMAT_FROM_INTERVAL","forEach","currentLocale","locale","newDate","TT","convertColumnToRow","fieldNames","schema","f","columns","numRows","rows","row","j","formatTimestampToDateTime","precision","JSON","parse","convertColumnToRowViaFieldsType","currentFieldInfo","filter","Field","timestamp","formatString","repeat","formatTracesResData","traceDataFrame","typeInfo","config","other","err","log","getSearchTableData","tokenizeFields","tableResult","tableItem","token","searchField","searchString","parseKeywords","keyword","substring","highlightDelimiter","inputStr","delimiter","highlighted","RegExp","insertUnderscore","arr","index","compare_ignore_quotes","s1","s2","cleanS1","cleanS2","generateHighlightedResults","search_value","searchTableData","luceneFieldMatch","luceneField","keywordsTokens","res","_sourceResult","itemSource","highlightValue","itemValue","stringify","strValue","parsedKeyword","tokenizedAns","ans","ansWithUnderscore","acc","curr","traceId","content","_original","_source","QUERY_TRACE_FIELDS"],"sourceRoot":""}
{"version":3,"file":"382.js?_cache=e94df3781c745de07e6e","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAmC;AACE;AAE9B,MAAME,wBAAwBD,yCAAMA,CAACE,GAAG,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuChD,CAAC,CAAC;AAEK,MAAMC,iBAAiBJ,YAAG,CAAC;;AAElC,CAAC,CAAC;AAEK,MAAMK,WAAWL,YAAG,CAAC;;;;AAI5B,CAAC,CAAC;AAEK,MAAMM,WAAWN,YAAG,CAAC;;AAE5B,CAAC,CAAC;AAEK,MAAMO,cAAcP,YAAG,CAAC;;;;;;;;;;;;;;;AAe/B,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzE4C;AACpB;AACM;AACsE;AACa;AAE9D;AACC;AACoC;AACvD;AAE5B,SAAS6B,cAAc,EAAEC,MAAM,EAAEC,eAAe,EAA4D;QA+RvCC,eAqCIA,kBAyBzBA;IA5VnD,MAAMC,cAAcxB,8BAAYA,CAACU,gCAAeA;IAChD,MAAM,CAACe,YAAYC,cAAc,GAAG3B,yBAAOA,CAACY,+BAAcA;IAC1D,MAAM,CAACgB,iBAAiBC,mBAAmB,GAAG7B,yBAAOA,CAACa,qCAAoBA;IAC1E,MAAMiB,YAAY7B,8BAAYA,CAACa,8BAAaA;IAC5C,MAAMiB,UAAU9B,8BAAYA,CAACc,4BAAWA;IAExC,MAAM,EACFiB,OAAO,EACPC,YAAY,EACZC,KAAK,EACLC,QAAQ,EACRC,QAAQ,EACRC,WAAW,EAAEb,MAAM,EAAE,EACxB,GAAGL,6BAAOA,CAAC;QACRmB,eAAe;YACXC,OAAO;gBACHC,KAAK,EAAEjB,4BAAAA,sCAAAA,gBAAiBkB,SAAS;gBACjCC,KAAK,EAAEnB,4BAAAA,sCAAAA,gBAAiBkB,SAAS;YACrC;YACAE,UAAU;gBACNH,KAAK,EAAEjB,4BAAAA,sCAAAA,gBAAiBoB,QAAQ;gBAChCD,KAAK,EAAEnB,4BAAAA,sCAAAA,gBAAiBoB,QAAQ;YACpC;YACAD,KAAK,EAAEnB,4BAAAA,sCAAAA,gBAAiBmB,KAAK;YAC7BE,UAAUC,MAAMC,OAAO,CAACvB,4BAAAA,sCAAAA,gBAAiBmB,KAAK,IAAInB,4BAAAA,sCAAAA,gBAAiBmB,KAAK,CAAC,EAAE,GAAG;YAC9EK,UAAUF,MAAMC,OAAO,CAACvB,4BAAAA,sCAAAA,gBAAiBmB,KAAK,IAAInB,4BAAAA,sCAAAA,gBAAiBmB,KAAK,CAAC,EAAE,GAAG;YAC9EF,OAAOjB,CAAAA,4BAAAA,sCAAAA,gBAAiBiB,KAAK,KAAI;YACjCQ,WAAW,CAAC,EAACzB,4BAAAA,sCAAAA,gBAAiBiB,KAAK;QACvC;IACJ;IAEA,MAAMD,QAAaL,MAAM;IACzB,MAAMS,WAAgBT,MAAM;IAC5B,MAAMc,YAAiBd,MAAM;IAE7B,+FAA+F;IAC/FhC,kCAAe,CAAC;QACZ,IAAI,CAAC8C,WAAW;YACZ,0EAA0E;YAC1EZ,SAAS,SAAS;YAElB,oFAAoF;YACpF,wFAAwF;YACxF,IAAIb,4BAAAA,sCAAAA,gBAAiB2B,EAAE,EAAE;gBACrBvB,cAAcwB,CAAAA;oBACV,IAAIC,UAAU;oBACd,MAAMC,UAAUF,KAAKG,GAAG,CAACC,CAAAA;wBACrB,IAAIA,EAAEL,EAAE,KAAK3B,gBAAgB2B,EAAE,EAAE;4BAC7B,IAAIK,EAAEf,KAAK,EAAE;gCACTY,UAAU;gCACV,OAAO,wCAAKG;oCAAGf,OAAO;;4BAC1B;4BACA,OAAOe;wBACX;wBACA,OAAOA;oBACX;oBACA,OAAOH,UAAUC,UAAUF;gBAC/B;YACJ;QACJ;IACJ,GAAG;QAACH;QAAWZ;QAAUb,4BAAAA,sCAAAA,gBAAiB2B,EAAE;QAAEvB;KAAc;IAE5D,0CAA0C;IAC1C,MAAM6B,oBAAoBtD,gCAAa,CAAC;QACpC,MAAMuC,YAAY,OAAOF,UAAU,WAAWA,QAAQA,kBAAAA,4BAAAA,MAAOG,KAAK;QAClE,IAAI,CAACD,WAAW;YACZ,OAAO;QACX;QACA,MAAMiB,KAAKjC,YAAYkC,IAAI,CAAC,CAACJ,IAAWA,EAAE7C,KAAK,KAAK+B;QACpD,OAAOxB,mCAAYA,CAACyC,eAAAA,yBAAAA,GAAIE,IAAI;IAChC,GAAG;QAACrB;QAAOd;KAAY;IAEvB,MAAMoC,gBAAgBL,sBAAsB;IAC5C,MAAMM,iBAAiBN,sBAAsB;IAC7C,MAAMO,cAAcP,sBAAsB;IAE1C,4GAA4G;IAC5G,MAAMQ,kBAAkB9D,gCAAa,CAAC;QAClC,MAAM+D,aAAa,CAAEjD,4BAASA,IAAI,EAAE,EAAYsC,GAAG,CAACY,CAAAA,KAAO;gBAAE1B,OAAO,MAAO0B,GAAG1B,KAAK,IAAK0B;gBAAIxB,OAAO,MAAOwB,GAAGxB,KAAK,IAAKwB;YAAG;QAC1H,sGAAsG;QACtG,MAAMC,eAAe;YAAC;YAAa;YAAa;YAAgB;SAAsB;QAEtF,IAAIL,gBAAgB;YAChB,qDAAqD;YACrD,MAAMM,UAAU,IAAIC,IAAI;gBAAC;gBAAK;gBAAM;gBAAW;aAAc;YAC7D,OAAOJ,WAAWK,MAAM,CAACC,CAAAA,SAAUH,QAAQI,GAAG,CAACC,OAAOF,OAAO7B,KAAK;QACtE;QAEA,MAAMgC,iBAAiBb,iBAAiBE;QACxC,IAAIW,gBAAgB;YAChB,wFAAwF;YACxF,OAAOT,WAAWK,MAAM,CAACC,CAAAA;gBACrB,MAAMI,IAAIF,OAAOF,OAAO7B,KAAK,EAAEkC,WAAW;gBAC1C,OAAO,CAAED,CAAAA,MAAM,UAAUA,MAAM,cAAcR,aAAaU,QAAQ,CAACF,EAAC;YACxE;QACJ;QAEA,2DAA2D;QAC3D,8GAA8G;QAC9G,IAAI;YACA,MAAMlC,YAAY,OAAOF,UAAU,WAAWA,QAAQA,kBAAAA,4BAAAA,MAAOG,KAAK;YAClE,0EAA0E;YAC1E,IAAI,CAACD,WAAW;gBACZ,OAAOwB;YACX;YACA,+DAA+D;YAC/D,IAAI,CAACJ,iBAAiB,CAACC,kBAAkB,CAACC,aAAa;gBACnD,MAAMe,cAAcjC,MAAMC,OAAO,CAACf,YAAYA,QAAQgD,IAAI,CAAC,CAACC;oBACxD,IAAI,CAACA,OAAO,CAACA,IAAIC,UAAU,EAAE;wBACzB,OAAO;oBACX;oBACA,MAAMC,IAAIF,IAAIG,IAAI,IAAI;oBACtB,OAAOV,OAAOO,IAAIC,UAAU,MAAMR,OAAOhC,cAAcyC,EAAEE,WAAW,GAAGP,QAAQ,CAAC;gBACpF;gBAEA,IAAI,CAACC,aAAa;oBACd,4GAA4G;oBAC5G,OAAOb,WAAWK,MAAM,CAACC,CAAAA;wBACrB,MAAMI,IAAIF,OAAOF,OAAO7B,KAAK,EAAEkC,WAAW;wBAC1C,OAAO,CAACT,aAAaU,QAAQ,CAACF;oBAClC;gBACJ;YACH;QACJ,EAAE,OAAOU,GAAG;QACR,qEAAqE;QACzE;QAEA,OAAOpB;IACV,GAAG;QAACJ;QAAeC;QAAgBC;QAAaxB;QAAOR;KAAQ;IAEjE,MAAMuD,WAAW,CAAC5C,QAAoC6C,MAAM,CAAC7C,SAASA,QAAQ,CAACA;IAE/E,0DAA0D;IAC1D,8EAA8E;IAC9E,MAAM8C,eAAe,CAACb;QAClB,wDAAwD;QACxD,IAAIA,MAAM,IAAK;YACX,OAAO;QACX;QACA,IAAIA,MAAMc,aAAad,MAAM,MAAM;YAC/B,OAAOA;QACX;QAEA,iCAAiC;QACjC,IAAI9B,MAAMC,OAAO,CAAC6B,IAAI;YAClB,OAAOA,EAAErB,GAAG,CAACkC;QACjB;QAEA,kBAAkB;QAClB,IAAIb,MAAM,QAAQA,MAAM,QAAQ;YAC5B,OAAO;QACX;QACA,IAAIA,MAAM,SAASA,MAAM,SAAS;YAC9B,OAAO;QACX;QAEA,mDAAmD;QACnD,IAAId,eAAe;YACf,OAAOyB,SAASb,OAAOE;QAC3B;QAEA,uFAAuF;QACvF,mFAAmF;QAEnF,OAAOA;IACX;IAEA,MAAMe,WAAW,CAACC;QACd,MAAM,EAAEpD,KAAK,EAAEI,UAAUiD,OAAO,EAAElD,KAAK,EAAEE,QAAQ,EAAEG,QAAQ,EAAEP,KAAK,EAAEQ,SAAS,EAAE,GAAG2C;QAClF,MAAME,UAAUnE,WAAWiC,IAAI,CAACJ,CAAAA,IAAKA,EAAEL,EAAE,MAAK3B,4BAAAA,sCAAAA,gBAAiB2B,EAAE;QACjE,MAAMA,KAAK3B,CAAAA,4BAAAA,sCAAAA,gBAAiB2B,EAAE,KAAI/C,gCAAMA;QAExC,6DAA6D;QAC7D,MAAM2F,UAAU,OAAOF,YAAY,WAAWA,UAAUA,oBAAAA,8BAAAA,QAASlD,KAAK;QAEtE,IAAIqD,WAAkB,EAAE;QAExB,IAAID,YAAY,aAAaA,YAAY,eAAe;YACpD,8FAA8F;YAC9F,IAAI,aAAcL,aAAa7C,aAAa,MAAQG,aAAa0C,aAAa1C,aAAa,IAAK;gBAC5FgD,WAAW;oBAACP,aAAa5C;oBAAW4C,aAAazC;iBAAU;YAC/D;QACJ,OAAO,IAAIL,UAAU+C,WAAW;YAC5B,yDAAyD;YACzD,IAAI5C,MAAMC,OAAO,CAACJ,QAAQ;gBACtBqD,WAAWrD,MAAMY,GAAG,CAACqB,CAAAA,IAAKa,aAAab;YAC3C,OAAO;gBACHoB,WAAW;oBAACP,aAAa9C;iBAAO;YACpC;QACJ;QAEA,MAAMsD,UAAU;YACZ9C;YACAT,WAAWF,MAAMG,KAAK;YACtBC,UAAUmD;YACV,0EAA0E;YAC1EtD,OAAOQ,YAAYR,QAAQ;YAC3BE,OAAOqD;QACX;QACA,IAAIF,SAAS;YACT,MAAMxC,UAAU3B,WAAW4B,GAAG,CAACC,CAAAA,IAAMA,EAAEL,EAAE,KAAKA,KAAK8C,UAAUzC;YAC7D5B,cAAc0B;QAClB,OAAO;YACH1B,cAAc;mBAAID;gBAAYsE;aAAQ;QAC1C;QAEA1E;IACJ;IAEA,SAAS2E;QACL,oCAAoC;QACpC,yBAAyB;QACzBC,QAAQC,GAAG,CAACxD;QACZ,MAAMyD,kBAAmB,OAAOzD,aAAa,WAAWA,WAAWA,qBAAAA,+BAAAA,SAAUD,KAAK;QAClF,IAAI0D,mBAAmBA,oBAAoB,aAAaA,oBAAoB,iBAAkBA,CAAAA,oBAAoB,aAAaA,oBAAoB,aAAY,GAAI;gBAIvF5E,kBAKAA;YARxE,qBACI,uCAAC7B;gBAAI0G,WAAWxG,QAAQA;6BACpB,uCAACF;gBAAI0G,WAAWvG,QAAQA;6BACpB,uCAACY,SAAKA;gBAAC8B,OAAM;gBAAY8D,SAAS,CAAC,CAAC9E,OAAOoB,QAAQ;gBAAE2D,KAAK,GAAE/E,mBAAAA,OAAOoB,QAAQ,cAAfpB,uCAAAA,iBAAiBgF,OAAO;6BAChF,uCAAC/F,SAAKA,EAAK0B,SAAS,YAAY;gBAAEsE,UAAU;YAAqB,qBAGzE,uCAAC9G;gBAAI0G,WAAWvG,QAAQA;6BACpB,uCAACY,SAAKA;gBAAC8B,OAAM;gBAAY8D,SAAS,CAAC,CAAC9E,OAAOuB,QAAQ;gBAAEwD,KAAK,GAAE/E,mBAAAA,OAAOuB,QAAQ,cAAfvB,uCAAAA,iBAAiBgF,OAAO;6BAChF,uCAAC/F,SAAKA,EAAK0B,SAAS,YAAY;gBAAEsE,UAAU;YAAqB;QAKrF;QACAP,QAAQC,GAAG,CAAC,mBAAmBC;QAC/B,IACIA,oBAAoB,OACpBA,oBAAoB,QACpBA,oBAAoB,UACpBA,oBAAoB,cACpBA,oBAAoB,eACpBA,oBAAoB,eACpBA,oBAAoB,kBACpBA,oBAAoB,uBACtB;gBAGgE5E;YAF9D,qBACI,gGACI,uCAACd,SAAKA;gBAAC8B,OAAM;gBAAQ8D,SAAS,CAAC,CAAC9E,OAAOkB,KAAK;gBAAE6D,KAAK,GAAG/E,gBAAAA,OAAOkB,KAAK,cAAZlB,oCAAD,cAAuBgF,OAAO;6BAE/E,uCAAC/F,SAAKA,EAAK0B,SAAS,SAAS;gBAAEuE,UAAU,CAAC/B,IAAWA,MAAMc,aAAa;YAAkB;QAI1G;QACA,IAAIW,oBAAoB,QAAQA,oBAAoB,UAAU;gBAEA5E;YAD1D,qBACI,uCAACd,SAAKA;gBAAC8B,OAAM;gBAAQ8D,SAAS,CAAC,CAAC9E,OAAOkB,KAAK;gBAAE6D,KAAK,GAAG/E,iBAAAA,OAAOkB,KAAK,cAAZlB,qCAAD,eAAuBgF,OAAO;6BAC/E,uCAACtF,4BAAUA;gBACPyF,MAAK;gBACL3E,SAASA;gBACT4E,OAAO;oBAAEH,UAAU;gBAAkB;gBACrCI,QAAQ,CAAC,EAAEtE,KAAK,EAAE,iBACd,uCAACnC,UAAMA,0CACCmC;wBACJuE,SAAS;wBACTC,SAASnF,gBAAgB0B,GAAG,CAAC0D,CAAAA,OAAS;gCAClCxE,OAAOwE,KAAKtE,KAAK;gCACjBA,OAAOsE,KAAKtE,KAAK;4BACrB;wBACAuE,aAAY;wBACZC,UAAUC,CAAAA,WAAY5E,MAAM2E,QAAQ,CAACC,WAAWA,SAAS7D,GAAG,CAAC,CAAC8D,IAAWA,EAAE1E,KAAK,IAAI,EAAE;wBACtFA,OAAOd,gBACF0C,MAAM,CAAC0C,CAAAA,OAAQnE,MAAMC,OAAO,CAACP,MAAMG,KAAK,KAAKH,MAAMG,KAAK,CAACmC,QAAQ,CAACmC,KAAKtE,KAAK,GAC5EY,GAAG,CAAC0D,CAAAA,OAAS;gCACVxE,OAAOwE,KAAKtE,KAAK;gCACjBA,OAAOsE,KAAKtE,KAAK;4BACrB;;;QAM5B;QACA,qBAAO;IACX;IAEA,qBACI,uCAAC2E;QAAK3B,UAAUzD,aAAayD;QAAWW,WAAWzG,cAAcA;qBAC7D,uCAACD;QAAI0G,WAAWxG,QAAQA;qBACpB,uCAACF;QAAI0G,WAAWvG,QAAQA;qBACpB,uCAACY,SAAKA;QAAC8B,OAAM;QAAU8D,SAAS,CAAC,CAAC9E,OAAOe,KAAK;QAAEgE,KAAK,GAAG/E,gBAAAA,OAAOe,KAAK,cAAZf,oCAAD,cAAuBgF,OAAO;qBACjF,uCAACtF,4BAAUA;QACPyF,MAAK;QACL3E,SAASA;QACT4E,OAAO;YAAEH,UAAU;QAAe;QAElCI,QAAQ,CAAC,EAAEtE,KAAK,EAAE,iBACd,uCAACnC,UAAMA,0CACCmC;gBACJ2E,UAAU,CAACC;oBACP,oFAAoF;oBACpF,IAAIA,CAAAA,qBAAAA,+BAAAA,SAAUzE,KAAK,KAAIG,MAAMC,OAAO,CAAChB,cAAcA,UAAUwF,MAAM,GAAG,GAAG;wBACrEzF,mBACIT,yBAAMA,CACFU,UAAUwB,GAAG,CAAC,CAAC0D,OAAU;gCACrBxE,OAAO2E,SAASzE,KAAK;gCACrBA,OAAOsE,KAAKO,SAAS,CAACJ,SAASzE,KAAK,CAAC;4BACzC,KACA;oBAGZ,OAAO;wBACHb,mBAAmB,EAAE;oBACzB;oBACAU,MAAM2E,QAAQ,CAACC;gBACnB;gBAEAJ,SAAStF,YAAY6B,GAAG,CAACC,CAAAA,IAAM;wBAC3Bf,OAAOe,EAAE7C,KAAK;wBACdgC,OAAOa,EAAE7C,KAAK;oBAClB;;wBAMpB,uCAACf;QAAI0G,WAAWvG,QAAQA;qBACpB,uCAACY,SAAKA;QAAC8B,OAAM;QAAW8D,SAAS,CAAC,CAAC9E,OAAOmB,QAAQ;QAAE4D,KAAK,GAAG/E,mBAAAA,OAAOmB,QAAQ,cAAfnB,uCAAD,iBAA0BgF,OAAO;qBACxF,uCAACtF,4BAAUA;QACPyF,MAAK;QACL3E,SAASA;QACT4E,OAAO;YAAEH,UAAU;QAAkB;QACrCI,QAAQ,CAAC,EAAEtE,KAAK,EAAE,iBACd,uCAACnC,UAAMA,0CACCmC;gBACJwE,SAAS/C;;WAQhCiC,sCAED,uCAAC3F,kBAAcA,sBACX,uCAACD,eAAWA;QAACmC,OAAM;qBACf,uCAACtB,4BAAUA;QAACyF,MAAK;QAAY3E,SAASA;QAAS6E,QAAQ,CAAC,EAAEtE,KAAK,EAAE,iBAAK,uCAAChC,gBAAYA,EAAKgC;UAI/FS,2BACG,uCAACtC,SAAKA;QAAC4F,SAAS,CAAC,CAAC9E,OAAOgB,KAAK;QAAE+D,KAAK,GAAE/E,gBAAAA,OAAOgB,KAAK,cAAZhB,oCAAAA,cAAcgF,OAAO;qBACxD,uCAAC/F,SAAKA,EAAK0B,SAAS,SAAS;QAAEsE,UAAU;IAAqB,oBAItE,uCAAC9G;QAAI0G,WAAWtG,WAAWA;qBACvB,uCAACS,UAAMA;QACHgH,SAAQ;QACRC,SAASpC,CAAAA;YACLA,EAAEqC,cAAc;YAChBpG;QACJ;OACH,yBAGD,uCAACd,UAAMA;QAAC2E,MAAK;OAAS;AAItC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3XgD;AACgB;AACjB;AACf;AACiB;AACa;AACpB;AACP;AACyC;AAC5E,mCAAmC;AAEpB,SAASkD;IACpB,MAAM,CAAC3G,YAAYC,cAAc,GAAG3B,yBAAOA,CAACY,+BAAcA;IAC1D,MAAM,CAAC0H,MAAMC,QAAQ,GAAGX,4BAAQA,CAAU;IAC1C,MAAM,CAACY,gBAAgBC,kBAAkB,GAAGb,4BAAQA,CAAM,CAAC;IAC3D,MAAMc,oBAAoBf,0BAAMA,CAAC;IACjC,MAAM,EAAEzC,CAAC,EAAE,GAAG2C,6BAAcA;IAC5B,MAAM,CAACc,MAAMC,OAAO,GAAG5I,yBAAOA,CAAC8H,6BAAYA;IAC3C,MAAMe,QAAQT,iBAASA;IAEvB,OACI,iDAAiD;kBACjD,uCAAC1I,qBAAqBA;QAClBoJ,KAAKJ;QACLrC,WAAW7G,YAAG,CAAC;kCACO,EAAEqJ,MAAME,MAAM,GAAG,oBAAoB,OAAO;;;;;YAKlE,CAAC;qBAED,uCAACpJ;QAAI0G,WAAU;OAAuBnB,CAAC,CAAC,MAAM,CAAC,iBAC/C,uCAACvF;QAAI0G,WAAU;OACV3E,WAAW4B,GAAG,CAAC,CAAC/B,iBAAiByH;QAC9B,qBACI,uCAACrJ;YACGsJ,KAAKD,MAAME,QAAQ;YACnB7C,WAAW7G,YAAG,CAAC;;4BAEf,CAAC;yBAED,uCAAC2I,aAASA;YACNgB,MAAMX,cAAc,CAACjH,gBAAgB2B,EAAE,CAAC;YACxCkG,QAAQ;gBACJX,kBAAkB,sEACXD;oBACH,CAACjH,gBAAgB2B,EAAE,CAAC,EAAE;;YAE9B;YACAmG,SAAS;gBACLZ,kBAAkB,sEACXD;oBACH,CAACjH,gBAAgB2B,EAAE,CAAC,EAAE;;YAE9B;YACAoG,aAAa;YACbC,uBACI,uCAAClI,aAAaA;gBACVC,QAAQ;oBACJmH,kBAAkB,sEACXD;wBACH,CAACjH,gBAAgB2B,EAAE,CAAC,EAAE;;gBAE9B;gBACA3B,iBAAiBA;;YAGzBiI,WAAU;yBAEV,uCAAC7J,2BACG,uCAACqI,SAAKA;YACF,iMAAiM;YACjMiB,KAAKD;YACLS,oBACI,uCAAC9J;gBACG0G,WAAW7G,YAAG,CAAC;;;;gDAIf,CAAC;6BAED,uCAACkK,cAAMnI,gBAAgBiB,KAAK,iBAAG,uCAACkH,cAAMnI,gBAAgBiB,KAAK,kBAAW,uCAACkH,cAAM3B,mCAAYA,CAACxG,kCAC1F,uCAAC5B;gBACG0G,WAAW7G,YAAG,CAAC;;;oDAGf,CAAC;gBACDiI,SAAS;oBACL,MAAMkC,eAAejI,WAAW4C,MAAM,CAACe,CAAAA,IAAKA,MAAM9D;oBAClDI,cAAcgI;oBACdf,OAAOzF,CAAAA;wBACH,MAAMyG,eAAezG,KAAKyG,YAAY;wBACtCA,yBAAAA,mCAAAA,aAAcC,GAAG,CAAC,gBAAgBC,KAAKC,SAAS,CAACJ;wBACjD,OAAO,sEACAxG;4BACHyG;;oBAER;gBACJ;6BAEA,uCAAC3B,QAAIA;gBAACtB,MAAK;;YAIvBqD,OAAM;;IAM9B,kBACA,uCAAC7B,aAASA;QACNgB,MAAMb;QACNgB,aAAa;QACbF,QAAQ;YACJb,QAAQ;QACZ;QACAgB,uBACI,uCAAClI,aAAaA;YACVC,QAAQ;gBACJ4E,QAAQC,GAAG,CAAC;gBACZoC,QAAQ;YACZ;;QAGRiB,WAAU;qBAEV,uCAACtB,cAAUA;QAACvB,MAAK;QAAOsD,SAAQ;QAAaC,OAAO;YAACC,YAAY;QAAE;;AAKvF;;;ACrImC;AACT;AAEnB,MAAMC,cAAc;IACvB;QACInB,KAAK;QACLvG,OAAO;YAAC;YAAW;YAAU;YAAQ;SAAO;QAC5C2H,oBAAM,uCAACpC,QAAIA;YAACtB,MAAK;;IACrB;IACA;QACIsC,KAAK;QACLvG,OAAO;YAAC;YAAO;YAAY;YAAY;YAAW;YAAW;YAAU;YAAS;SAAS;QACzF2H,oBAAM,uCAACpC,QAAIA;YAACtB,MAAK;;IACrB;IACA;QACIsC,KAAK;QACLvG,OAAO;YAAC;YAAQ;YAAY;YAAU;SAAa;QACnD2H,oBAAM,uCAACpC,QAAIA;YAACtB,MAAK;;IACrB;IACA;QACIsC,KAAK;QACLvG,OAAO;YAAC;SAAQ;QAChB2H,oBAAM,uCAACpC,QAAIA;YAACtB,MAAK;;QACjB2D,SAAS;IACb;IACA;QACIrB,KAAK;QACLvG,OAAO;YAAC;SAAQ;QAChB2H,oBAAM,uCAACpC,QAAIA;YAACtB,MAAK;;QACjB2D,SAAS;IACb;IACA;QACIrB,KAAK;QACLvG,OAAO;YAAC;SAAU;QAClB2H,oBAAM,uCAACpC,QAAIA;YAACtB,MAAK;;IACrB;IACA;QACIsC,KAAK;QACLvG,OAAO;YAAC;SAAS;QACjB2H,oBAAM,uCAACpC,QAAIA;YAACtB,MAAK;;QACjB2D,SAAS;IACb;IACA;QACIrB,KAAK;QACLvG,OAAO;YAAC;SAAM;QACd2H,oBAAM,uCAACpC,QAAIA;YAACtB,MAAK;;QACjB2D,SAAS;IACb;IACA;QACIrB,KAAK;QACLvG,OAAO;YAAC;SAAU;QAClB2H,oBAAM,uCAACpC,QAAIA;YAACtB,MAAK;;QACjB2D,SAAS;IACb;IACA;QACIrB,KAAK;QACLvG,OAAO;YAAC;SAAO;QACf2H,oBAAM,uCAACpC,QAAIA;YAACtB,MAAK;;QACjB2D,SAAS;IACb;CACH,CAAC;AAEK,MAAMC,eAAe,CAACC;IACzB,MAAMC,oBAAoBL,YAAYzG,IAAI,CAACqD,CAAAA,OAAQA,KAAKtE,KAAK,CAACqC,IAAI,CAAC2F,CAAAA,MAAOF,WAAWG,iBAAiB,GAAG9F,QAAQ,CAAC6F;IAClH,OAAOD,8BAAAA,wCAAAA,kBAAmBJ,IAAI;AAClC,EAAE;;;;;;;ACjE2C;AACJ;AAElC,SAASS,GAAG,GAAGC,MAAoB;IACtC,OAAOF,8BAAOA,CAACD,oBAAIA,CAACG;AACxB;;;;;;;ACLmC;AACM;AACT;AACc;AACd;AACA;AACN;AACwD;AACvC;AAI3C,SAASM,uBAAuBC,SAAuB,EAAErC,GAAW;IAChE,MAAMsC,gBAAgB,IAAIC;IAE1BF,UAAUG,OAAO,CAACC,CAAAA;QACd,IAAIhJ,QAAQuI,sBAAGA,CAACS,KAAKzC;QACrB,IAAIvG,UAAU+C,WAAW;YACrB/C,QAAQ;QACZ;QACA6I,cAAc1B,GAAG,CAACnH,OAAO,CAAC6I,cAAcN,GAAG,CAACvI,UAAU,KAAK;IAC/D;IAEA,MAAMiJ,SAAsC,CAAC;IAC7CJ,cAAcE,OAAO,CAAC,CAACG,OAAOC;QAC1B,MAAMnJ,QAAQmJ;QACdF,MAAM,CAACjJ,MAAM,GAAGkJ;IACpB;IAEA,OAAOD;AACX;AAEO,SAASG,QAAQ,EAAEvJ,KAAK,EAAO;QAKRA;IAJ1B2D,QAAQC,GAAG,CAAC5D;IACZ,MAAMwJ,UAAU9L,8BAAYA,CAACiL,4BAAWA;IACxC,MAAMc,kBAAkB/L,8BAAYA,CAACkL,oCAAmBA;IACxD,MAAM,CAACzJ,YAAYC,cAAc,GAAG3B,yBAAOA,CAACY,+BAAcA;IAC1D,MAAMqL,oBAAoB1J,CAAAA,kBAAAA,6BAAAA,cAAAA,MAAOqB,IAAI,cAAXrB,kCAAAA,YAAa6C,WAAW,QAAO;IACzD,MAAM8G,MAAMC,OAAOC,OAAO,CAACf,uBAAuBU,SAASxJ,MAAM7B,KAAK,GAAG2L,IAAI,CAAC,CAACC,GAAQC,IAAWA,CAAC,CAAC,EAAE,CAACC,KAAK,GAAGF,CAAC,CAAC,EAAE,CAACE,KAAK;IAEzH,qBACI,uCAAC7M;QACG0G,WAAW7G,YAAG,CAAC;;;;YAIf,CAAC;qBAED,uCAACG;QAAI0G,WAAU;qBACX,uCAACqD;QAAKrD,WAAU;OAAQ9D,MAAM7B,KAAK,iBACnC,uCAACgJ,cAAK,KAAEnH,MAAMqB,IAAI,EAAC,qBAEvB,uCAACjE;QACG0G,WAAW7G,YAAG,CAAC;;;;gBAIf,CAAC;qBAED,uCAACG;QACG0G,WAAW7G,YAAG,CAAC;;;oBAGf,CAAC;OACJ,uBAGD,uCAACiN;QAAMpG,WAAU;OAAW2F,mBAAmB,MAAM,MAAMA,iBAAgB,YAE9EC,kCACG,uCAACtM;QAAI0G,WAAU;OACV6F,IAAI5I,GAAG,CACJ,CAAC,CAACZ,OAAO8J,MAAM,EAAExD,QACbA,QAAQ,mBACJ,uCAACrJ;YAAIsJ,KAAKD;YAAO3C,WAAU;yBACvB,uCAAC1G;YACG0G,WAAW7G,YAAG,CAAC;;;;wCAIf,CAAC;yBAED,uCAACG;YACG0G,WAAW7G,YAAG,CAAC;;;;;4CAKf,CAAC;yBAED,uCAACG;YACG0G,WAAW7G,YAAG,CAAC;;;;;gDAKf,CAAC;WAEAkD,sBAEL,uCAAC/C;YACG0G,WAAW7G,YAAG,CAAC;;;gDAGf,CAAC;WAEA,CAAC,CAAC,QAAS,MAAOuM,QAAQzE,MAAM,EAAEoF,OAAO,CAAC,IAAG,qBAGtD,uCAAC1B,uBAAQA;YACL2B,MAAM;YACNtG,WAAW7G,YAAG,CAAC;;;;;;;4CAOf,CAAC;YACD0K,OAAO;gBAAE0C,OAAO;gBAAQC,QAAQ;YAAM;YACtCC,SAAS,CAAC,CAAC,QAAS,MAAOf,QAAQzE,MAAM,EAAEoF,OAAO,CAAC;YACnDK,QAAO;YACPC,UAAU;aAGjB,CAAC5B,oCAAaA,CAAC7I,MAAMqB,IAAI,mBACtB,uCAACjE;YACG0G,WAAW7G,YAAG,CAAC;;4CAEf,CAAC;yBAED,uCAAC0I,cAAUA;YACPvB,MAAK;YACLc,SAASpC,CAAAA;gBACLa,QAAQC,GAAG,CAACzD;gBACZf,cAAc;uBACPD;oBACH;wBACIe,WAAWF,MAAM7B,KAAK;wBACtBiC,UAAU;wBACVD,OAAO;4BAAC,OAAOA,UAAU,WAAWA,QAAQ,CAACA;yBAAM;wBACnDQ,IAAI/C,gCAAMA;oBACd;iBACH;gBACDkF,EAAE4H,eAAe;YACrB;YACAhD,SAAQ;0BAEZ,uCAAC/B,cAAUA;YACPvB,MAAK;YACLuD,OAAO;gBAAEC,YAAY;YAAM;YAC3BF,SAAQ;YACRxC,SAASpC,CAAAA;gBACL1D,cAAc;uBACPD;oBACH;wBACIe,WAAWF,MAAM7B,KAAK;wBACtBiC,UAAU;wBACVD,OAAO;4BAAC,OAAOA,QAAQA,QAAQ,CAACA;yBAAM;wBACtCQ,IAAI/C,gCAAMA;oBACd;iBACH;gBACDkF,EAAE4H,eAAe;YACrB;+BAShC,uCAACtN;QAAI0G,WAAU;OAAuB;AAItD;;;AChL0B;AACgB;AACqB;AAC5B;AACC;AACU;AAS/B,SAAS6G,UAAUC,KAAqB;IACnD,MAAMtE,QAAQT,iBAASA;IACvB,MAAM,EAAE7F,KAAK,EAAE,GAAG4K;IAClB5K,MAAM0G,GAAG,GAAG1G,MAAM7B,KAAK;IACvB,IAAI6B,MAAM6K,QAAQ,EAAE;QAChB7K,MAAM8H,IAAI,iBAAG,uCAAC1K;YAAI0G,WAAU;;QAC5B,qBACI,uCAAC1G;YAAI0G,WAAU;WAAa;IAKpC;IACA,qBACI,uCAAC1G,2BACG,uCAACwI,aAASA;QAACqB,WAAU;QAAQD,uBAAS,uCAACuC,OAAOA;YAACvJ,OAAOA;;qBAClD,uCAAC5C;QACG0G,WAAW7G,YAAG,CAAC;;;;;;;;;;;;;8CAaW,EAAEqJ,MAAMwE,MAAM,CAACC,UAAU,CAACC,SAAS,CAAC;;oBAE9D,CAAC;qBAED,uCAAC5N;QAAI0G,WAAU;qBACX,uCAAC1G,aAAK4K,YAAYA,CAAChI,KAAK,CAAC,OAAO,kBAChC,uCAAC5C;QACG0G,WAAW7G,YAAG,CAAC;;;;;;;4BAOf,CAAC;OAEA+C,KAAK,CAAC,QAAQ,kBAGvB,uCAAC5C;QACG0G,WAAWyE,EAAEA,CACT,gBACAtL,YAAG,CAAC;;;;;;uCAMO,EAAEqJ,MAAMwE,MAAM,CAAC5D,IAAI,CAAC8D,SAAS,CAAC;;2CAE1B,EAAE1E,MAAMwE,MAAM,CAAC5D,IAAI,CAAC+D,OAAO,CAAC;;4BAE3C,CAAC;OAGJL,MAAMhI,IAAI,KAAK,sBACZ,uCAAC+C,cAAUA;QACPvB,MAAK;QACLsD,SAAQ;QACRxC,SAASpC,CAAAA;gBACL8H;YAAAA,kBAAAA,6BAAAA,eAAAA,MAAOM,KAAK,cAAZN,mCAAAA,kBAAAA,OAAe5K;YACf8C,EAAE4H,eAAe;QACrB;uBAGJ,uCAAC/E,cAAUA;QACPvB,MAAK;QACLsD,SAAQ;QACRxC,SAAS,CAACpC;gBACN8H;YAAAA,kBAAAA,6BAAAA,kBAAAA,MAAOO,QAAQ,cAAfP,sCAAAA,qBAAAA,OAAkB5K;YAClB8C,EAAE4H,eAAe;QACrB;;AAQhC;;;ACvG+C;AACf;AACN;AACuD;AACO;AACjC;AACpB;AAE5B,SAAS5L,4BAAaA;IAC3B,MAAM,EAAE6D,CAAC,EAAE,GAAG2C,6BAAcA;IAC5B,MAAM,CAACoG,YAAYC,cAAc,GAAGlO,yBAAOA,CAAC2N,+BAAcA;IAC1D,MAAM,CAACQ,cAAcC,gBAAgB,GAAGpO,yBAAOA,CAAC4N,iCAAgBA;IAChE,MAAM,CAACS,WAAWC,aAAa,GAAGtO,yBAAOA,CAAC6N,8BAAaA;IACvD,OACE,+DAA+D;kBAC/D,uCAAClO;QAAI0G,WAAW7G,YAAG,CAAC;;;IAGpB,CAAC;qBAEC,uCAACG;QAAI0G,WAAW7G,YAAG,CAAC;;;QAGlB,CAAC;OAAG,CAAC,YAAY,CAAC,iBACpB,uCAACG;QAAI0G,WAAW7G,YAAG,CAAC;;;QAGlB,CAAC;qBACD,uCAACG;QAAI0G,WAAW7G,YAAG,CAAC;;;UAGlB,CAAC;OAAI0F,CAAC,CAAC,YAAY,CAAC,iBACtB,uCAACvF,2BACC,uCAACqO,oBAAgBA;QACf,wBAAwB;QACxBjH,SAAS+G,+BAAYA;QACrBpL,OAAOyL;QACPjH,UAAU,CAACwD;YACT0D,gBAAgB1D;QAClB;wBAIN,uCAAC/K;QAAI0G,WAAW7G,YAAG,CAAC;;;QAGlB,CAAC;qBACD,uCAACG;QAAI0G,WAAW7G,YAAG,CAAC;;;UAGlB,CAAC;OAAI0F,CAAC,CAAC,UAAU,CAAC,iBACpB,uCAACvF,2BACC,uCAACqO,oBAAgBA;QACf,sBAAsB;QACtBjH,SAASgH,6BAAUA;QACnBrL,OAAOuL;QACP/G,UAAU,CAACwD;YACTwD,cAAcxD;QAChB;wBAIN,uCAAC/K;QAAI0G,WAAW7G,YAAG,CAAC;;;QAGlB,CAAC;qBACD,uCAACG;QAAI0G,WAAW7G,YAAG,CAAC;;;UAGlB,CAAC;OAAI0F,CAAC,CAAC,IAAI,CAAC,iBACd,uCAAC9E,UAAMA;QACLsC,OAAO2L;QACPnH,UAAU,CAACxE;YACT4L,aAAa5L;QACf;QACAqE,SAAS;YACP;gBACErE,OAAO;gBACPF,OAAO;YACT;YACA;gBACEE,OAAO;gBACPF,OAAO;YACT;YACA;gBACEE,OAAO;gBACPF,OAAO;YACT;YACA;gBACEE,OAAO;gBACPF,OAAO;YACT;SACD;;AAKX;;;ACjG8C;AACN;AACQ;AACgB;AACkG;AACvE;AACC;AACzD;AAEpB,SAASqM;IACpB,MAAM,CAACC,gBAAgBC,kBAAkB,GAAG/O,yBAAOA,CAACuO,mCAAkBA;IACtE,MAAM,CAACS,2BAA2BC,6BAA6B,GAAGjP,yBAAOA,CAACwO,8CAA6BA;IACvG,MAAM/M,cAAcxB,8BAAYA,CAACU,gCAAeA;IAChD,MAAM,CAACsN,YAAYiB,eAAe,GAAGlP,yBAAOA,CAAC2N,+BAAcA;IAC3D,MAAM,CAACQ,cAAcgB,iBAAiB,GAAGnP,yBAAOA,CAAC4N,iCAAgBA;IACjE,MAAM,CAACS,WAAWe,cAAc,GAAGpP,yBAAOA,CAAC6N,8BAAaA;IACxD,MAAM,CAACwB,aAAaC,eAAe,GAAG1H,4BAAQA,CAAC;IAC/C,MAAM7F,UAAU9B,8BAAYA,CAACc,4BAAWA;IACxC,MAAM8H,QAAQT,iBAASA;IACvB,MAAMmH,iBAAiB9N,YAClB6C,MAAM,CAAC/B,CAAAA;QACJ,IAAI4L,iBAAiBM,mCAAgBA,CAACe,GAAG,EAAE;YACvC,OAAO;QACX;QACA,IAAIrB,iBAAiBM,mCAAgBA,CAACgB,GAAG,EAAE;YACvC,OAAOxO,mCAAYA,CAACsB,MAAMqB,IAAI,MAAM;QACxC;QACA,IAAIuK,iBAAiBM,mCAAgBA,CAACiB,EAAE,EAAE;YACtC,OAAOzO,mCAAYA,CAACsB,MAAMqB,IAAI,MAAM;QACxC;QACA,OAAO;IACX,GACCU,MAAM,CAAC,CAAC/B;QACL,IAAI0L,eAAeS,iCAAcA,CAACc,GAAG,EAAE;YACnC,OAAO;QACX;QACA,IAAIvB,eAAeS,iCAAcA,CAACe,GAAG,EAAE;YACnC,OAAO1N,QAAQgD,IAAI,CAACiE,CAAAA,QAASzG,MAAM7B,KAAK,KAAKsI,MAAMtI,KAAK;QAC5D;QACA,IAAIuN,eAAeS,iCAAcA,CAACgB,EAAE,EAAE;YAClC,OAAO,CAAC3N,QAAQgD,IAAI,CAACiE,CAAAA,QAASzG,MAAM7B,KAAK,KAAKsI,MAAMtI,KAAK;QAC7D;QACA,OAAO;IACX,GACC4D,MAAM,CAAC/B,CAAAA;QACJ,IAAI8L,cAAcM,gCAAaA,CAACa,GAAG,EAAE;YACjC,OAAO;QACX;QACA,OAAOvO,mCAAYA,CAACsB,MAAMqB,IAAI,MAAMyK;IACxC;IACJ,MAAMsB,oBAAoBb,eAAexH,MAAM,GAAG;IAClD,MAAMsI,kBAAkBL,eAAejL,MAAM,CAACuL,CAAAA;QAC1C,IAAIf,eAAenL,IAAI,CAACqD,CAAAA,OAAQ6I,KAAK,CAAC,QAAQ,KAAK7I,IAAI,CAAC,QAAQ,GAAG;YAC/D,OAAO;QACX;QACA,OAAO;IACX;IAEA,SAAS8I,UAAUvN,KAAU;QACzBwM,kBAAkB;eAAID;YAAgBvM;SAAM;QAC5C0M,6BAA6B;eAAID;YAA2BzM;SAAM;IACtE;IAEA,SAASwN,aAAaxN,KAAU;QAC5B,MAAMyG,QAAQ8F,eAAekB,SAAS,CAAC,CAAChJ,OAAcA,KAAKtG,KAAK,KAAK6B,MAAM7B,KAAK;QAChFoO,eAAemB,MAAM,CAACjH,OAAO;QAE7B,MAAMkH,WAAWlB,0BAA0BgB,SAAS,CAAC,CAAChJ,OAAcA,KAAKtG,KAAK,KAAK6B,MAAM7B,KAAK;QAC9FsO,0BAA0BiB,MAAM,CAACC,UAAU;QAC3CnB,kBAAkB;eAAID;SAAe;QACrCG,6BAA6B;eAAID;SAA0B;IAC/D;IAEA,qBACI,uCAACrP;QACG0G,WAAW7G,YAAG,CAAC;;;;YAIf,CAAC;qBAED,uCAACG;QACG0G,WAAW7G,YAAG,CAAC;;sCAEO,EAAEqJ,MAAME,MAAM,GAAG,oBAAoB,OAAO;;;;;gBAKlE,CAAC;qBAED,uCAACd,QAAIA;QAACtB,MAAK;sBACX,uCAAClG,SAAKA;QACFwG,aAAa,CAAC,MAAM,CAAC;QACrBZ,WAAW7G,YAAG,CAAC;;oBAEf,CAAC;QACDkD,OAAO2M;QACPnI,UAAU,CAAC7B,IAAWiK,eAAejK,EAAE8K,MAAM,CAACzN,KAAK;sBAEvD,uCAACyF,aAASA;QAACoB,uBAAS,uCAAClI,4BAAaA;qBAC9B,uCAAC4G,QAAIA;QAACtB,MAAK;wBAGnB,uCAAChH;QACG0G,WAAW7G,YAAG,CAAC;;;;sCAIO,EAAEqJ,MAAME,MAAM,GAAG,oBAAoB,OAAO;;;gBAGlE,CAAC;qBAED,uCAAC6F,sBAAkBA;QAACpM,qBAAO,uCAACkH;YAAKrD,WAAW7G,YAAG,CAAC;;;;oBAI5C,CAAC;WAAE;QAAwB4Q,QAAQ;qBACnC,uCAACzQ;QACG0G,WAAW7G,YAAG,CAAC;;wBAEf,CAAC;OAEAmQ,kCACG,uCAAChQ;QACG0G,WAAW7G,YAAG,CAAC;;gCAEf,CAAC;OAEAsP,eACIxK,MAAM,CAAC,CAAC/B;QACL,OAAOA,KAAK,CAAC,QAAQ,CAACqC,WAAW,GAAGC,QAAQ,CAACwK,YAAYzK,WAAW;IACxE,GACCtB,GAAG,CAAC,CAACf,OAAYyG,sBACd,uCAACkE,SAASA;YAAC/H,MAAK;YAAS8D,KAAKD;YAAOzG,OAAOA;YAAOmL,UAAUnL,CAAAA,QAASwN,aAAaxN;6BAI/F,uCAAC/B,UAAMA;QACH6J,MAAK;QACLsC,MAAK;QACLnF,SAAQ;QACR6I,MAAK;QACLC,WAAW;QACXjK,WAAW7G,YAAG,CAAC;;;;gCAIf,CAAC;OACJ,4BAMb,uCAACoP,sBAAkBA;QAACpM,qBAAO,uCAACkH;YAAKrD,WAAW7G,YAAG,CAAC;;;;oBAI5C,CAAC;WAAE;QAA0B4Q,QAAQ;qBACrC,uCAACzQ;QACG0G,WAAW7G,YAAG,CAAC;;wBAEf,CAAC;OAEAoQ,gBACItL,MAAM,CAAC,CAAC/B;QACL,OAAOA,KAAK,CAAC,QAAQ,CAACqC,WAAW,GAAGC,QAAQ,CAACwK,YAAYzK,WAAW;IACxE,GACCtB,GAAG,CAAC,CAACf,OAAYyG,sBACd,uCAACkE,SAASA;YAAC/H,MAAK;YAAM5C,OAAOA;YAAO0G,KAAKD;YAAOyE,OAAOlL,CAAAA,QAASuN,UAAUvN;;AAO1G;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClL6C;AACa;AACC;AACjC;AACsB;AACN;AACE;AACgD;AAC6F;AACtJ;AAE5B,SAASgP;QAmNoBC,eAAyCA;IAlNzE,MAAM3I,QAAQT,iBAASA,GAAGW,MAAM,GAAG,SAAS;IAC5C,MAAM,CAACyI,aAAaC,eAAe,GAAGzR,yBAAOA,CAAC+Q,gCAAeA;IAC7D,MAAMW,uBAAuB/J,0BAAMA,CAAe;IAClD,MAAM,CAACgK,iBAAiBC,mBAAmB,GAAG5R,yBAAOA,CAACgR,oCAAmBA;IACzE,MAAMa,gBAAgBrB,4BAAUA,CAACS,mCAAkBA;IAEnD,MAAMa,kBAAkB7R,8BAAYA,CAACiR,oCAAmBA;IACxD,IAAIa,KAAqC,EAAE;AAAA,EAE1C;IACD,MAAM,CAACI,gBAAgBC,kBAAkB,GAAGxK,4BAAQA,CAAC;IACrD,MAAM,CAACyK,UAAUC,YAAY,GAAGtS,yBAAOA,CAACmR,6BAAYA;IACpD,IAAIY,KAAqC,EAAE;AAAA,EAE1C;IACD,MAAM/F,kBAAkB/L,8BAAYA,CAACkL,oCAAmBA;IACxD,MAAM,CAACoH,YAAYC,aAAa,GAAGxS,yBAAOA,CAACsR,8BAAaA;IACxD,MAAM,CAACmB,WAAWC,YAAY,GAAG1S,yBAAOA,CAACoR,6BAAYA;IACrD,MAAMuB,UAAUnC,4BAAUA,CAACa,yBAAQA;IAEnCpO,6BAASA,CAAC;QACN,MAAM0B,IAAIiM,qCAAeA,CAACY,aAAoBW,cAAc;QAC5DC,kBAAkBzN;IACtB,GAAG;QAAC6M;KAAY;IAEhB,MAAMoB,eAAeP,aAAa3B,wBAAYA,CAACmC,IAAI,GAAG/B,iDAA2BA,CAACuB,YAAY,GAAGF,eAAe,CAAC,EAAErB,iDAA2BA,CAACuB,WAAW;IAE1J,IAAIS,OAAO,CAAC,IAAIC,KAAK,MAAM,GAAG;IAC9B,IAAIC,SAAS,KAAK,OAAO;IACzB,IAAIC,OAAO;QAAC;YAACH;YAAMI,KAAKC,MAAM,KAAK;SAAI;KAAC;IACxC,IAAK,IAAIC,IAAI,GAAGA,IAAI,OAAOA,IAAK;QAC5B,IAAIC,MAAM,IAAIN,KAAMD,QAAQE;QAC5BC,KAAKK,IAAI,CAAC;YAAC,CAACD;YAAKH,KAAKK,KAAK,CAAC,CAACL,KAAKC,MAAM,KAAK,GAAE,IAAK,KAAKF,IAAI,CAACG,IAAI,EAAE,CAAC,EAAE;SAAE;IAC7E;IAEA,MAAMrM,UAAe;QACjByM,OAAO;YACHC,SAAS,GAAG,CAAC,aAAa,CAAC,CAAC,EAAE,EAAEb,cAAc;YAC9Cc,MAAM;YACNC,KAAK;QACT;QACAC,MAAM;YACFF,MAAM;YACNG,OAAO;YACPC,QAAQ;YACRC,cAAc;QAClB;QACA/J,OAAOnB,UAAU,UAAU;YAAC;SAAU,GAAG;YAAC;SAAU;QACpDmL,OAAO;YACH7O,MAAM;YACN8N,MAAMnB,gBAAgBxO,GAAG,CAAC+B,CAAAA,IAAKA,CAAC,CAAC,KAAK;YACtC4O,WAAW;gBACPC,UAAU;gBACVC,WAAW;gBACXC,YAAY;gBACZpK,OAAOnB,UAAU,UAAU,YAAY;YAC3C;YACAwL,UAAU;gBACNC,WAAW;oBACP1H,OAAO;oBACP5C,OAAOnB,UAAU,UAAU,YAAY;gBAC3C;YACJ;YACA0L,UAAU;gBACNpL,MAAM;YACV;QACJ;QACAqL,SAAS;YACLrL,MAAM;QACV;QACAsL,OAAO;YACHC,YAAY;QAChB;QACAC,OAAO;YACHhO,MAAM,CAAC,KAAK,CAAC;YACbiO,eAAe;gBACXC,OAAO;gBACPC,SAAS;oBAAC;oBAAG;iBAAE;YACnB;YACA3P,MAAM;YACN4P,WAAW;gBACP5L,MAAM;gBACNmL,WAAW;oBACP1H,OAAO;oBACP5C,OAAOnB,UAAU,UAAU,YAAY;gBAC3C;YACJ;YACAoL,WAAW;gBACPC,UAAU;gBACVC,WAAW;gBACXC,YAAY;YAChB;QACJ;QACAnK,SAAS;YACL+K,SAAS;YACTC,aAAa;gBACT9P,MAAM;YACV;YACA2P,SAAS;YACTI,aAAa;YACbC,iBAAiBtM,UAAU,UAAU,YAAY;YACjDuM,WAAW,SAAUC,MAAW;gBAC5B,MAAMC,OAAO,CAAC;;;;;;iDAMmB,EAAEzM,UAAU,UAAU,YAAY,UAAU;;gGAEG,EAAEA,UAAU,UAAU,YAAY,UAAU,GAAG,EAAE;oBAACwM,MAAM,CAAC,EAAE,CAAC1O,IAAI;iBAAC,CAAC;0MACwC,EAAE;oBACpL0O,MAAM,CAAC,EAAE,CAAC3S,KAAK,IAAI;iBACtB,CAAC;wCACkB,CAAC;gBACzB,OAAO4S;YACX;QACJ;QAEAC,QAAQ;YACJ;gBACItC,MAAMnB,gBAAgBxO,GAAG,CAAC+B,CAAAA,IAAKA,CAAC,CAAC,WAAW;gBAC5CF,MAAM;gBACNqQ,UAAU;YACd;SACH;QAEDC,WAAW;IACf;IAEAxS,6BAASA,CAAC;QACN,MAAMyS,QAAQhE,qBAAqB7L,OAAO;QAC1C,IAAI6P,SAAS5D,gBAAgBxK,MAAM,GAAG,GAAG;YACrC,MAAMqO,UAAU,CAAC,EAAEC,KAAK,EAAO;gBAC3B,IAAI,CAACA,MAAMtO,MAAM,EAAE;oBACf;gBACJ;gBACAqL,QAAQ;gBACRD,YAAY;gBACZb,cAAcpM;gBACd,MAAM,CAACoQ,YAAYC,SAAS,GAAG,KAAM,CAAC,EAAE,CAASC,UAAU;gBAC3D,MAAMnD,eAAeP,aAAa3B,wBAAYA,CAACmC,IAAI,GAAGjC,qCAAeA,CAACY,aAAoBwE,aAAa,GAAG3D;gBAC1G,MAAM4D,gBAAgBxF,mBAAKA,CAAC,IAAIsC,KAAKjB,eAAe,CAACgE,SAAS,CAAC,KAAK,GAAGI,GAAG,CAAC/D,gBAAgBS;gBAC3F1M,QAAQC,GAAG,CAAC,OAAMwL;gBAElBC,mBAAmB,4EACZD;oBACHwE,MAAM;wBAAC1F,mBAAKA,CAACqB,eAAe,CAAC+D,WAAW,CAAC,KAAK;wBAAGI;qBAAc;;gBAGnExE,eAAe;oBAAChB,mBAAKA,CAACqB,eAAe,CAAC+D,WAAW,CAAC,KAAK;oBAAGI;iBAAc;gBACxE,MAAMG,YAAY;oBACdC,MAAM5F,mBAAKA,CAACqB,eAAe,CAAC+D,WAAW,CAAC,KAAK,EAAES,MAAM,CAACzF,6BAAWA;oBACjE0F,IAAIN,cAAcK,MAAM,CAACzF,6BAAWA;oBACpC2F,KAAK;wBACDH,MAAM5F,mBAAKA,CAACqB,eAAe,CAAC+D,WAAW,CAAC,KAAK,EAAES,MAAM,CAACzF,6BAAWA;wBACjE0F,IAAIN,cAAcK,MAAM,CAACzF,6BAAWA;oBACxC;gBACJ;gBACA2B,aAAa4D;gBACbV,MAAMe,kBAAkB,GAAGC,cAAc,CAAC;oBACtCvR,MAAM;oBACNwR,SAAS;oBACTf,OAAO,EAAE;gBACb;YACJ;YAEA,IAAIF,MAAMkB,GAAG,EAAE;gBACXlB,MAAMe,kBAAkB,GAAGC,cAAc,CAAC;oBACtCvR,MAAM;oBACN8D,KAAK;oBACL4N,aAAa;wBACTC,WAAW;oBACf;gBACJ;gBACApB,MAAMe,kBAAkB,GAAGM,EAAE,CAAC,YAAYpB;gBAE1C,OAAO;oBACH,IAAID,MAAMkB,GAAG,EAAE;wBACXlB,MAAMe,kBAAkB,GAAGO,GAAG,CAAC,YAAYrB;oBAC/C;gBACJ;YACJ;QACJ;QACA,OAAOlQ;IACP,uDAAuD;IAC3D,GAAG;QAACqM;KAAgB;IACpB,qBACI,uCAACnS;QAAI0G,WAAW7G,YAAG,CAAC,gBAAgB,CAAC;qBACjC,uCAACG;QACG0G,WAAW7G,YAAG,CAAC;;;;gBAIf,CAAC;qBAED,uCAACG,2BACG,uCAAC+J;QAAKrD,WAAW7G,YAAG,CAAC;;;wBAGjB,CAAC;OAEAwM,kBAAkBA,gBAAgB9C,QAAQ,GAAG+N,OAAO,CAAC,wBAAwB,SAAS,MACnF,mBACR,uCAACvN;QAAKrD,WAAW7G,YAAG,CAAC,gBAAgB,CAAC;OAAG,CAAC,IAAI,CAAC,kBAEnD,uCAACG;QAAI0G,WAAW7G,YAAG,CAAC;;;oBAGhB,CAAC;OACHgS,eAAe,IAAGA,gBAAAA,WAAW,CAAC,EAAE,cAAdA,oCAAAA,cAAgB8E,MAAM,CAACzF,6BAAWA,EAAE,GAAG,GAAEW,iBAAAA,WAAW,CAAC,EAAE,cAAdA,qCAAAA,eAAgB8E,MAAM,CAACzF,6BAAWA,EAAE,CAAC,CAAC,iBACnG,uCAAClR;QACG0G,WAAW7G,YAAG,CAAC;;oBAEf,CAAC;qBAED,uCAACY,UAAMA;QACHsC,OAAO2P;QACPnL,UAAUgQ,CAAAA;YACN5E,YAAY4E,iBAAiBxU,KAAK;QACtC;QACAqE,SAAS4J,iCAAcA;wBAInC,uCAAChR;QACG0G,WAAW7G,YAAG,CAAC;;gBAEf,CAAC;qBAED,uCAAC+Q,kBAAYA;QAAC4G,QAAQpQ;QAAS+B,KAAK4I;;AAIpD;;;;;;;;;;;ACtPwC;AACgF;AAC7D;AACxB;AAUpB,SAASgG,mBAAsBvK,KAAiC;IAC3E,MAAM,EAAE8F,IAAI,EAAE0E,OAAO,EAAEC,kBAAkB,EAAEC,eAAe,EAAExR,SAAS,EAAE,GAAG8G;IAC1E,MAAMtE,QAAQT,iBAASA;IACvB,MAAM0P,QAAQN,6BAAaA,CAAM;QAC7BvE;QACA0E;QACAE;QACAP,iBAAiBA,qCAAeA;QAChCC,qBAAqBA,yCAAmBA;IAC5C;IAEA,qBACI,uCAACO;QAAMzR,WAAWA;qBACd,uCAAC0R,eACID,MAAME,eAAe,GAAG1U,GAAG,CAAC2U,CAAAA,4BACzB,uCAACC;YAAGjP,KAAKgP,YAAY/U,EAAE;YAAEmD,WAAW7G,YAAG,CAAC,EAAEqJ,MAAME,MAAM,GAAG,sDAAsD,+CAA+C,CAAC,CAAC;WAC3JkP,YAAYE,OAAO,CAAC7U,GAAG,CAAC8U,CAAAA;YACrB,qBACI,uCAACC;gBACGpP,KAAKmP,OAAOlV,EAAE;gBACdoV,SAASF,OAAOE,OAAO;gBACvBjS,WAAW7G,YAAG,CAAC;;;;;;8DAMW,EAAEqJ,MAAM0P,OAAO,GAAG,uCAAuC,0CAA0C;;;;;;;;;;;;wCAYzH,CAAC;eAEJH,OAAOI,aAAa,GAAG,OAAOnB,0BAAUA,CAACe,OAAOK,MAAM,CAACC,SAAS,CAACN,MAAM,EAAEA,OAAOO,UAAU;QAGvG,qBAIZ,uCAACC;QACGvS,WAAW7G,YAAG,CAAC;;;;gBAIf,CAAC;OAEAsY,MAAMe,WAAW,GAAGC,IAAI,CAACxR,MAAM,GAAG,IAC/BwQ,MAAMe,WAAW,GAAGC,IAAI,CAACxV,GAAG,CAACyV,CAAAA;QACzB,qBACI,uCAAC3B,wBAAQA;YAACnO,KAAK8P,IAAI7V,EAAE;yBACjB,uCAACgV;YACGhV,IAAI6V,IAAIC,QAAQ,CAAC7R,QAAQ,GAAG,aAAa;YACzC,yBAAyB;YACzB,6FAA6F;YAC7F,wDAAwD;YACxD,wEAAwE;YACxE,KAAK;YACLd,WAAW7G,YAAG,CAAC;wCACX,EAAEuZ,IAAIE,aAAa,KAAK,CAAC,YAAY,CAAC,GAAG,GAAGpQ,MAAME,MAAM,GAAG,sDAAsD,+CAA+C,CAAC,CAAC,CAAC;;wCAEnK,EAAEF,MAAM0P,OAAO,GAAG,CAAC;+DACI,EAAEQ,IAAIC,QAAQ,CAAC7R,QAAQ,GAAG,yBAAyB,iBAAiB;;;;4CAIvF,CAAC,GAED,CAAC;8DACiB,EAAE4R,IAAIC,QAAQ,CAAC7R,QAAQ,GAAG,mBAAmB,iBAAiB;;;;;4CAKhF,CAAC,CACJ;oCACL,CAAC;WAEA4R,IAAIG,eAAe,GAAG5V,GAAG,CAAC6V,CAAAA;YACvB,qBACI,uCAACC;gBAAGnQ,KAAKkQ,KAAKjW,EAAE;gBAAEmD,WAAW7G,YAAG,CAAC;;;;4CAIjC,CAAC;eACI2Z,KAAKR,UAAU,GAAGrT,QAAQ,OAAO,OAAO+R,0BAAUA,CAAC8B,KAAKV,MAAM,CAACC,SAAS,CAACS,IAAI,EAAEA,KAAKR,UAAU,MAAM;QAGjH,KAEHI,IAAIE,aAAa,oBACd,uCAACf;YACG,2FAA2F;YAC3F7R,WAAW7G,YAAG,CAAC;;;;;;;;;;;;;oCAanB,CAAC;yBAEG,uCAAC4Z;YAAGd,SAASS,IAAIG,eAAe,GAAG5R,MAAM;YAAEjB,WAAW7G,YAAG,CAAC;;;4CAGtD,CAAC;WACAoY,mBAAmB;YAAEmB;QAAI;IAMlD,mBAEA,uCAACb,0BACG,uCAACkB;QAAGd,SAASX,QAAQrQ,MAAM;qBACvB,uCAACmQ,qBAAiBA,QAAE,CAAC,OAAO,CAAC;AAOzD;;;ACtJmC;AACE;AAE9B,MAAM4B,aAAa7Z,YAAG,CAAC;;;;;;AAM9B,CAAC,CAAC;AAEK,MAAM8Z,qBAAqB7Z,yCAAMA,CAACE,GAAG,CAAC;;;;;;AAM7C,CAAC,CAAC;;;ACjBuC;AACK;AACd;AACN;AAC2D;AAC1C;AAEpC,SAAS4Z,oBAAoB,EAAE9W,SAAS,EAAE+W,UAAU,EAAO;QAI5C/X;IAHlB,MAAM,CAACqN,gBAAgBC,kBAAkB,GAAG/O,yBAAOA,CAACuO,mCAAkBA;IACtE,MAAM,CAAC7M,YAAYC,cAAc,GAAG3B,yBAAOA,CAACY,+BAAcA;IAC1D,MAAMa,cAAcxB,8BAAYA,CAACU,gCAAeA;IAChD,MAAM0N,aAAY5M,oBAAAA,YAAYkC,IAAI,CAACpB,CAAAA,QAASA,MAAM7B,KAAK,KAAK+B,wBAA1ChB,wCAAAA,kBAAsDmC,IAAI;IAC5E,MAAM6V,WAAW3K,eAAe/J,IAAI,CAAC,CAACiC,OAAcA,KAAKtG,KAAK,KAAK+B;IACnE,MAAMiX,cAAc,OAAOF,eAAe,WAAW1P,KAAKC,SAAS,CAACyP,cAAcA;IAClF,qBACI,gGACI,uCAAC7Z;QAAI0G,WAAU;QAAQ6D,OAAO;YAAEyP,SAAS;YAAQC,gBAAgB;QAAW;OACvE,CAACxO,oCAAaA,CAACiD,4BACZ,gGACI,uCAACnG,cAAUA;QACPvB,MAAK;QACLsD,SAAQ;QACRxC,SAAS;YACL9F,cAAc;mBAAID;gBAAY;oBAAEe,WAAWA;oBAAWE,UAAU;oBAAKD,OAAO;wBAACgX;qBAAY;oBAAExW,IAAI/C,gCAAMA;gBAAG;aAAE;QAC9G;sBAEJ,uCAAC+H,cAAUA;QACPvB,MAAK;QACLsD,SAAQ;QACRxC,SAAS;YACL9F,cAAc;mBAAID;gBAAY;oBAAEe,WAAWA;oBAAWE,UAAU;oBAAMD,OAAO;wBAACgX;qBAAY;oBAAExW,IAAI/C,gCAAMA;gBAAG;aAAE;QAC/G;uBAIZ,uCAAC+H,cAAUA;QACHvB,MAAK;QACLsD,SAASwP,WAAW,sBAAsB;QAC1ChS,SAAS;YACL,MAAMlF,QAAQd,YAAYkC,IAAI,CAACpB,CAAAA,QAASA,MAAM7B,KAAK,KAAK+B;YACxD,IAAIgX,UAAU;gBACV,MAAMzQ,QAAQ8F,eAAekB,SAAS,CAAC,CAAChJ,OAAcA,KAAKtG,KAAK,KAAK+B;gBACrEqM,eAAemB,MAAM,CAACjH,OAAO;gBAC7B+F,kBAAkB;uBAAID;iBAAe;YACzC,OAAO;gBACHC,kBAAkB;uBAAID;oBAAgBvM;iBAAM;YAChD;QACJ;;AAKxB;;;ACpDgC;AACG;AACH;AACgB;AACtB;AACiB;AACF;AAQlC,SAASsX,YAAY,EAAEpX,SAAS,EAAE+W,UAAU,EAAEnL,SAAS,EAAoB;IAC9E,MAAM,CAAC3M,YAAYC,cAAc,GAAG3B,yBAAOA,CAACY,+BAAcA;IAC1D,qBACI,uCAACjB,aACI,CAACyL,oCAAaA,CAACiD,4BACZ,uCAAC1O;QAAI0G,WAAW7G,YAAG,CAAC;;;;gBAIpB,CAAC;qBACG,uCAAC0I,cAAUA;QACPvB,MAAK;QACLc,SAASpC,CAAAA;YACL1D,cAAc;mBAAID;gBAAY;oBAAEe;oBAAWE,UAAU;oBAAKD,OAAO;wBAAC8W;qBAAW;oBAAEtW,IAAI/C,gCAAMA;gBAAG;aAAE;YAC9FkF,EAAE4H,eAAe;QACrB;QACAhD,SAAQ;sBAEZ,uCAAC/B,cAAUA;QACPvB,MAAK;QACLuD,OAAO;YAAEC,YAAY;QAAM;QAC3B1C,SAASpC,CAAAA;YACL1D,cAAc;mBACPD;gBACH;oBACIe;oBACAE,UAAU;oBACVD,OAAO;wBAAC8W;qBAAW;oBACnBtW,IAAI/C,gCAAMA;gBACd;aACH;YACDkF,EAAE4H,eAAe;QACrB;QACAhD,SAAQ;;AAMhC;;;;;ACrDgC;AACA;AACW;AACF;AACf;AACS;AACwB;AAQpD,SAAS8P,uBAAuB,EAAEtX,SAAS,EAAE+W,UAAU,EAAEnL,SAAS,EAAoB;IACzF,MAAM,CAAC2L,uBAAuBC,yBAAyB,GAAGja,yBAAOA,CAAC8Z,0CAAyBA;IAC3F,qBACI,uCAACna,aACI,CAACyL,oCAAaA,CAACiD,4BACZ,uCAAC1O;QAAI0G,WAAW7G,YAAG,CAAC;;;;gBAIpB,CAAC;qBACG,uCAAC0I,cAAUA;QACPvB,MAAK;QACLc,SAASpC,CAAAA;YACL4U,yBAAyB;mBAAID;gBAAuB;oBAAEvX;oBAAWE,UAAU;oBAAKD,OAAO;wBAAC8W;qBAAW;oBAAEtW,IAAI/C,gCAAMA;gBAAG;aAAE;YACpHkF,EAAE4H,eAAe;QACrB;QACAhD,SAAQ;sBAEZ,uCAAC/B,cAAUA;QACPvB,MAAK;QACLuD,OAAO;YAAEC,YAAY;QAAM;QAC3B1C,SAASpC,CAAAA;YACL4U,yBAAyB;mBAClBD;gBACH;oBACIvX;oBACAE,UAAU;oBACVD,OAAO;wBAAC8W;qBAAW;oBACnBtW,IAAI/C,gCAAMA;gBACd;aACH;YACDkF,EAAE4H,eAAe;QACrB;QACAhD,SAAQ;;AAMhC;;;ACrDmC;AACc;AACvB;AACqB;AAaxC,SAASiQ,uBAAuB/M,KAAkC;IACrE,MAAM,EAAEgN,kBAAkB,EAAEC,yBAAyB,EAAEC,IAAI,EAAEC,iBAAiB,EAAEC,IAAI,EAAE/N,KAAK,EAAErH,IAAI,EAAE,GAAGgI;IACtG,MAAM,EAAEjI,CAAC,EAAE,GAAG2C,6BAAcA;IAC5B,qBACI,uCAAClI;QACG0G,WAAW7G,YAAG,CAAC;;;;YAIf,CAAC;qBAED,uCAACgB,UAAMA;QACH,sCAAsC;QACtC6F,WAAU;QACVoB,SAAS;YACL0S,mBAAmB;gBAAEE,MAAMA;YAAK;QACpC;QACAlV,MAAK;OAEJ,CAACiV,2CACE,kFAAGjV,SAAS,yBAAW,uCAAC+C,cAAUA;QAACvB,MAAK;QAAW6T,cAAY,CAAC,UAAU,CAAC;uBAAO,uCAACtS,cAAUA;QAACvB,MAAK;QAAa6T,cAAY,CAAC,WAAW,CAAC;SAE5I,CAAC,IAAI,CAAC,EAAC,KAAEF,mBAAkB,KAAEpV,CAAC,CAAC,KAAK,CAAC,iBAE1C,uCAACvF;QACG0G,WAAW7G,YAAG,CAAC;;gBAEf,CAAC;OAEAgN,OAAM,KAAE,CAAC,KAAK,CAAC,EAAC,KAAE,CAAC,CAAC,CAAC,EACrB+N;AAIjB;;;AClDmC;AACE;AAE9B,MAAM7a,2CAAqBA,GAAGD,yCAAMA,CAACE,GAAG,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqChD,CAAC,CAAC;AAEK,MAAMC,oCAAcA,GAAGJ,YAAG,CAAC;;AAElC,CAAC,CAAC;AAEK,MAAMK,8BAAQA,GAAGL,YAAG,CAAC;;;;AAI5B,CAAC,CAAC;AAEK,MAAMM,8BAAQA,GAAGN,YAAG,CAAC;;AAE5B,CAAC,CAAC;AAEK,MAAMO,iCAAWA,GAAGP,YAAG,CAAC;;;;;AAK/B,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7D4C;AACpB;AACM;AACsE;AACwB;AAEzE;AACC;AACoC;AAEvD;AAE5B,SAAS6B,4CAAaA,CAAC8L,KAAyB;QAoSqB3L,eAmCIA,kBAyBzBA;IA/VnD,MAAM,EAAEF,MAAM,EAAEC,eAAe,EAAE,GAAG4L;IACpC,MAAM,CAAC6M,uBAAuBC,yBAAyB,GAAGja,yBAAOA,CAAC8Z,0CAAyBA;IAC3F,MAAMrY,cAAcxB,8BAAYA,CAACU,gCAAeA;IAChD,MAAMoB,UAAU9B,8BAAYA,CAACc,4BAAWA;IACxC,IAAIgR,KAAqC,EAAE;AAAA,EAI1C;IACD,MAAM,CAACnQ,iBAAiBC,mBAAmB,GAAG7B,yBAAOA,CAACa,qCAAoBA;IAC1E,MAAMiB,YAAY7B,8BAAYA,CAACa,8BAAaA;IAE5C,MAAM,EACFkB,OAAO,EACPC,YAAY,EACZC,KAAK,EACLC,QAAQ,EACRC,QAAQ,EACRC,WAAW,EAAEb,MAAM,EAAE,EACxB,GAAGL,6BAAOA,CAAC;QACRmB,eAAe;YACXC,OAAO;gBACHC,KAAK,EAAEjB,4BAAAA,sCAAAA,gBAAiBkB,SAAS;gBACjCC,KAAK,EAAEnB,4BAAAA,sCAAAA,gBAAiBkB,SAAS;YACrC;YACAE,UAAU;gBACNH,KAAK,EAAEjB,4BAAAA,sCAAAA,gBAAiBoB,QAAQ;gBAChCD,KAAK,EAAEnB,4BAAAA,sCAAAA,gBAAiBoB,QAAQ;YACpC;YACAD,KAAK,EAAEnB,4BAAAA,sCAAAA,gBAAiBmB,KAAK;YAC7BE,UAAUC,MAAMC,OAAO,CAACvB,4BAAAA,sCAAAA,gBAAiBmB,KAAK,IAAInB,4BAAAA,sCAAAA,gBAAiBmB,KAAK,CAAC,EAAE,GAAG;YAC9EK,UAAUF,MAAMC,OAAO,CAACvB,4BAAAA,sCAAAA,gBAAiBmB,KAAK,IAAInB,4BAAAA,sCAAAA,gBAAiBmB,KAAK,CAAC,EAAE,GAAG;YAC9EF,OAAOjB,CAAAA,4BAAAA,sCAAAA,gBAAiBiB,KAAK,KAAI;YACjCQ,WAAW,CAAC,EAACzB,4BAAAA,sCAAAA,gBAAiBiB,KAAK;QACvC;IACJ;IACA,MAAMD,QAAaL,MAAM;IACzB,MAAMS,WAAgBT,MAAM;IAC5B,MAAMc,YAAiBd,MAAM;IAG7B,MAAMoD,WAAW,CAAC5C,QAAoC6C,MAAM,CAAC7C,SAASA,QAAQ,CAACA;IAE/E,0CAA0C;IAC1C,MAAMc,oBAAoBtD,gCAAa,CAAC;QACpC,MAAMuC,YAAY,OAAOF,UAAU,WAAWA,QAAQA,kBAAAA,4BAAAA,MAAOG,KAAK;QAClE,IAAI,CAACD,WAAW;YACZ,OAAO;QACX;QACA,MAAMiB,KAAKjC,YAAYkC,IAAI,CAAC,CAACJ,IAAWA,EAAE7C,KAAK,KAAK+B;QACpD,OAAOxB,mCAAYA,CAACyC,eAAAA,yBAAAA,GAAIE,IAAI;IAChC,GAAG;QAACrB;QAAOd;KAAY;IAEvB,MAAMoC,gBAAgBL,sBAAsB;IAC5C,MAAMM,iBAAiBN,sBAAsB;IAC7C,MAAMO,cAAcP,sBAAsB;IAE1C,4GAA4G;IAC5G,MAAMQ,kBAAkB9D,gCAAa,CAAC;QAClC,MAAM+D,aAAa,CAAEjD,4BAASA,IAAI,EAAE,EAAYsC,GAAG,CAACY,CAAAA,KAAO;gBAAE1B,OAAO,MAAO0B,GAAG1B,KAAK,IAAK0B;gBAAIxB,OAAO,MAAOwB,GAAGxB,KAAK,IAAKwB;YAAG;QAC1H,sGAAsG;QACtG,MAAMC,eAAe;YAAC;YAAa;YAAa;YAAgB;SAAsB;QAEtF,IAAIL,gBAAgB;YAChB,qDAAqD;YACrD,MAAMM,UAAU,IAAIC,IAAI;gBAAC;gBAAK;gBAAM;gBAAW;aAAc;YAC7D,OAAOJ,WAAWK,MAAM,CAACC,CAAAA,SAAUH,QAAQI,GAAG,CAACC,OAAOF,OAAO7B,KAAK;QACtE;QAEA,MAAMgC,iBAAiBb,iBAAiBE;QACxC,IAAIW,gBAAgB;YAChB,wFAAwF;YACxF,OAAOT,WAAWK,MAAM,CAACC,CAAAA;gBACrB,MAAMI,IAAIF,OAAOF,OAAO7B,KAAK,EAAEkC,WAAW;gBAC1C,OAAO,CAAED,CAAAA,MAAM,UAAUA,MAAM,cAAcR,aAAaU,QAAQ,CAACF,EAAC;YACxE;QACJ;QAEA,8FAA8F;QAC9F,IAAI;YACA,MAAMlC,YAAY,OAAOF,UAAU,WAAWA,QAAQA,kBAAAA,4BAAAA,MAAOG,KAAK;YAClE,IAAI,CAACD,WAAW;gBACZ,OAAOwB;YACX;YACA,IAAI,CAACJ,iBAAiB,CAACC,kBAAkB,CAACC,aAAa;gBACnD,MAAMe,cAAcjC,MAAMC,OAAO,CAACf,YAAYA,QAAQgD,IAAI,CAAC,CAACC;oBACxD,IAAI,CAACA,OAAO,CAACA,IAAIC,UAAU,EAAE;wBACzB,OAAO;oBACX;oBACA,MAAMC,IAAIF,IAAIG,IAAI,IAAI;oBACtB,OAAOV,OAAOO,IAAIC,UAAU,MAAMR,OAAOhC,cAAcyC,EAAEE,WAAW,GAAGP,QAAQ,CAAC;gBACpF;gBAEA,IAAI,CAACC,aAAa;oBACd,mEAAmE;oBACnE,OAAOb,WAAWK,MAAM,CAACC,CAAAA;wBACrB,MAAMI,IAAIF,OAAOF,OAAO7B,KAAK,EAAEkC,WAAW;wBAC1C,OAAO,CAACT,aAAaU,QAAQ,CAACF;oBAClC;gBACJ;YACJ;QACJ,EAAE,OAAOU,GAAG;QACR,wBAAwB;QAC5B;QAEA,OAAOpB;IACV,GAAG;QAACJ;QAAeC;QAAgBC;QAAaxB;QAAOR;KAAQ;IAEhE,0DAA0D;IAC1D,8EAA8E;IAC9E,MAAMyD,eAAe,CAACb;QAClB,wDAAwD;QACxD,IAAIA,MAAM,IAAK;YACX,OAAO;QACX;QACA,IAAIA,MAAMc,aAAad,MAAM,MAAM;YAC/B,OAAOA;QACX;QAEA,iCAAiC;QACjC,IAAI9B,MAAMC,OAAO,CAAC6B,IAAI;YAClB,OAAOA,EAAErB,GAAG,CAACkC;QACjB;QAEA,kBAAkB;QAClB,IAAIb,MAAM,QAAQA,MAAM,QAAQ;YAC5B,OAAO;QACX;QACA,IAAIA,MAAM,SAASA,MAAM,SAAS;YAC9B,OAAO;QACX;QAEA,mDAAmD;QACnD,IAAId,eAAe;YACf,OAAOyB,SAASb,OAAOE;QAC3B;QAEA,qFAAqF;QACrF,sEAAsE;QAEtE,OAAOA;IACX;IAEA,MAAMe,WAAW,CAACC;QACd,MAAM,EAAEpD,KAAK,EAAEI,UAAUiD,OAAO,EAAElD,KAAK,EAAEE,QAAQ,EAAEG,QAAQ,EAAEP,KAAK,EAAEQ,SAAS,EAAE,GAAG2C;QAClF,MAAME,UAAUmU,sBAAsBrW,IAAI,CAACJ,CAAAA,IAAKA,EAAEL,EAAE,MAAK3B,4BAAAA,sCAAAA,gBAAiB2B,EAAE;QAC5E,MAAMA,KAAK3B,CAAAA,4BAAAA,sCAAAA,gBAAiB2B,EAAE,KAAI/C,gCAAMA;QAExC,6DAA6D;QAC7D,MAAM2F,UAAU,OAAOF,YAAY,WAAWA,UAAUA,oBAAAA,8BAAAA,QAASlD,KAAK;QAEtE,IAAIqD,WAAkB,EAAE;QAExB,IAAID,YAAY,aAAaA,YAAY,eAAe;YACpD,8FAA8F;YAC9F,IAAI,aAAcL,aAAa7C,aAAa,MAAQG,aAAa0C,aAAa1C,aAAa,IAAK;gBAC5FgD,WAAW;oBAACP,aAAa5C;oBAAW4C,aAAazC;iBAAU;YAC/D;QACJ,OAAO,IAAIL,UAAU+C,WAAW;YAC5B,yDAAyD;YACzD,IAAI5C,MAAMC,OAAO,CAACJ,QAAQ;gBACtBqD,WAAWrD,MAAMY,GAAG,CAACqB,CAAAA,IAAKa,aAAab;YAC3C,OAAO;gBACHoB,WAAW;oBAACP,aAAa9C;iBAAO;YACpC;QACJ;QAEA,MAAMsD,UAAU;YACZ9C;YACAT,WAAWF,MAAMG,KAAK;YACtBC,UAAUmD;YACV,0EAA0E;YAC1EtD,OAAOQ,YAAYR,QAAQ;YAC3BE,OAAOqD;QACX;QAEA,IAAIF,SAAS;YACT,MAAMxC,UAAU2W,sBAAsB1W,GAAG,CAACC,CAAAA,IAAMA,EAAEL,EAAE,KAAKA,KAAK8C,UAAUzC;YACxE0W,yBAAyB5W;QAC7B,OAAO;YACH4W,yBAAyB;mBAAID;gBAAuBhU;aAAQ;QAChE;QAEA1E;IACJ;IAEA,+FAA+F;IAC/FpB,kCAAe,CAAC;QACZ,wFAAwF;QACxF,yEAAyE;QACzE,MAAMua,mBAAmB,MAAe;QACxC,IAAI,CAACA,kBAAkB;YACnB,0EAA0E;YAC1ErY,SAAS,SAAS;YAElB,oFAAoF;YACpF,wFAAwF;YACxF,IAAIb,4BAAAA,sCAAAA,gBAAiB2B,EAAE,EAAE;gBACrB+W,yBAAyB9W,CAAAA;oBACrB,IAAIC,UAAU;oBACd,MAAMC,UAAUF,KAAKG,GAAG,CAACC,CAAAA;wBACrB,IAAIA,EAAEL,EAAE,KAAK3B,gBAAgB2B,EAAE,EAAE;4BAC7B,IAAIK,EAAEf,KAAK,EAAE;gCACTY,UAAU;gCACV,OAAO,oEAAKG;oCAAGf,OAAO;;4BAC1B;4BACA,OAAOe;wBACX;wBACA,OAAOA;oBACX;oBACA,OAAOH,UAAUC,UAAUF;gBAC/B;YACJ;QACJ;IACA,uGAAuG;IACvG,uDAAuD;IAC3D,GAAG;QAACjB;QAAOE;QAAUb,4BAAAA,sCAAAA,gBAAiB2B,EAAE;QAAE+W;KAAyB;IAEnE,SAAShU;QACL,MAAMG,kBAAmB,OAAOzD,aAAa,WAAWA,WAAWA,qBAAAA,+BAAAA,SAAUD,KAAK;QAClF,IAAI0D,mBAAmBA,oBAAoB,aAAaA,oBAAoB,iBAAkBA,CAAAA,oBAAoB,aAAaA,oBAAoB,aAAY,GAAI;gBAIvF5E,kBAKAA;YARxE,qBACI,uCAAC7B;gBAAI0G,WAAWxG,8BAAQA;6BACpB,uCAACF;gBAAI0G,WAAWvG,8BAAQA;6BACpB,uCAACY,SAAKA;gBAAC8B,OAAM;gBAAY8D,SAAS,CAAC,CAAC9E,OAAOoB,QAAQ;gBAAE2D,KAAK,GAAE/E,mBAAAA,OAAOoB,QAAQ,cAAfpB,uCAAAA,iBAAiBgF,OAAO;6BAChF,uCAAC/F,SAAKA,EAAK0B,SAAS,YAAY;gBAAEsE,UAAU;YAAqB,qBAGzE,uCAAC9G;gBAAI0G,WAAWvG,8BAAQA;6BACpB,uCAACY,SAAKA;gBAAC8B,OAAM;gBAAY8D,SAAS,CAAC,CAAC9E,OAAOuB,QAAQ;gBAAEwD,KAAK,GAAE/E,mBAAAA,OAAOuB,QAAQ,cAAfvB,uCAAAA,iBAAiBgF,OAAO;6BAChF,uCAAC/F,SAAKA,EAAK0B,SAAS,YAAY;gBAAEsE,UAAU;YAAqB;QAKrF;QACA,IACIL,oBAAoB,OACpBA,oBAAoB,QACpBA,oBAAoB,UACpBA,oBAAoB,cACpBA,oBAAoB,eACpBA,oBAAoB,eACpBA,oBAAoB,kBACpBA,oBAAoB,uBACtB;gBAGgE5E;YAF9D,qBACI,gGACI,uCAACd,SAAKA;gBAAC8B,OAAM;gBAAQ8D,SAAS,CAAC,CAAC9E,OAAOkB,KAAK;gBAAE6D,KAAK,GAAG/E,gBAAAA,OAAOkB,KAAK,cAAZlB,oCAAD,cAAuBgF,OAAO;6BAE/E,uCAAC/F,SAAKA,EAAK0B,SAAS,SAAS;gBAAEuE,UAAU,CAAC/B,IAAWA,MAAMc,aAAa;YAAkB;QAI1G;QACA,IAAIW,oBAAoB,QAAQA,oBAAoB,UAAU;gBAEA5E;YAD1D,qBACI,uCAACd,SAAKA;gBAAC8B,OAAM;gBAAQ8D,SAAS,CAAC,CAAC9E,OAAOkB,KAAK;gBAAE6D,KAAK,GAAG/E,iBAAAA,OAAOkB,KAAK,cAAZlB,qCAAD,eAAuBgF,OAAO;6BAC/E,uCAACtF,4BAAUA;gBACPyF,MAAK;gBACL3E,SAASA;gBACT4E,OAAO;oBAAEH,UAAU;gBAAkB;gBACrCI,QAAQ,CAAC,EAAEtE,KAAK,EAAE,iBACd,uCAACnC,UAAMA,EAAAA,kCAAAA,CAAAA,4BAAAA,KACCmC;wBACJuE,SAAS;wBACTC,SAASnF,gBAAgB0B,GAAG,CAAC0D,CAAAA,OAAS;gCAClCxE,OAAOwE,KAAKtE,KAAK;gCACjBA,OAAOsE,KAAKtE,KAAK;4BACrB;wBACAuE,aAAY;wBACZC,UAAUC,CAAAA,WAAY5E,MAAM2E,QAAQ,CAACC,WAAWA,SAAS7D,GAAG,CAAC,CAAC8D,IAAWA,EAAE1E,KAAK,IAAI,EAAE;wBACtFA,OAAOd,gBACF0C,MAAM,CAAC0C,CAAAA,OAAQnE,MAAMC,OAAO,CAACP,MAAMG,KAAK,KAAKH,MAAMG,KAAK,CAACmC,QAAQ,CAACmC,KAAKtE,KAAK,GAC5EY,GAAG,CAAC0D,CAAAA,OAAS;gCACVxE,OAAOwE,KAAKtE,KAAK;gCACjBA,OAAOsE,KAAKtE,KAAK;4BACrB;;;QAM5B;QACA,qBAAO;IACX;IAEA,qBACI,uCAAC2E;QAAK3B,UAAUzD,aAAayD;QAAWW,WAAWzG,oCAAcA;qBAC7D,uCAACD;QAAI0G,WAAWxG,8BAAQA;qBACpB,uCAACF;QAAI0G,WAAWvG,8BAAQA;qBACpB,uCAACY,SAAKA;QAAC8B,OAAM;QAAU8D,SAAS,CAAC,CAAC9E,OAAOe,KAAK;QAAEgE,KAAK,GAAG/E,gBAAAA,OAAOe,KAAK,cAAZf,oCAAD,cAAuBgF,OAAO;qBACjF,uCAACtF,4BAAUA;QACPyF,MAAK;QACL3E,SAASA;QACT4E,OAAO;YAAEH,UAAU;QAAe;QAClCI,QAAQ,CAAC,EAAEtE,KAAK,EAAE,iBACd,uCAACnC,UAAMA,EAAAA,kCAAAA,CAAAA,4BAAAA,KACCmC;gBACJ2E,UAAU,CAACC;oBACP,oFAAoF;oBACpF,IAAIA,CAAAA,qBAAAA,+BAAAA,SAAUzE,KAAK,KAAIG,MAAMC,OAAO,CAAChB,cAAcA,UAAUwF,MAAM,GAAG,GAAG;wBACrEzF,mBACIT,yBAAMA,CACFU,UAAUwB,GAAG,CAAC,CAAC0D,OAAU;gCACrBxE,OAAO2E,SAASzE,KAAK;gCACrBA,OAAOsE,KAAKO,SAAS,CAACJ,SAASzE,KAAK,CAAC;4BACzC,KACA;oBAGZ,OAAO;wBACHb,mBAAmB,EAAE;oBACzB;oBACAU,MAAM2E,QAAQ,CAACC;gBACnB;gBACAJ,SAAStF,YAAY6B,GAAG,CAACC,CAAAA,IAAM;wBAC3Bf,OAAOe,EAAE7C,KAAK;wBACdgC,OAAOa,EAAE7C,KAAK;oBAClB;;wBAMpB,uCAACf;QAAI0G,WAAWvG,8BAAQA;qBACpB,uCAACY,SAAKA;QAAC8B,OAAM;QAAW8D,SAAS,CAAC,CAAC9E,OAAOmB,QAAQ;QAAE4D,KAAK,GAAG/E,mBAAAA,OAAOmB,QAAQ,cAAfnB,uCAAD,iBAA0BgF,OAAO;qBACxF,uCAACtF,4BAAUA;QACPyF,MAAK;QACL3E,SAASA;QACT4E,OAAO;YAAEH,UAAU;QAAkB;QACrCI,QAAQ,CAAC,EAAEtE,KAAK,EAAE,iBACd,uCAACnC,UAAMA,EAAAA,kCAAAA,CAAAA,4BAAAA,KACCmC;gBACJwE,SAAS/C;;WAQhCiC,sCAED,uCAAC3F,kBAAcA,sBACX,uCAACD,eAAWA;QAACmC,OAAM;qBACf,uCAACtB,4BAAUA;QAACyF,MAAK;QAAY3E,SAASA;QAAS6E,QAAQ,CAAC,EAAEtE,KAAK,EAAE,iBAAK,uCAAChC,gBAAYA,EAAKgC;UAI/FS,2BACG,uCAACtC,SAAKA;QAAC4F,SAAS,CAAC,CAAC9E,OAAOgB,KAAK;QAAE+D,KAAK,GAAE/E,gBAAAA,OAAOgB,KAAK,cAAZhB,oCAAAA,cAAcgF,OAAO;qBACxD,uCAAC/F,SAAKA,EAAK0B,SAAS,SAAS;QAAEsE,UAAU;IAAqB,oBAItE,uCAAC9G;QAAI0G,WAAWtG,iCAAWA;qBACvB,uCAACS,UAAMA;QACHgH,SAAQ;QACRC,SAASpC,CAAAA;YACLA,EAAEqC,cAAc;YAChBpG;QACJ;OACH,yBAGD,uCAACd,UAAMA;QAAC2E,MAAK;OAAS;AAItC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/XgD;AACgB;AACjB;AACf;AACiB;AACU;AACjB;AACP;AACyC;AAG7D,SAASuV,0BAA0BvN,KAA0B;IACxE,MAAM,CAAC6M,uBAAuBC,yBAAyB,GAAGja,yBAAOA,CAAC8Z,0CAAyBA;IAC3F,MAAM,CAACxR,MAAMC,QAAQ,GAAGX,4BAAQA,CAAU;IAC1C,MAAM,CAACY,gBAAgBC,kBAAkB,GAAGb,4BAAQA,CAAM,CAAC;IAC3D,MAAMc,oBAAoBf,0BAAMA,CAAC;IACjC,MAAM,EAAEzC,CAAC,EAAE,GAAG2C,6BAAcA;IAC5B,MAAMgB,QAAQT,iBAASA;IAEvBlC,QAAQC,GAAG,CAAC,yBAAyB6T;IAErC,qBACI,uCAACta,2CAAqBA;QAClBoJ,KAAKJ;QACLrC,WAAW7G,YAAG,CAAC;kCACO,EAAEqJ,MAAME,MAAM,GAAG,oBAAoB,OAAO;;;;;YAKlE,CAAC;qBAED,uCAACpJ;QAAI0G,WAAU;OAAuBnB,CAAC,CAAC,MAAM,CAAC,iBAC/C,uCAACvF;QAAI0G,WAAU;OACV2T,sBAAsB1W,GAAG,CAAC,CAAC/B,iBAAiByH;QACzC,qBACI,uCAACrJ;YACGsJ,KAAKD,MAAME,QAAQ;YACnB7C,WAAW7G,YAAG,CAAC;;4BAEf,CAAC;yBAED,uCAAC2I,aAASA;YACNgB,MAAMX,cAAc,CAACjH,gBAAgB2B,EAAE,CAAC;YACxCkG,QAAQ;gBACJX,kBAAkB,wGACXD;oBACH,CAACjH,gBAAgB2B,EAAE,CAAC,EAAE;;YAE9B;YACAmG,SAAS;gBACLZ,kBAAkB,wGACXD;oBACH,CAACjH,gBAAgB2B,EAAE,CAAC,EAAE;;YAE9B;YACAoG,aAAa;YACbC,uBACI,uCAAClI,4CAAaA;gBACVC,QAAQ;oBACJmH,kBAAkB,wGACXD;wBACH,CAACjH,gBAAgB2B,EAAE,CAAC,EAAE;;gBAE9B;gBACA3B,iBAAiBA;;YAGzBiI,WAAU;yBAEV,uCAAC7J,2BACG,uCAACqI,SAAKA;YACFiB,KAAKD;YACLS,oBACI,uCAAC9J;gBACG0G,WAAW7G,YAAG,CAAC;;;;gDAIf,CAAC;6BAED,uCAACkK,cAAMnI,gBAAgBiB,KAAK,iBAAG,uCAACkH,cAAMnI,gBAAgBiB,KAAK,kBAAW,uCAACkH,cAAM3B,mCAAYA,CAACxG,kCAC1F,uCAAC5B;gBACG0G,WAAW7G,YAAG,CAAC;;;oDAGf,CAAC;gBACDiI,SAAS;oBACL,MAAMkC,eAAeqQ,sBAAsB1V,MAAM,CAACe,CAAAA,IAAKA,MAAM9D,oBAAoB,EAAE;oBACnF2E,QAAQC,GAAG,CAAC,gBAAgBwD;oBAC5BsQ,yBAAyBtQ;gBACzB,mBAAmB;gBACnB,8CAA8C;gBAC9C,uEAAuE;gBACvE,eAAe;gBACf,mBAAmB;gBACnB,wBAAwB;gBACxB,SAAS;gBACT,MAAM;gBACV;6BAEA,uCAAC1B,QAAIA;gBAACtB,MAAK;;YAIvBqD,OAAM;;IAM9B,kBACA,uCAAC7B,aAASA;QACNgB,MAAMb;QACNgB,aAAa;QACbF,QAAQ;YACJb,QAAQ;QACZ;QACAgB,uBACI,uCAAClI,4CAAaA;YACVC,QAAQ;gBACJ4E,QAAQC,GAAG,CAAC;gBACZoC,QAAQ;YACZ;;QAGRiB,WAAU;qBAEV,uCAACtB,cAAUA;QAACvB,MAAK;QAAOsD,SAAQ;QAAaC,OAAO;YAAEC,YAAY;QAAG;;AAKzF;;;;;ACnIO,SAASwQ,uBAAuBtF,MAA4B;IAC/D,MAAMuF,mBAAmBvF,OAAOwF,iBAAiB;IACjD,IAAIC,YAAY,CAAC,gBAAgB,EAAEzF,OAAO0F,QAAQ,CAAC,KAAK,EAAE1F,OAAOyC,KAAK,CAAC,QAAQ,CAAC;IAEhF,IAAI8C,oBAAoBvF,OAAO2F,WAAW,KAAK,UAAU;QACrDF,aAAa,CAAC,EAAE,EAAEF,iBAAiB,KAAK,CAAC;IAC7C;IAEA,kBAAkB;IAClBE,aAAa,CAAC,IAAI,EAAEzF,OAAO4F,SAAS,CAAC,YAAY,EAAE5F,OAAO6F,SAAS,CAAC,OAAO,EAAE7F,OAAO8F,OAAO,CAAC,GAAG,CAAC;IAEhGL,YAAYzF,OAAO1L,YAAY,CAACyR,MAAM,CAAC,CAACjY,MAAMkY;QAC1C,OAAOC,aAAanY,MAAMkY;IAC9B,GAAGP;IAEH,IAAIzF,OAAO2F,WAAW,KAAK,SAAS3F,OAAOkG,YAAY,EAAE;QACrDT,YAAYA,YAAY,CAAC,KAAK,EAAEzF,OAAOkG,YAAY,EAAE;IACzD;IAEA,IAAIlG,OAAO2F,WAAW,KAAK,YAAY3F,OAAOmG,YAAY,EAAE;QACxDV,YAAYA,YAAY,CAAC,MAAM,EAAEzF,OAAOmG,YAAY,CAAC,CAAC,CAAC;IAC3D;IAEA,6BAA6B;IAC7BV,YAAYA,YAAY,CAAC,YAAY,EAAEzF,OAAO4F,SAAS,CAAC,cAAc,EAAE,CAAC5F,OAAOoG,SAAS,CAAC,QAAQ,EAAE,CAAC,EAACpG,mBAAAA,6BAAAA,OAAQqG,IAAI,IAAG,KAAKrG,OAAOoG,SAAS,CAAC,CAAC,CAAC;IAE7I,OAAOX;AACX;AAEO,SAASa,uBAAuBtG,MAA4B;IAC/D,MAAMtT,UAAUsT,OAAOtT,OAAO;IAC9B,IAAI+Y,YAAY,CAAC,OAAO,EAAEzF,OAAOhD,QAAQ,CAAC,wBAAwB,EAAEgD,OAAOlD,cAAc,CAAC,6CAA6C,EAAEkD,OAAOhD,QAAQ,CAAC,OAAO,EAAEgD,OAAO4F,SAAS,CAAC,8BAA8B,EAAE5F,OAAO0F,QAAQ,CAAC,KAAK,EAAE1F,OAAOyC,KAAK,CAAC,QAAQ,CAAC;IAChQ,IAAI/V,WAAWsT,OAAO2F,WAAW,KAAK,UAAU;QAC5CF,aAAa,CAAC,EAAE,EAAE/Y,QAAQ,KAAK,CAAC;IACpC;IACA+Y,aAAa,CAAC,IAAI,EAAEzF,OAAO4F,SAAS,CAAC,YAAY,EAAE5F,OAAO6F,SAAS,CAAC,OAAO,EAAE7F,OAAO8F,OAAO,CAAC,GAAG,CAAC;IAChG,IAAI9F,OAAO1L,YAAY,CAACrC,MAAM,GAAG,GAAG;QAChCwT,YAAYzF,OAAO1L,YAAY,CAACyR,MAAM,CAAC,CAACjY,MAAMkY;YAC1C,OAAOC,aAAanY,MAAMkY;QAC9B,GAAGP;IACP;IACA,IAAIzF,OAAO2F,WAAW,KAAK,SAAS3F,OAAOkG,YAAY,EAAE;QACrDT,YAAYA,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,EAAEzF,OAAOkG,YAAY,EAAE;IAC9D;IAEA,IAAIlG,OAAO2F,WAAW,KAAK,YAAY3F,OAAOmG,YAAY,EAAE;QACxDV,YAAYA,YAAY,CAAC,MAAM,EAAEzF,OAAOmG,YAAY,CAAC,CAAC,CAAC;IAC3D;IACAV,YAAYA,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,gEAAgE,CAAC;IAEhG,OAAOA;AACX;AAEO,SAASc,4BAA4BvG,MAA4B;IACpE,MAAMtT,UAAUsT,OAAOtT,OAAO;IAC9B,IAAI+Y,YAAY,CAAC;;iBAEJ,EAAEzF,OAAOhD,QAAQ,CAAC,OAAO,EAAEgD,OAAO4F,SAAS,CAAC;iBAC5C,EAAE5F,OAAO0F,QAAQ,CAAC,KAAK,EAAE1F,OAAOyC,KAAK,CAAC;eACxC,CAAC;IACZ,IAAI/V,WAAWsT,OAAO2F,WAAW,KAAK,UAAU;QAC5CF,aAAa,CAAC,EAAE,EAAE/Y,QAAQ,KAAK,CAAC;IACpC;IACA+Y,aAAa,CAAC,IAAI,EAAEzF,OAAO4F,SAAS,CAAC,YAAY,EAAE5F,OAAO6F,SAAS,CAAC,OAAO,EAAE7F,OAAO8F,OAAO,CAAC,EAAE,CAAC;IAE/F,IAAI9F,OAAO1L,YAAY,CAACrC,MAAM,GAAG,GAAG;QAChCwT,YAAYzF,OAAO1L,YAAY,CAACyR,MAAM,CAAC,CAACjY,MAAMkY;YAC1C,OAAOC,aAAanY,MAAMkY;QAC9B,GAAGP;IACP;IACA,IAAIzF,OAAO2F,WAAW,KAAK,SAAS3F,OAAOkG,YAAY,EAAE;QACrDT,YAAYA,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,EAAEzF,OAAOkG,YAAY,EAAE;IAC9D;IAEA,IAAIlG,OAAO2F,WAAW,KAAK,YAAY3F,OAAOmG,YAAY,EAAE;QACxDV,YAAYA,YAAY,CAAC,MAAM,EAAEzF,OAAOmG,YAAY,CAAC,CAAC,CAAC;IAC3D;IACAV,YAAYA,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,8BAA8B,CAAC;IAC9D,OAAOA;AACX;AAEO,SAASe,kBAAkBxG,MAAyB;IACvD,IAAIyF,YAAY,CAAC,gBAAgB,EAAEzF,OAAO0F,QAAQ,CAAC,KAAK,EAAE1F,OAAOyC,KAAK,CAAC,QAAQ,CAAC;IAChFgD,aAAa,CAAC,IAAI,EAAEzF,OAAO4F,SAAS,CAAC,GAAG,EAAE5F,OAAO1S,QAAQ,CAAC,EAAE,EAAE0S,OAAOgF,IAAI,CAAC,EAAE,CAAC;IAC7ES,YAAYzF,OAAO1L,YAAY,CAACyR,MAAM,CAAC,CAACjY,MAAWkY;QAC/C,OAAOC,aAAanY,MAAMkY;IAC9B,GAAGP;IACH,MAAMgB,cAAczG,OAAO1S,QAAQ,KAAK,MAAM,SAAS;IACvDmY,YAAYA,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,WAAW,EAAEzF,OAAO4F,SAAS,CAAC,GAAG,EAAEa,YAAY,OAAO,EAAE,CAACzG,OAAO0G,QAAQ,EAAE;IACzG,OAAOjB;AACX;AAEO,SAAS/S,aAAa,EAAEtF,SAAS,EAAEE,QAAQ,EAAED,KAAK,EAAkB;IACvE,MAAMsZ,cAActZ,MAAMY,GAAG,CAAC+B,CAAAA;QAC1B,IAAI,OAAOA,MAAM,UAAU;YACvB,OAAO,CAAC,CAAC,EAAEA,EAAE,CAAC,CAAC;QACnB,OAAO;YACH,OAAOA;QACX;IACJ;IAEA,MAAM4W,uBAAuBC,mBAAmBzZ;IAEhD,IACIE,aAAa,OACbA,aAAa,QACbA,aAAa,UACbA,aAAa,cACbA,aAAa,eACbA,aAAa,eACbA,aAAa,kBACbA,aAAa,uBACf;QACE,OAAO,GAAGsZ,qBAAqB,CAAC,EAAEtZ,SAAS,CAAC,EAAEqZ,WAAW,CAAC,EAAE,EAAE;IAClE;IAEA,IAAIrZ,aAAa,aAAaA,aAAa,eAAe;QACtD,OAAO,GAAGsZ,qBAAqB,CAAC,EAAEtZ,UAAU;IAChD;IAEA,IAAIA,aAAa,aAAaA,aAAa,eAAe;QACtD,OAAO,GAAGsZ,qBAAqB,CAAC,EAAEtZ,SAAS,CAAC,EAAEqZ,WAAW,CAAC,EAAE,CAAC,KAAK,EAAEA,WAAW,CAAC,EAAE,EAAE;IACxF;IAEA,IAAIrZ,aAAa,QAAQA,aAAa,UAAU;QAC5C,OAAO,GAAGsZ,qBAAqB,CAAC,EAAEtZ,SAAS,GAAG,EAAEqZ,YAAY,EAAE,CAAC;IACnE;IAEA,OAAO;AACX;AAEO,SAASV,aAAaa,GAAW,EAAE5a,eAA+B;IACrE,IAAIoK,SAASwQ;IACb,IAAI,CAACA,IAAI/W,WAAW,GAAGP,QAAQ,CAAC,UAAU;QACtC8G,UAAU;IACd,OAAO;QACHA,UAAU;IACd;IAEAA,UAAU,CAAC,EAAE,EAAE5D,aAAaxG,iBAAiB,CAAC,CAAC;IAE/C,OAAOoK;AACX;AAEO,SAASuQ,mBAAmBE,SAAiB;IAChD,MAAMC,QAAQD,UAAUE,KAAK,CAAC;IAC9B,OACID,KAAK,CAAC,EAAE,GACRA,MACKE,KAAK,CAAC,GACNjZ,GAAG,CAACkZ,CAAAA,OAAQ,CAAC,EAAE,EAAEA,KAAK,EAAE,CAAC,EACzBC,IAAI,CAAC;AAElB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3JiD;AACsE;AAEhH,SAASE,oBAAoBC,OAAY;IAC5C,MAAM,EAAEC,UAAU,EAAW,GAAGD,SAATE,kCAASF;QAAxBC;;IACR,MAAME,sBAAsBpC,sBAAsBA,CAACmC;IACnD,MAAME,WAAWN,0BAAaA,GAAGO,KAAK,CAAC;QACnCC,KAAK;QACLC,QAAQ;QACRlK,MAAM;YACFmK,SAAS;gBACL;oBACIC,OAAO;oBACPC,YAAY;wBACRnY,MAAM;wBACNoY,KAAKV,WAAWU,GAAG;oBACvB;oBACAC,QAAQT;oBACRzG,QAAQ;gBACZ;aACH;QACL;QACAmH,aAAa;IACjB;IACA,OAAOT;AACX;AAEO,SAASU,0BAA0Bd,OAAY;IAClD,MAAM,EAAEC,UAAU,EAAW,GAAGD,SAATE,kCAASF;QAAxBC;;IACR,MAAMc,sBAAsBhC,sBAAsBA,CAACmB;IACnD,MAAME,WAAWN,0BAAaA,GAAGO,KAAK,CAAC;QACnCC,KAAK;QACLC,QAAQ;QACRlK,MAAM;YACFmK,SAAS;gBACL;oBACIC,OAAO;oBACPC,YAAY;wBACRnY,MAAM;wBACNoY,KAAKV,WAAWU,GAAG;oBACvB;oBACAC,QAAQG;oBACRrH,QAAQ;gBACZ;aACH;QACL;QACAmH,aAAa;IACjB;IACA,OAAOT;AACX;AAEO,SAASY,kBAAkBhB,OAAY;IAC1C,MAAM,EAAEC,UAAU,EAAW,GAAGD,SAATE,kCAASF;QAAxBC;;IACR,MAAME,sBAAsBpC,sBAAsBA,CAACmC;IACnD,MAAME,WAAWN,0BAAaA,GAAGO,KAAK,CAAC;QACnCC,KAAK;QACLC,QAAQ;QACRlK,MAAM;YACFmK,SAAS;gBACL;oBACIC,OAAO;oBACPC,YAAY;wBACRnY,MAAM;wBACNoY,KAAKV,WAAWU,GAAG;oBACvB;oBACAC,QAAQT;oBACRzG,QAAQ;gBACZ;aACH;QACL;QACAmH,aAAa;IACjB;IACA,OAAOT;AACX;AAEO,SAASa,yBAAyBjB,OAAY;IACjD,MAAM,EAAEC,UAAU,EAAW,GAAGD,SAATE,kCAASF;QAAxBC;;IACR,MAAMiB,2BAA2BlC,2BAA2BA,CAACkB;IAC7D,MAAME,WAAWN,0BAAaA,GAAGO,KAAK,CAAC;QACnCC,KAAK;QACLC,QAAQ;QACRlK,MAAM;YACFmK,SAAS;gBACL;oBACIC,OAAO;oBACPC,YAAY;wBACRnY,MAAM;wBACNoY,KAAKV,WAAWU,GAAG;oBACvB;oBACAC,QAAQM;oBACRxH,QAAQ;gBACZ;aACH;QACL;QACAmH,aAAa;IACjB;IACA,OAAOT;AACX;AAGO,SAASe,0BAA0BnB,OAAY;IAClD,MAAM,EAAEC,UAAU,EAAW,GAAGD,SAATE,kCAASF;QAAxBC;;IACR,MAAMmB,iBAAiBnC,iBAAiBA,CAACiB;IACzC,MAAME,WAAWN,0BAAaA,GAAGO,KAAK,CAAC;QACnCC,KAAK;QACLC,QAAQ;QACRlK,MAAM;YACFmK,SAAS;gBACL;oBACIC,OAAO;oBACPC,YAAY;wBACRnY,MAAM;wBACNoY,KAAKV,WAAWU,GAAG;oBACvB;oBACAC,QAAQQ;oBACR1H,QAAQ;gBACZ;aACH;QACL;QACAmH,aAAa;IACjB;IACA,OAAOT;AACX;;;;;;;ACzH8C;AACd;AACS;AACf;AACkD;AACjC;AACR;AAE5B,SAASiB,+BAA+B,EAAExb,SAAS,EAAE+W,UAAU,EAAO;IACzEtT,QAAQC,GAAG,CAAC1D,WAAW+W;IACvB,4GAA4G;IAC5G,MAAM,CAACQ,uBAAuBC,yBAAyB,GAAGja,yBAAOA,CAAC8Z,0CAAyBA;IAC3F,MAAMrY,cAAcxB,8BAAYA,CAACU,gCAAeA;IAChD,MAAM0N,YAAY5M,YAAYkC,IAAI,CAACpB,CAAAA,QAASA,MAAM7B,KAAK,KAAK+B,WAAWmB,IAAI;IAC3E,4FAA4F;IAC5F,gGAAgG;IAChG,qBACI,gGACI,uCAACjE;QAAI0G,WAAU;QAAQ6D,OAAO;YAAEyP,SAAS;YAAQC,gBAAgB;QAAW;OACvE,CAACxO,oCAAaA,CAACiD,4BACZ,uCAAC1O;QACG0G,WAAW7G,YAAG,CAAC;;;;wBAIf,CAAC;qBAED,uCAAC0I,cAAUA;QACPvB,MAAK;QACLc,SAASpC,CAAAA;YACLa,QAAQC,GAAG,CAACd;YACZ4U,yBAAyB;mBAAID;gBAAuB;oBAAEvX;oBAAWE,UAAU;oBAAKD,OAAO;wBAAC8W;qBAAW;oBAAEtW,IAAI/C,gCAAMA;gBAAG;aAAE;YACpHkF,EAAE4H,eAAe;QACrB;QACAhD,SAAQ;sBAEZ,uCAAC/B,cAAUA;QACPvB,MAAK;QACLuD,OAAO;YAAEC,YAAY;QAAM;QAC3B1C,SAASpC,CAAAA;YACLa,QAAQC,GAAG,CAACd;YACZ4U,yBAAyB;mBAClBD;gBACH;oBACIvX;oBACAE,UAAU;oBACVD,OAAO;wBAAC8W;qBAAW;oBACnBtW,IAAI/C,gCAAMA;gBACd;aACH;YACDkF,EAAE4H,eAAe;QACrB;QACAhD,SAAQ;;AAOpC;;;AC5DA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAG4D;AACgC;AAC9C;AACV;AACD;AACiC;AACZ;AACE;AACwC;AAErB;AAkBrD;AACxB,6BAA6B;AACW;AACsB;AACzB;AACsC;AACxB;AAC8B;AAElE,SAASyV;IACpB,MAAM7W,QAAQT,iBAASA;IACvB,MAAMuX,cAAc1f,8BAAYA,CAACse,gCAAeA;IAChD,MAAM1B,aAAa5c,8BAAYA,CAAC6e,uCAAsBA;IACtD,MAAMc,mBAAmB3f,8BAAYA,CAACue,qCAAoBA;IAC1D,MAAM,CAACxP,2BAA2BC,6BAA6B,GAAGjP,yBAAOA,CAACwO,8CAA6BA;IACvG,MAAM,CAACwL,sBAAsB,GAAGha,yBAAOA,CAAM8Z,0CAAyBA;IACtE,MAAMnK,oBAAoBX,0BAA0B1H,MAAM,GAAG;IAC7D,MAAM,CAACuY,QAAQC,UAAU,GAAGlY,4BAAQA,CAAQ,EAAE;IAC9C,MAAMmY,iBAAiB9f,8BAAYA,CAACwe,mCAAkBA;IACtD,MAAMuB,eAAe/f,8BAAYA,CAACye,iCAAgBA;IAClD,MAAMuB,iBAAiBhgB,8BAAYA,CAAC0e,mCAAkBA;IACtD,MAAMuB,kBAAkBjgB,8BAAYA,CAAC2e,oCAAmBA;IACxD,MAAM,CAACuB,sBAAsBC,wBAAwB,GAAGpgB,yBAAOA,CAAC6e,yCAAwBA;IACxF,MAAM,CAACwB,aAAaC,eAAe,GAAGtgB,yBAAOA,CAACkf,gCAAeA;IAC7D,MAAM,CAACqB,YAAYC,cAAc,GAAGxgB,yBAAOA,CAAC+e,+BAAcA;IAC1D,MAAM,CAAC0B,yBAAyBC,2BAA2B,GAAG1gB,yBAAOA,CAACof,4CAA2BA;IACjG,MAAM,CAACuB,wBAAwBC,0BAA0B,GAAG5gB,yBAAOA,CAACif,2CAA0BA;IAC9F,MAAM,CAAC4B,YAAYC,cAAc,GAAG9gB,yBAAOA,CAACmf,+BAAcA;IAC1D,MAAM,CAAC4B,WAAWC,aAAa,GAAGhhB,yBAAOA,CAACgf,8BAAaA;IACvD,MAAM,CAACiC,OAAOC,YAAY,GAAGtZ,4BAAQA,CAAC;QAClC;YACIpF,OAAO;YACPE,OAAO;YACPye,QAAQ;QACZ;QACA;YACI3e,OAAO;YACPE,OAAO;YACPye,QAAQ;QACZ;KACH;IAED,SAASpR,aAAaxN,KAAU;QAC5B,MAAMyG,QAAQgG,0BAA0BgB,SAAS,CAAC,CAAChJ,OAAcA,KAAKtG,KAAK,KAAK6B,MAAM7B,KAAK;QAC3FsO,0BAA0BiB,MAAM,CAACjH,OAAO;QACxCiG,6BAA6B;eAAID;SAA0B;IAC/D;IAEA,MAAMoS,qBAAqB,CAACzV;QACxB,MAAM,CAAC0V,GAAG,GAAGC,UAAU,GAAG3V;QAC1B,OAAO2V;IACX;IAEA,MAAM,EAAEC,SAASC,8BAA8B,EAAEC,KAAKC,uBAAuB,EAAE,GAAGxD,6BAAUA,CACxF,CAAC,EAAEnC,WAAW4E,sBAAsB,EAAEtG,OAAO0G,SAAS,EAAO;QACzD7a,QAAQC,GAAG,CAACkU;QACZ,MAAMhF,SAA4BsM,eAAe;YAC7C5F,UAAUA,WAAW;YACrBpZ,UAAU;YACV0X;QACJ;QACAnU,QAAQC,GAAG,CAACkP,OAAOgF,IAAI;QAEvB,OAAOiF,gCAAaA,CAChBvB,yBAAyBA,CAAC;YACtBlB;WACGxH;IAGf,GACA;QACIuM,QAAQ;QACRC,WAAW,CAAO3V,KAAUmJ;gBACxB,IAAInJ,IAAI4V,EAAE,EAAE;oBACR,MAAMC,WAAWxC,yCAAkBA,CAACrT,IAAI+G,IAAI,CAAC+O,OAAO,CAAC7H,kBAAkB,CAAC8H,MAAM,CAAC,EAAE;oBACjF,MAAMtW,SAASyV,mBAAmBc,0BAA0BH,UAAUnC;oBACtE,IAAI3M,OAAO;2BAAIkN;qBAAqB;oBACpClN,KAAKK,IAAI,IAAI3H;oBACb6U,cAAcD,aAAa5U,OAAOrE,MAAM;oBACxC0Z,aAAarV,MAAM,CAACA,OAAOrE,MAAM,GAAG,EAAE,CAACC,SAAS,CAACqY,iBAAiB;oBAClEQ,wBAAwBnN;gBACxB,qBAAqB;gBACrB,6BAA6B;gBAC7B,UAAU;gBACd;YACJ;IACJ;IAGJ,SAAS0O,eAAe,EAAE5F,WAAW,CAAC,EAAEpZ,WAAW,GAAG,EAAE0X,OAAOsF,YAAYtF,IAAI,EAAO;QAClF,MAAMhF,SAA4B;YAC9B8M,SAASlC;YACTlF,UAAUmF;YACVpI,OAAOkI;YACP/E,WAAW2E;YACXvF;YACA1Q,cAAc,EAAE;YAChBoS;YACApZ;YACAyf,SAASrC;YACTlX,OAAOA,MAAME,MAAM,GAAG,SAAS;QACnC;QACA,IAAIiR,sBAAsB1S,MAAM,GAAG,GAAG;YAClC+N,OAAO1L,YAAY,GAAGqQ;QAC1B;QACA,OAAO3E;IACX;IAEA,MAAM,EAAEkM,SAASc,+BAA+B,EAAEZ,KAAKa,wBAAwB,EAAE,GAAGpE,6BAAUA,CAC1F,CAAC,EAAEnC,WAAW0E,uBAAuB,EAAEpG,OAAOsF,YAAYtF,IAAI,EAAO;QACjE,MAAMhF,SAA4BsM,eAAe;YAC7C5F;YACApZ,UAAU;YACV0X;QACJ;QAEA,OAAOiF,gCAAaA,CAChBvB,yBAAyBA,CAAC;YACtBlB;WACGxH;IAGf,GACA;QACIuM,QAAQ;QACRC,WAAW,CAAO3V,KAAUmJ;gBACxB,IAAInJ,IAAI4V,EAAE,EAAE;oBACR,MAAMC,WAAWxC,yCAAkBA,CAACrT,IAAI+G,IAAI,CAAC+O,OAAO,CAAC7H,kBAAkB,CAAC8H,MAAM,CAAC,EAAE;oBACjF,MAAMtW,SAASuW,0BAA0BH,UAAUnC;oBACnD,IAAI3M,OAAO;2BAAIkN;qBAAqB;oBACpClN,KAAKsP,OAAO,IAAI5W;oBAChB2U,eAAeD,cAAc1U,OAAOrE,MAAM;oBAC1CwZ,cAAcnV,MAAM,CAAC,EAAE,CAACpE,SAAS,CAACqY,iBAAiB;oBACnDQ,wBAAwBnN;gBACxB,qBAAqB;gBACrB,6BAA6B;gBAC7B,UAAU;gBACd;YACJ;IACJ;IAGJ,SAASuP;QACL,MAAMC,kBAAkBC,SAASC,cAAc,CAAC;QAChD,IAAIF,iBAAiB;YACjBA,gBAAgBG,cAAc,CAAC;gBAAEC,OAAO;gBAAUC,UAAU;YAAS;QACzE;IACJ;IAEA,MAAM,EAAEvB,SAASwB,WAAW,EAAE,GAAG7E,6BAAUA,CACvC;QACI,MAAM8E,iBAAoCrB,eAAe;YACrDhf,UAAU;QACd;QACA,MAAMsgB,kBAAqCtB,eAAe;YACtDhf,UAAU;YACVoZ,UAAU;QACd;QACA,OAAOmH,QAAQC,GAAG,CAAC;YACf7D,gCAAaA,CACTvB,yBAAyBA,CAAC;gBACtBlB;eACGmG;YAGX1D,gCAAaA,CACTvB,yBAAyBA,CAAC;gBACtBlB;eACGoG;SAGd;IACL,GACA;QACIG,aAAa;YAACpJ;SAAsB;QACpC6H,WAAW,CAAO3V;gBACd,IAAIA,GAAG,CAAC,EAAE,CAAC4V,EAAE,IAAI5V,GAAG,CAAC,EAAE,CAAC4V,EAAE,EAAE;oBACxB,MAAMuB,YAAY9D,yCAAkBA,CAACrT,GAAG,CAAC,EAAE,CAAC+G,IAAI,CAAC+O,OAAO,CAAC7H,kBAAkB,CAAC8H,MAAM,CAAC,EAAE;oBACrF,MAAMqB,YAAY/D,yCAAkBA,CAACrT,GAAG,CAAC,EAAE,CAAC+G,IAAI,CAAC+O,OAAO,CAAC7H,kBAAkB,CAAC8H,MAAM,CAAC,EAAE;oBACrF,MAAMsB,UAAUrB,0BAA0BmB,WAAWzD;oBACrD,MAAM4D,UAAUpC,mBAAmBc,0BAA0BoB,WAAW1D;oBACxE,MAAM6D,iBAAiBvB,0BAA0B;wBAACvC,YAAYpY,SAAS;qBAAC,EAAEqY;oBAC1E,MAAM3M,OAAO;2BAAIsQ;2BAAYE;2BAAmBD;qBAAQ;oBACxD,MAAME,kBAAkB,MAAMjE,sCAAoBA,CAACxM;oBAEnD,IAAIsQ,QAAQjc,MAAM,GAAG,GAAG;wBACpBgZ,eAAeiD,QAAQjc,MAAM;wBAC7BwZ,cAAcyC,OAAO,CAAC,EAAE,CAAChc,SAAS,CAACqY,iBAAiB;oBACxD,OAAO;wBACHkB,cAAcnB,YAAYtF,IAAI;oBAClC;oBACA,IAAImJ,QAAQlc,MAAM,GAAG,GAAG;wBACpBkZ,cAAcgD,QAAQlc,MAAM;wBAC5B0Z,aAAawC,OAAO,CAACA,QAAQlc,MAAM,GAAG,EAAE,CAACC,SAAS,CAACqY,iBAAiB;oBACxE,OAAO;wBACHoB,aAAarB,YAAYtF,IAAI;oBACjC;oBACA+F,wBAAwBsD;oBACxBC,WAAW;wBACPnB;oBACJ,GAAG;gBACP,OAAO;gBACH,+BAA+B;gBACnC;YACJ;QACAoB,SAASC,CAAAA;YACL3d,QAAQC,GAAG,CAAC0d;QAChB;IACJ;IAGJ5gB,6BAASA,CAAC;QACN,MAAMgQ,OAAOkN,qBAAqB7c,GAAG,CAAC0D,CAAAA;gBAGxBA;YAFV,OAAO;gBACHO,WAAWP,KAAKO,SAAS;gBACzB8S,MAAMrT,EAAAA,kBAAAA,KAAKO,SAAS,cAAdP,sCAAAA,eAAgB,CAAC4Y,iBAAiB,KAAI;gBAC5CkE,SAAS9c,KAAK8c,OAAO;gBACrBC,MAAM/c,KAAK+c,IAAI;gBACf5c,UAAUH,KAAK+c,IAAI,KAAKpE,YAAYoE,IAAI;YAC5C;QACJ;QACAjE,UAAU7M;IACd,GAAG;QAACkN;QAAsBP;QAAkBD,YAAYoE,IAAI;KAAC;IAE7D,MAAMC,yBAAyB;QAC3B,IAAIjB,eAAeV,iCAAiC;YAChD,qBACI,uCAAC1iB;gBACG0G,WAAW7G,YAAG,CAAC;;;;;oBAKf,CAAC;6BAED,uCAAC2e,cAAUA;gBAACvR,OAAO;;QAG/B;QACA,OAAO;IACX;IAEA,MAAMqX,wBAAwB;QAC1B,IAAIlB,eAAevB,gCAAgC;YAC/C,qBACI,uCAAC7hB;gBACG0G,WAAW7G,YAAG,CAAC;;;;;oBAKf,CAAC;6BAED,uCAAC2e,cAAUA;gBAACvR,OAAO;;QAG/B;QACA,OAAO;IACX;IAEA,MAAMgL,qBAAqB,CAAC,EAAEmB,GAAG,EAAqB;QAClD,iGAAiG;QACjG,MAAMmL,gBAAgB,CAACxY;YACnB,IAAI,OAAOA,QAAQ,YAAYA,QAAQ,MAAM;gBACzC,OAAOA;YACX;YAEA,MAAMC,SAAc,CAAC;YACrB,IAAK,MAAM1C,OAAOyC,IAAK;gBACnB,IAAIA,IAAIyY,cAAc,CAAClb,MAAM;oBACzB,IAAIvG,QAAQgJ,GAAG,CAACzC,IAAI;oBAEpB,IAAI,OAAOvG,UAAU,UAAU;wBAC3B,IAAI0hB,aAAa1hB,MAAM2hB,IAAI;wBAE3B,kCAAkC;wBAClC,IAAID,WAAWvf,QAAQ,CAAC,QAAQ;4BAC5B,IAAI;gCACAuf,aAAata,KAAKwa,KAAK,CAAC,CAAC,CAAC,EAAEF,WAAW,CAAC,CAAC;4BAC7C,EAAE,OAAO/e,GAAG;4BACR,4CAA4C;4BAChD;wBACJ;wBAEA,iBAAiB;wBACjB,IAAI,WAAYkf,UAAU,CAAC,QAAQH,WAAWI,QAAQ,CAAC,QAAUJ,WAAWG,UAAU,CAAC,QAAQH,WAAWI,QAAQ,CAAC,MAAO;4BACtH,IAAI;gCACA,MAAMC,SAAS3a,KAAKwa,KAAK,CAACF;gCAC1B1hB,QAAQwhB,cAAcO;4BAC1B,EAAE,OAAOpf,GAAG;gCACR3C,QAAQgJ,GAAG,CAACzC,IAAI;4BACpB;wBACJ,OAAO;4BACHvG,QAAQgJ,GAAG,CAACzC,IAAI;wBACpB;oBACJ,OAAO,IAAIpG,MAAMC,OAAO,CAACJ,QAAQ;wBAC7BA,QAAQA,MAAMY,GAAG,CAAC0D,CAAAA;4BACd,IAAI,OAAOA,SAAS,UAAU;gCAC1B,IAAI0d,YAAY1d,KAAKqd,IAAI;gCAEzB,IAAIK,UAAU7f,QAAQ,CAAC,QAAQ;oCAC3B,IAAI;wCACA6f,YAAY5a,KAAKwa,KAAK,CAAC,CAAC,CAAC,EAAEI,UAAU,CAAC,CAAC;oCAC3C,EAAE,OAAOrf,GAAG,CAAE;gCAClB;gCAEA,IAAI,UAAWkf,UAAU,CAAC,QAAQG,UAAUF,QAAQ,CAAC,QAAUE,UAAUH,UAAU,CAAC,QAAQG,UAAUF,QAAQ,CAAC,MAAO;oCAClH,IAAI;wCACA,MAAMC,SAAS3a,KAAKwa,KAAK,CAACI;wCAC1B,OAAOR,cAAcO;oCACzB,EAAE,UAAM;wCACJ,OAAOzd;oCACX;gCACJ;gCACA,OAAOA;4BACX;4BACA,OAAO,OAAOA,SAAS,YAAYA,SAAS,OAAOkd,cAAcld,QAAQA;wBAC7E;oBACJ,OAAO,IAAI,OAAOtE,UAAU,YAAYA,UAAU,MAAM;wBACpDA,QAAQwhB,cAAcxhB;oBAC1B;oBAEAiJ,MAAM,CAAC1C,IAAI,GAAGvG;gBAClB;YACJ;YACA,OAAOiJ;QACX;QAEA,MAAMgZ,gBAAgBT,cAAcnL,IAAIC,QAAQ,CAACzR,SAAS;QAE1D,MAAMqd,eAAezY,OAAO0Y,IAAI,CAACF,eAAerhB,GAAG,CAAC2F,CAAAA;YAChD,OAAO;gBACH1G,OAAO0G;gBACPvG,OAAOqW,IAAIC,QAAQ,CAACzR,SAAS,CAAC0B,IAAI;YACtC;QACJ;QAEA,qBACI,uCAACtJ;YACG0G,WAAW7G,YAAG,CAAC;;gBAEf,CAAC;yBAED,uCAAC8e,WAAOA;YACJjY,WAAW7G,YAAG,CAAC;wBACX,EAAEqJ,MAAME,MAAM,GAAG,4CAA4C,0CAA0C;oBAC3G,CAAC;WAEAkY,MAAM3d,GAAG,CAAC,CAACwhB,KAAK9b;YACb,qBACI,uCAACoV,OAAGA;gBACAnV,KAAKD;gBACLxG,OAAOsiB,IAAItiB,KAAK;gBAChB2e,QAAQ2D,IAAI3D,MAAM;gBAClB4D,aAAa,IACT7D,YACID,MAAM3d,GAAG,CAAC,CAACwhB,KAAK9f,MAAS,wEAClB8f;4BACH3D,QAAQnc,QAAQgE;;gBAI5Bgc,SAASJ,aAAatd,MAAM;;QAGxC,mBAEJ,uCAAC+W,cAAUA,QACN4C,KAAK,CAAC,EAAE,CAACE,MAAM,kBACZ,uCAACrJ;YAAMzR,WAAU;yBACb,uCAACuS,eACIgM,aAAathB,GAAG,CAAC,CAAC0D;YACf,IAAIwS,aAAaxS,KAAKtE,KAAK;YAC3B,MAAMD,YAAYuE,KAAKzE,KAAK;YAC5B,IAAI,OAAOiX,eAAe,UAAU;gBAChCA,aAAa1P,KAAKC,SAAS,CAACyP;YAChC;YACA,MAAMyL,gBAAgBzlB,YAAG,CAAC;;;;;;oCAM1B,CAAC;YACD,qBACI,uCAAC0Y;gBAAG7R,WAAW,GAAG4e,eAAe;gBAAEhc,KAAKxG;6BACpC,uCAAC2W;gBACG/S,WAAW7G,YAAG,CAAC;;;gDAGf,CAAC;6BAED,uCAACG;gBACG0G,WAAW,CAAC,qBAAqB,EAAE7G,YAAG,CAAC;;oDAEvC,CAAC,EAAE;6BAEH,uCAACye,8BAA8BA;gBAACxb,WAAWA;gBAAW+W,YAAYA;gCAG1E,uCAACJ;gBAAG/S,WAAU;eAAe5D,aAAa,oBAC1C,uCAAC2W;gBAAG/S,WAAU;6BACV,uCAAC1G;gBAAI0G,WAAU;eAAoBmT,cAAc;QAIjE,MAIXyH,KAAK,CAAC,EAAE,CAACE,MAAM,kBACZ,uCAACxhB,2BACG,uCAACulB;YACG7e,WAAW7G,YAAG,CAAC;;;;;;;;;oCASX,EAAEqJ,MAAME,MAAM,GAAG,+CAA+C,0CAA0C;;;;gCAI9G,CAAC;WAEAe,KAAKC,SAAS,CAAC4a,eAAe,MAAM;IAQhE;IAEA,SAASzC,0BAA0BvW,MAAW,EAAEsP,SAAiB;QAC9D,MAAMkK,eAAe9F,yBAAMA,CAAC1T,QAAQsP;QACpC,MAAMmK,gBAAgBD,aAAa7hB,GAAG,CAAC,CAAC0D;YACpC,IAAIqe,aAAa;YACjB,IAAK,MAAMpc,OAAOjC,KAAM;gBACpB,IAAIse,iBAAiBte,IAAI,CAACiC,IAAI;gBAC9B,gBAAgB;gBAChB,IAAI,OAAOqc,mBAAmB,UAAU;oBACpCA,iBAAiBxb,KAAKC,SAAS,CAACub;gBACpC;gBACAD,cAAc,CAAC,+BAA+B,EAAExc,MAAME,MAAM,GAAG,YAAY,UACtE,iEAAiE,EAAEE,IAAI,QAAQ,EAAEqc,eAAe,CAAC,CAAC;YAC3G;YACA,OAAO;gBACH/d,WAAWP;gBACX8c,SAASuB;YACb;QACJ;QAEA,OAAOD;IACX;IAEA,MAAMzN,UAAUlU,2BAAOA,CAAwB;QAC3C,IAAI8hB,iBAAwC;YACxC;gBACIC,aAAa;gBACbpN,QAAQ,EAAE;gBACVe,MAAM,CAAC,EAAEJ,GAAG,EAAEzT,QAAQ,EAAE;oBACpB,OACIyT,IAAI0M,YAAY,oBACZ,uCAAC9lB,aACIoZ,IAAIE,aAAa,mBACd,uCAAC/Q,cAAUA;wBAACT,SAASsR,IAAI2M,wBAAwB;wBAAI/e,MAAK;wBAAasD,SAAQ;uCAE/E,uCAAC/B,cAAUA;wBAACT,SAASsR,IAAI2M,wBAAwB;wBAAI/e,MAAK;wBAAcsD,SAAQ;sCAEpF,uCAACtK;wBAAI0G,WAAU;uBAAQf;gBAIvC;YACJ;YACA;gBACI8S,QAAQ;gBACRoN,aAAa;gBACbrM,MAAM,CAAC,EAAEJ,GAAG,EAAEzT,QAAQ,EAAE;oBACpB,MAAMkU,aAAalU;oBACnB,MAAM7C,YAAYmd;oBAClB,MAAMvR,YAAY;oBAClB,MAAM4M,YAAYuE,gDAAyBA,CAAChG;oBAC5C,qBACI,uCAAC7Z;wBACG0G,WAAW,GAAG7G,YAAG,CAAC;;4BAElB,CAAC,CAAC,CAAC,EAAE6Z,UAAUA,EAAE;qCAEjB,uCAAC1Z;wBACG0G,WAAW7G,YAAG,CAAC;;;gCAGf,CAAC;uBAEAyb,yBACD,uCAACtb;wBACG0G,WAAW,CAAC,eAAe,EAAE7G,YAAG,CAAC;;oCAEjC,CAAC,EAAE;qCAEH,uCAACua,sBAAsBA;wBAACtX,WAAWA;wBAAW+W,YAAYA;wBAAYnL,WAAWA;;gBAKrG;YACJ;SACH;QACD,IAAI,CAACsB,mBAAmB;YACpB4V,eAAejS,IAAI,CAAC;gBAChBkS,aAAa;gBACbpN,QAAQ;gBACRe,MAAM,CAAC,EAAEJ,GAAG,EAAEzT,QAAQ,EAAE;oBACpB,SAASqgB;wBACL,OAAO;4BAAEC,QAAQtgB;wBAAmB;oBACxC;oBACA,qBACI,uCAAC3F;wBACG0G,WAAW7G,YAAG,CAAC;;;;;4BAKf,CAAC;qCAED,uCAAC8Z,kBAAkBA;wBACfjT,WAAW7G,YAAG,CAAC;;0DAEW,EAAEqJ,MAAME,MAAM,GAAG,YAAY,qBAAqB;;gCAE5E,CAAC;qCAED,uCAACpJ;wBACGkmB,yBAAyBF;wBACzBtf,WAAW7G,YAAG,CAAC;;;;;oCAKf,CAAC;;gBAKrB;YACJ;QACJ,OAAO;YACH+lB,iBAAiB;mBACVA;mBACAvW,0BAA0B1L,GAAG,CAAC,CAACf;oBAC9B,OAAO;wBACHijB,aAAajjB,MAAM7B,KAAK;wBACxB0X,QAAQ,kBACJ,uCAACzY;gCACG0G,WAAW7G,YAAG,CAAC;;;gCAGf,CAAC;6CAED,uCAACG,aAAK4C,MAAM7B,KAAK,iBACjB,uCAACwH,cAAUA;gCACPvB,MAAK;gCACLsD,SAAQ;gCACRC,OAAO;oCACHC,YAAY;oCACZ2b,QAAQ;oCACRC,WAAW;gCACf;gCACAte,SAASpC,CAAAA;oCACL0K,aAAaxN;oCACb8C,EAAEqC,cAAc;oCAChBrC,EAAE4H,eAAe;gCACrB;;wBAIZkM,MAAM,CAAC,EAAEJ,GAAG,EAAEzT,QAAQ,EAAO;4BACzB,wDAAwD;4BACxD,IAAIkU,aAAavO,sBAAGA,CAAC8N,IAAIC,QAAQ,CAACzR,SAAS,EAAEhF,MAAM7B,KAAK;4BACxD,MAAM+B,YAAYF,MAAM7B,KAAK;4BAC7B,MAAM2N,YAAY9L,MAAMqB,IAAI;4BAC5B,IAAI,OAAO4V,eAAe,UAAU;gCAChCA,aAAa1P,KAAKC,SAAS,CAACyP;4BAChC;4BACA,qBACI,uCAAC7Z;gCACG0G,WAAW,GAAGgT,UAAUA,CAAC,CAAC,EAAE7Z,YAAG,CAAC;;;;oCAIhC,CAAC,EAAE;6CAEH,uCAACG;gCAAI0G,WAAW,CAAC,sBAAsB,CAAC;6CACpC,uCAAC1G;gCAAI0G,WAAU;+BACV9D,MAAMG,KAAK,KAAK,cAAc8W,2BAAa,uCAAChZ,UAAMA,QAAEgZ,4BAAuB,uCAAC9P;gCAAKrD,WAAU;+BAAWmT,eAI3GA,2BAAa,uCAAC7Z;gCACV0G,WAAW,CAAC,eAAe,EAAE7G,YAAG,CAAC;;wCAErC,CAAC,EAAE;6CAEC,uCAACua,sBAAsBA;gCAACtX,WAAWA;gCAAW+W,YAAYA;gCAAYnL,WAAWA;kCAC5E;wBAKzB;oBACJ;gBACJ;aACH;QACL;QACA,OAAOkX;IACP,uDAAuD;IAC3D,GAAG;QAAC3F;QAAkB7P;QAAcJ;QAAmBX;KAA0B;IAEjF,qBACI,uCAACrP,2BACG,uCAAC+a,yBAAyBA;QAAChZ,YAAYsY;sBACvC,uCAACra;QAAI0G,WAAU;sBACf,uCAAC1G;QAAIuK,OAAO;YAAE8b,UAAU;QAAW;qBAC/B,uCAAC9L,sBAAsBA;QACnBC,oBAAoBmI;QACpBlI,2BAA2BiI;QAC3BhI,MAAMwG;QACN1b,MAAK;QACLmV,mBAAmBmG;QACnBwF,sBAAsBvF;QACtBnG,MAAK;QACL/N,OAAO6T;QAEV2D,yCAEL,uCAACrkB;QAAIuK,OAAO;YAAE2C,QAAQ;YAAuBqZ,UAAU;YAAQF,UAAU;QAAW;qBAChF,uCAACrmB;QAAI0G,WAAU;qBACX,uCAACqR,kBAAkBA;QAACzE,MAAM4M;QAAQlI,SAASA;QAASE,iBAAiB,IAAM;QAAMD,oBAAoBA;wBAW7G,uCAACjY;QAAIuK,OAAO;YAAE8b,UAAU;QAAW;OAC9B/B,uCACD,uCAAC/J,sBAAsBA;QACnBC,oBAAoBuH;QACpBtH,2BAA2BoH;QAC3BnH,MAAM0G;QACN5b,MAAK;QACLmV,mBAAmBqG;QACnBsF,sBAAsBrF;QACtBrG,MAAM,CAAC,WAAW,CAAC;QACnB/N,OAAO+T;;AAK3B;;;;;;;AC5rBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE4D;AACF;AACwC;AAgB1E;AACQ;AACoB;AACyB;AACH;AACvC;AAC2B;AACjB;AACa;AACR;AACD;AAE4B;AAG9D,SAASmG,gBAAgB,EAAEC,aAAa,EAAEC,YAAY,EAA0H;IAC3L,MAAM/d,QAAQT,iBAASA;IACvB,MAAM,CAACyX,QAAQC,UAAU,GAAGlY,4BAAQA,CAAQ,EAAE;IAC9C,MAAMoE,kBAAkB/L,8BAAYA,CAACkL,oCAAmBA;IACxD,MAAM,CAACrJ,WAAW+kB,cAAc,GAAG7mB,yBAAOA,CAACc,8BAAaA;IACxD,MAAM,CAACgO,gBAAgBC,kBAAkB,GAAG/O,yBAAOA,CAACuO,mCAAkBA;IACtE,MAAMoB,oBAAoBb,eAAexH,MAAM,GAAG;IAClD,MAAMsY,mBAAmB3f,8BAAYA,CAACue,qCAAoBA;IAC1D,iEAAiE;IACjE,MAAM,CAACmB,aAAamH,eAAe,GAAG9mB,yBAAOA,CAACue,gCAAeA;IAC7D,MAAM6B,0BAA0B5P,4BAAUA,CAACqO,yCAAwBA;IACnE,MAAM5E,2BAA2BzJ,4BAAUA,CAACsJ,0CAAyBA;IACrE,MAAMwG,iBAAiB9P,4BAAUA,CAAC0O,gCAAeA;IACjD,MAAMsB,gBAAgBhQ,4BAAUA,CAACuO,+BAAcA;IAC/C,MAAM,CAAChD,UAAUgL,aAAa,GAAG/mB,yBAAOA,CAACoR,6BAAYA;IACrD,MAAM,CAACsK,MAAM/I,QAAQ,GAAG3S,yBAAOA,CAACqR,yBAAQA;IACxC,MAAM,CAAC2V,YAAYC,cAAc,GAAGrf,4BAAQA,CAAC;IAC7C,MAAM,CAACsf,qBAAqBC,uBAAuB,GAAGvf,4BAAQA,CAAC;IAC/D,MAAM,CAACwf,aAAaC,cAAc,GAAGzf,4BAAQA,CAAS;IACtD,MAAM+J,kBAAkB1R,8BAAYA,CAAC+Q,oCAAmBA;IACxD,MAAMsW,oBAAoBrnB,8BAAYA,CAAC6e,uCAAsBA;IAC7D,MAAMrd,cAAcxB,8BAAYA,CAACU,gCAAeA;IAChD,MAAM4mB,UAAUf,0BAAgBA;IAChC,gBAAgB;IAChB,MAAMgB,WAAWD,QAAQE,IAAI,CAACD,QAAQ,IAAI,CAAC;IAC3CthB,QAAQC,GAAG,CAAC,YAAYqhB;IAExB,MAAM,EAAEE,aAAa,CAAC,CAAC,EAAE,GAAGF;IAC5B,MAAM,EAAEzM,WAAW,EAAE,EAAEuC,aAAa,CAAC,CAAC,EAAEqK,YAAY,EAAE,EAAEC,mBAAmB,EAAE,EAAE,GAAGF;IAClF,0CAA0C;IAC1C,MAAM,CAACG,UAAUC,YAAY,GAAGlgB,4BAAQA,CAASnD,OAAOiX;IAExDzY,6BAASA,CAAC;QACN6kB,YAAYrjB,OAAOiX;IACvB,GAAG;QAACA;KAAK;IAET,MAAMqM,mBAAmBpW,gBAAgBmG,KAAK,KAAK6P,aAAahW,gBAAgBoJ,QAAQ,KAAKA,YAAYuM,CAAAA,8BAAAA,wCAAAA,kBAAmBpkB,EAAE,OAAKoa,uBAAAA,iCAAAA,WAAYpa,EAAE;IAEjJD,6BAASA,CAAC;QACN,IAAI4F,MAAME,MAAM,EAAE;YACdse,cAAc;QAClB,OAAO;YACHA,cAAc;QAClB;IACJ,GAAG;QAACxe,MAAME,MAAM;KAAC;IAEjB,MAAM,CAACkY,OAAOC,YAAY,GAAGtZ,4BAAQA,CAAC;QAClC;YACIpF,OAAO;YACPE,OAAO;YACPye,QAAQ;QACZ;QACA;YACI3e,OAAO;YACPE,OAAO;YACPye,QAAQ;QACZ;KACH;IAEDle,6BAASA,CAAC;QACN,MAAMgQ,OAAOnR,UAAUwB,GAAG,CAAC0D,CAAAA;gBAGbA;YAFV,OAAO;gBACHO,WAAWP,KAAKO,SAAS;gBACzB8S,MAAMrT,EAAAA,kBAAAA,KAAKO,SAAS,cAAdP,sCAAAA,eAAgB,CAAC4Y,iBAAiB,KAAI;gBAC5CkE,SAAS9c,KAAK8c,OAAO;gBACrBC,IAAI,EAAE/c,iBAAAA,2BAAAA,KAAM+c,IAAI;YACpB;QACJ;QACAjE,UAAU7M;IACd,GAAG;QAACnR;QAAW8d;KAAiB;IAEhC,uDAAuD;IACvD,MAAM7P,eAAe7P,oCAAiB,CAClC,CAACqC;QACG,MAAMyG,QAAQ8F,eAAekB,SAAS,CAAC,CAAChJ,OAAcA,KAAKtG,KAAK,KAAK6B,MAAM7B,KAAK;QAChFoO,eAAemB,MAAM,CAACjH,OAAO;QAC7B+F,kBAAkB;eAAID;SAAe;IACzC,GACA;QAACA;QAAgBC;KAAkB;IAGvC,MAAM6I,qBAAqB,CAAC,EAAEmB,GAAG,EAAqB;QAClD,iBAAiB;QACjB,MAAMmL,gBAAgB,CAACxY;YACnB,IAAI,OAAOA,QAAQ,YAAYA,QAAQ,MAAM;gBACzC,OAAOA;YACX;YAEA,MAAMC,SAAc,CAAC;YACrB,IAAK,MAAM1C,OAAOyC,IAAK;gBACnB,IAAIA,IAAIyY,cAAc,CAAClb,MAAM;oBACzB,IAAIvG,QAAQgJ,GAAG,CAACzC,IAAI;oBAEpB,IAAI,OAAOvG,UAAU,UAAU;wBAC3B,IAAI0hB,aAAa1hB,MAAM2hB,IAAI;wBAE3B,kCAAkC;wBAClC,IAAID,WAAWvf,QAAQ,CAAC,QAAQ;4BAC5B,IAAI;gCACAuf,aAAata,KAAKwa,KAAK,CAAC,CAAC,CAAC,EAAEF,WAAW,CAAC,CAAC;4BAC7C,EAAE,OAAO/e,GAAG;4BACR,4CAA4C;4BAChD;wBACJ;wBAEA,iBAAiB;wBACjB,IAAI,WAAYkf,UAAU,CAAC,QAAQH,WAAWI,QAAQ,CAAC,QAAUJ,WAAWG,UAAU,CAAC,QAAQH,WAAWI,QAAQ,CAAC,MAAO;4BACtH,IAAI;gCACA,MAAMC,SAAS3a,KAAKwa,KAAK,CAACF;gCAC1B1hB,QAAQwhB,cAAcO;4BAC1B,EAAE,OAAOpf,GAAG;gCACR3C,QAAQgJ,GAAG,CAACzC,IAAI;4BACpB;wBACJ,OAAO;4BACHvG,QAAQgJ,GAAG,CAACzC,IAAI;wBACpB;oBACJ,OAAO,IAAIpG,MAAMC,OAAO,CAACJ,QAAQ;wBAC7BA,QAAQA,MAAMY,GAAG,CAAC0D,CAAAA;4BACd,IAAI,OAAOA,SAAS,UAAU;gCAC1B,IAAI0d,YAAY1d,KAAKqd,IAAI;gCAEzB,IAAIK,UAAU7f,QAAQ,CAAC,QAAQ;oCAC3B,IAAI;wCACA6f,YAAY5a,KAAKwa,KAAK,CAAC,CAAC,CAAC,EAAEI,UAAU,CAAC,CAAC;oCAC3C,EAAE,OAAOrf,GAAG,CAAE;gCAClB;gCAEA,IAAI,UAAWkf,UAAU,CAAC,QAAQG,UAAUF,QAAQ,CAAC,QAAUE,UAAUH,UAAU,CAAC,QAAQG,UAAUF,QAAQ,CAAC,MAAO;oCAClH,IAAI;wCACA,MAAMC,SAAS3a,KAAKwa,KAAK,CAACI;wCAC1B,OAAOR,cAAcO;oCACzB,EAAE,UAAM;wCACJ,OAAOzd;oCACX;gCACJ;gCACA,OAAOA;4BACX;4BACA,OAAO,OAAOA,SAAS,YAAYA,SAAS,OAAOkd,cAAcld,QAAQA;wBAC7E;oBACJ,OAAO,IAAI,OAAOtE,UAAU,YAAYA,UAAU,MAAM;wBACpDA,QAAQwhB,cAAcxhB;oBAC1B;oBAEAiJ,MAAM,CAAC1C,IAAI,GAAGvG;gBAClB;YACJ;YACA,OAAOiJ;QACX;QAEA,MAAMgZ,gBAAgBT,cAAcnL,IAAIC,QAAQ,CAACzR,SAAS;QAE1D,MAAMqd,eAAezY,OAAO0Y,IAAI,CAACF,eAAerhB,GAAG,CAAC2F,CAAAA;YAChD,OAAO;gBACH1G,OAAO0G;gBACPvG,OAAOqW,IAAIC,QAAQ,CAACzR,SAAS,CAAC0B,IAAI;YACtC;QACJ;QACA,qBACI,uCAACtJ;YACG0G,WAAW7G,YAAG,CAAC;;gBAEf,CAAC;yBAED,uCAAC8e,WAAOA;YACJjY,WAAW7G,YAAG,CAAC;wBACX,EAAEqJ,MAAME,MAAM,GAAG,4CAA4C,0CAA0C;oBAC3G,CAAC;WAEAkY,MAAM3d,GAAG,CAAC,CAACwhB,KAAK9b;YACb,qBACI,uCAACoV,OAAGA;gBACAnV,KAAKD;gBACLxG,OAAOsiB,IAAItiB,KAAK;gBAChB2e,QAAQ2D,IAAI3D,MAAM;gBAClB4D,aAAa,IACT7D,YACID,MAAM3d,GAAG,CAAC,CAACwhB,KAAK9f,MAAS,wEAClB8f;4BACH3D,QAAQnc,QAAQgE;;gBAI5Bgc,SAASJ,aAAatd,MAAM;;QAGxC,mBAGJ,uCAAC+W,cAAUA,QACN4C,KAAK,CAAC,EAAE,CAACE,MAAM,kBACZ,uCAACrJ;YACG,2DAA2D;YAC3DzR,WAAW7G,YAAG,CAAC;;;;;gCAKX,EAAEqJ,MAAME,MAAM,GAAG,4CAA4C,yCAAyC;4BAC1G,CAAC;yBAED,uCAAC6P,eACIgM,aAAathB,GAAG,CAAC,CAAC0D;YACf,IAAIwS,aAAaxS,KAAKtE,KAAK;YAC3B,MAAMD,YAAYuE,KAAKzE,KAAK;YAC5B,IAAI,OAAOiX,eAAe,UAAU;gBAChCA,aAAa1P,KAAKC,SAAS,CAACyP;YAChC;YACA,MAAMyL,gBAAgBzlB,YAAG,CAAC;;;;;;oCAM1B,CAAC;YACD,qBACI,uCAAC0Y;gBAAG7R,WAAW,GAAG4e,eAAe;gBAAEhc,KAAKxG;6BACpC,uCAAC2W;gBACG/S,WAAW7G,YAAG,CAAC;;;gDAGf,CAAC;6BAED,uCAACG;gBACG0G,WAAW,CAAC,qBAAqB,EAAE7G,YAAG,CAAC;;oDAEvC,CAAC,EAAE;6BAEH,uCAAC+Z,mBAAmBA;gBAAC9W,WAAWA;gBAAW+W,YAAYA;gCAG/D,uCAACJ;gBACG/S,WAAW7G,YAAG,CAAC;;;gDAGf,CAAC;eAEAiD,aAAa,oBAElB,uCAAC2W;gBACG/S,WAAW7G,YAAG,CAAC;;;;gDAIf,CAAC;6BAED,uCAACG;gBACG0G,WAAW7G,YAAG,CAAC;;;oDAGf,CAAC;eAEAga,cAAc;QAKnC,MAIXyH,KAAK,CAAC,EAAE,CAACE,MAAM,kBACZ,uCAACxhB,2BACG,uCAACulB;YACG7e,WAAW7G,YAAG,CAAC;;;;;;;;;oCASX,EAAEqJ,MAAME,MAAM,GAAG,+CAA+C,0CAA0C;;;;gCAI9G,CAAC;WAEAe,KAAKC,SAAS,CAAC4a,eAAe,MAAM,qBAKrD,uCAAC2B,sBAAOA;YAAC9S,OAAM;yBACX,uCAAClH;YACG7E,SAAS;gBACLvB,QAAQC,GAAG,CAAC,OAAO4S;gBACnBoO,uBAAuB;gBACvBL,eAAe/N,IAAIC,QAAQ;YAC/B;YACA3S,WAAW7G,YAAG,CAAC;;;;;;;;;oBASnB,CAAC;WACA;IAMjB;IAEA,MAAMyoB,WAAW,CAAClb;QACd,IAAIA,UAAU,OAAOA,UAAU,KAAK;YAChCka,cAAc;QAClB;IACJ;IAEA,MAAMiB,kBAAkB,CAACC,SAAiBrQ;QACtC,UAAU;QACV8O,aAAauB,SAASrQ,OAAOmQ;IACjC;IAEA,MAAMtQ,UAAUlU,2BAAOA,CAAwB;QAC3C,IAAI8hB,iBAAwC;YACxC;gBACIC,aAAa;gBACbpN,QAAQ,EAAE;gBACVe,MAAM,CAAC,EAAEJ,GAAG,EAAEzT,QAAQ,EAAE;oBACpB,OACIyT,IAAI0M,YAAY,oBACZ,uCAAC9lB;wBAAI0G,WAAU;uBACV0S,IAAIE,aAAa,mBACd,uCAAC/Q,cAAUA;wBAACT,SAASsR,IAAI2M,wBAAwB;wBAAI/e,MAAK;wBAAasD,SAAQ;uCAE/E,uCAAC/B,cAAUA;wBAACT,SAASsR,IAAI2M,wBAAwB;wBAAI/e,MAAK;wBAAcsD,SAAQ;sCAEpF,uCAACtK;wBAAI0G,WAAU;uBAAQf;gBAIvC;YACJ;YACA;gBACI8S,QAAQ,IAAMwH,oBAAoB;gBAClC4F,aAAa;gBACbrM,MAAM,CAAC,EAAEJ,GAAG,EAAEzT,QAAQ,EAAE;oBACpB,MAAMkU,aAAalU;oBACnB,MAAM7C,YAAYmd;oBAClB,0CAA0C;oBAC1C,MAAMwI,YAAY3mB,YAAYkC,IAAI,CAAC,CAACJ,IAAWA,EAAEb,KAAK,KAAKkd;oBAC3D,MAAMvR,YAAY+Z,CAAAA,sBAAAA,gCAAAA,UAAWxkB,IAAI,KAAI;oBACrC,IAAIqX,YAAiBzB;oBAErB,6DAA6D;oBAC7D,IAAI;wBACA,IAAI4O,aAAa3B,2CAAoBA,CAAChiB,OAAO2jB,UAAUxkB,IAAI,EAAEwB,WAAW,KAAK;4BACzE,gCAAgC;4BAChC,MAAMijB,MAAMC,OAAO9O;4BACnB,IAAI,CAAC8O,OAAO/iB,KAAK,CAAC8iB,MAAM;gCACpBpN,YAAYuE,gDAAyBA,CAAC6I;4BAC1C,OAAO;gCACH,oDAAoD;gCACpDpN,YAAYxW,OAAO+U,cAAc;4BACrC;wBACJ;oBACJ,EAAE,OAAOnU,GAAG;wBACR,kBAAkB;wBAClB4V,YAAYzB;oBAChB;oBACA,qBACI,uCAAC7Z;wBACG0G,WAAW,GAAG7G,YAAG,CAAC;;6BAEjB,CAAC,CAAC,CAAC,EAAE6Z,UAAUA,EAAE;qCAElB,uCAAC1Z;wBACG0G,WAAW7G,YAAG,CAAC;;;iCAGd,CAAC;uBAEDyb,yBACD,uCAACtb;wBACG0G,WAAW,CAAC,eAAe,EAAE7G,YAAG,CAAC;;qCAEhC,CAAC,EAAE;qCAEJ,uCAACqa,WAAWA;wBAACpX,WAAWA;wBAAW+W,YAAYA;wBAAYnL,WAAWA;;gBAK1F;YACJ;SACH;QACD,IAAI,CAACsB,mBAAmB;YACpB4V,eAAejS,IAAI,CAAC;gBAChBkS,aAAa;gBACbpN,QAAQ;gBACRe,MAAM;wBAAC,EAAEJ,GAAG,EAAEzT,QAAQ,EAAW,WAANwX,OAAAA,0CAAAA;wBAAlB/D;wBAAKzT;;oBACV,MAAMgQ,OAAOhQ;oBACb,MAAMijB,cAAuDljB,CAAAA;wBACzD,MAAM8K,SAAS9K,EAAE8K,MAAM;wBACvB,IAAI,CAACA,QAAQ;4BACT;wBACJ;wBAEA,MAAMqY,OAAOrY,OAAOsY,OAAO,CAAc;wBACzC,IAAI,CAACD,MAAM;4BACP;wBACJ;wBAEA,MAAML,UAAUK,KAAKE,YAAY,CAAC;wBAClC,IAAI,CAACP,SAAS;4BACV;wBACJ;wBAEA9iB,EAAEqC,cAAc;wBAChB,IAAIqgB,oBAAoBH,kBAAkB;4BACtCM,gBAAgBC,SAASP;wBAC7B,OAAO;4BACHM,gBAAgBC;wBACpB;oBACJ;oBAEA,qBACI,uCAACxoB;wBACG0G,WAAW7G,YAAG,CAAC;;;;;4BAKf,CAAC;qCAED,uCAAC8Z,kBAAkBA;wBACfjT,WAAW7G,YAAG,CAAC;;0DAEW,EAAEqJ,MAAME,MAAM,GAAG,YAAY,qBAAqB;;;;;;;gCAO5E,CAAC;qCAED,uCAACpJ;wBACG8H,SAAS8gB;wBACT1C,yBAAyB;4BAAED,QAAQtQ;wBAAK;wBACxCjP,WAAW7G,YAAG,CAAC;;;;;oCAKf,CAAC;;gBAKrB;YACJ;QACJ,OAAO;YACH+lB,iBAAiB;mBACVA;mBACAzW,eAAexL,GAAG,CAAC,CAACf;oBACnB,OAAO;wBACHijB,aAAajjB,MAAM7B,KAAK;wBACxB0X,QAAQ,kBACJ,uCAACzY;gCACG0G,WAAW7G,YAAG,CAAC;;;gCAGf,CAAC;6CAED,uCAACG,aAAK4C,MAAM7B,KAAK,iBACjB,uCAACwH,cAAUA;gCACPvB,MAAK;gCACLsD,SAAQ;gCACRC,OAAO;oCACHC,YAAY;oCACZ2b,QAAQ;oCACRC,WAAW;gCACf;gCACAte,SAASpC,CAAAA;oCACL0K,aAAaxN;oCACb8C,EAAEqC,cAAc;oCAChBrC,EAAE4H,eAAe;gCACrB;;wBAIZkM,MAAM,CAAC,EAAEJ,GAAG,EAAEzT,QAAQ,EAAO;4BACzB,wDAAwD;4BACxD,IAAIkU,aAAavO,sBAAGA,CAAC8N,IAAIC,QAAQ,CAACzR,SAAS,EAAEhF,MAAM7B,KAAK;4BACxD,MAAM+B,YAAYF,MAAM7B,KAAK;4BAC7B,MAAM2N,YAAY9L,MAAMqB,IAAI;4BAC5B,IAAI,OAAO4V,eAAe,UAAU;gCAChCA,aAAa1P,KAAKC,SAAS,CAACyP;4BAChC;4BACA,qBACI,uCAAC7Z;gCACG0G,WAAW,GAAGgT,UAAUA,CAAC,CAAC,EAAE7Z,YAAG,CAAC;;;;oCAIhC,CAAC,EAAE;6CAEH,uCAACG;gCACG0G,WAAW7G,YAAG,CAAC;;;wCAGf,CAAC;6CAED,uCAACG;gCACG0G,WAAW7G,YAAG,CAAC;;;;;4CAKf,CAAC;+BAEA+C,MAAMG,KAAK,KAAK,2BAAa,uCAAC2jB,yBAASA;gCACpChgB,WAAW7G,YAAG,CAAC,kBAAkB,CAAC;gCAClCiI,SAAS;oCACL,IAAIsgB,oBAAoBH,kBAAkB;wCACtCM,gBAAgB1O,YAAYoO;oCAChC,OAAO;wCACHM,gBAAgB1O;oCACpB;gCACJ;gCACArU,MAAK;+BACJqU,4BAED,uCAAC9P;gCACGrD,WAAW7G,YAAG,CAAC;;;;;;oDAMf,CAAC;+BAEAga,6BAKjB,uCAAC7Z;gCACG0G,WAAW,CAAC,eAAe,EAAE7G,YAAG,CAAC;;wCAEjC,CAAC,EAAE;6CAEH,uCAACqa,WAAWA;gCAACpX,WAAWA;gCAAW+W,YAAYA;gCAAYnL,WAAWA;;wBAItF;oBACJ;gBACJ;aACH;QACL;QACA,OAAOkX;IACP,uDAAuD;IAC3D,GAAG;QAAC3F;QAAkB7P;QAAcJ;QAAmBb;QAAgBjG,MAAME,MAAM;KAAC;IAEpF,qBACI,uCAACpJ;QACG0G,WAAW7G,YAAG,CAAC;;YAEf,CAAC;qBAKD,uCAACkY,kBAAkBA;QACfrR,WAAW7G,YAAG,CAAC;;gBAEf,CAAC;QACDyT,MAAM4M;QACNlI,SAASA;QACTE,iBAAiB,IAAM;QACvBD,oBAAoBA;sBAExB,uCAACjY;QACG0G,WAAW7G,YAAG,CAAC;;;;;;gBAMf,CAAC;qBAED,uCAACG,aAAI,UAAOqM,iBAAgB,wBAC5B,uCAACrM;QAAIuK,OAAO;YAAEyP,SAAS;YAAQgP,YAAY;YAAUC,KAAK;QAAM;qBAC5D,uCAACxC,cAAUA;QACPyC,aAAanN;QACboN,eAAe5V,KAAK6V,IAAI,CAAC/c,kBAAkB+P,aAAa;QACxDiN,YAAYC,CAAAA;YACRtW,QAAQsW;QACZ;sBAGJ,uCAACtpB;QACG0G,WAAW7G,YAAG,CAAC;;;;wBAIf,CAAC;qBAGD,uCAAC0pB;QACG/jB,MAAK;QACLgkB,KAAK;QACLC,MAAM;QACN1mB,OAAOmlB;QACP3gB,UAAU7B,CAAAA;YACNyiB,YAAYziB,EAAE8K,MAAM,CAACzN,KAAK;QAC9B;QACA2mB,WAAWhkB,CAAAA;YACP,IAAIA,EAAE4D,GAAG,KAAK,SAAS;gBACnB,MAAMof,MAAMC,OAAOT;gBACnB,MAAMyB,QAAQpW,KAAKqW,GAAG,CAACrW,KAAK6V,IAAI,CAAC/c,kBAAkB+P,aAAa,GAAG;gBACnE,IAAI,CAACuM,OAAO/iB,KAAK,CAAC8iB,MAAM;oBACpB,MAAMlY,SAAS+C,KAAKiW,GAAG,CAACjW,KAAKqW,GAAG,CAAC,GAAGrW,KAAKsW,KAAK,CAACnB,OAAOiB;oBACtD3W,QAAQxC;oBACR,IAAI;wBACAwW,iBAAiBA,cAAcxW;oBACnC,EAAE,UAAM,CAAE;oBACV2X,YAAYrjB,OAAO0L;gBACvB,OAAO;oBACH,mCAAmC;oBACnC2X,YAAYrjB,OAAOiX;gBACvB;YACJ;QACJ;QACArV,WAAW7G,YAAG,CAAC;;;;;4BAKf,CAAC;sBAEL,uCAACiqB;QACGhiB,SAAS;YACL,MAAM4gB,MAAMC,OAAOT;YACnB,MAAMyB,QAAQpW,KAAKqW,GAAG,CAACrW,KAAK6V,IAAI,CAAC/c,kBAAkB+P,aAAa,GAAG;YACnE,IAAI,CAACuM,OAAO/iB,KAAK,CAAC8iB,MAAM;gBACpB,MAAMlY,SAAS+C,KAAKiW,GAAG,CAACjW,KAAKqW,GAAG,CAAC,GAAGrW,KAAKsW,KAAK,CAACnB,OAAOiB;gBACtD3W,QAAQxC;gBACR,IAAI;oBACAwW,iBAAiBA,cAAcxW;gBACnC,EAAE,UAAM,CAAE;gBACV2X,YAAYrjB,OAAO0L;YACvB,OAAO;gBACH2X,YAAYrjB,OAAOiX;YACvB;QACJ;QACArV,WAAW7G,YAAG,CAAC;;;;;;4BAMf,CAAC;OACJ,wBAIb,uCAAC+mB,2BAAWA;QAACld,SAAS,IAAM4d,cAAc;QAAQ3e,MAAM0e;QAAYmB,OAAO,EAAExI,wBAAAA,kCAAAA,YAAa+J,QAAQ;QAAEC,YAAW;QAE9GzC,qCACG,uCAACf,UAAMA;QACHxZ,MAAK;QACL6G,OAAM;QACNnK,SAAS;YACL+W,wBAAwB,EAAE;YAC1BnG,yBAAyB,EAAE;YAC3BqG,eAAe;YACfE,cAAc;YACd,oCAAoC;YACpC2G,uBAAuB;QAC3B;qBAEA,uCAACzH,eAAeA;AAKpC;;;AChtBmC;AACE;AAE9B,MAAMkK,uBAAuBnqB,yCAAMA,CAACE,GAAG,CAAC;;;;;;;;;;;;;;;;;;;;;;AAsB/C,CAAC,CAAC;AAEK,MAAMkqB,2BAA2BpqB,yCAAMA,CAACE,GAAG,CAAC;;;;;;;;;;AAUnD,CAAC,CAAC;AAEK,MAAMmqB,gBAAgBtqB,YAAG,CAAC;;;;;;;;;;;;AAYjC,CAAC,CAAC;;;ACnDwD;AAChC;AACgH;AACtC;AACjE;AAEY;AAEhC,SAAS6qB;IACpB,MAAM,EAAEnlB,CAAC,EAAE,GAAG2C,6BAAcA;IAC5B,MAAM,CAACyiB,YAAYC,cAAc,GAAGvqB,yBAAOA,CAACiqB,+BAAcA;IAC1D,MAAM3a,iBAAiBkB,4BAAUA,CAAC0Z,gCAAeA;IACjD,MAAMM,kBAAkBvqB,8BAAYA,CAAC+pB,oCAAmBA;IACxD,MAAMjoB,UAAU9B,8BAAYA,CAACc,4BAAWA;IACxC,MAAM0pB,qBAAqBja,4BAAUA,CAAC2Z,oCAAmBA;IACzD,MAAM,CAACO,cAAcC,gBAAgB,GAAG3qB,yBAAOA,CAAC+pB,iCAAgBA;IAChE,MAAMa,aAAaN,eAAe;IAClC,MAAMzhB,QAAQT,iBAASA;IAEvB,MAAMrB,UAAU;QACZ,IAAI;QACJ,wBAAwB;QACxB,uBAAuB;QACvB,sCAAsC;QACtC,wDAAwD;QACxD,KAAK;QACL;YAAEvE,OAAO;YAAOE,OAAO;QAAM;QAC7B;YAAEF,OAAO;YAAUE,OAAO;QAAS;KACtC;IAED,SAASmoB;QACL,qBACI,uCAAClrB;YAAI0G,WAAU;yBACX,uCAAC2H,oBAAgBA;YACbjH,SAASA;YACTyjB,iBAAiBA;YACjB9nB,OAAO4nB;YACPpjB,UAAUwD,CAAAA;gBACN6f,cAAc7f;gBACd4E,eAAe;YACnB;YAEHvN,WAAW6oB,2BACR,uCAACjrB;YAAI0G,WAAU;yBACX,uCAAC+jB,eAAWA;YACRrjB,SAAShF,QAAQuC,MAAM,CAAC,CAAC0C,OAAcA,KAAK7B,IAAI,KAAK;YACrDzC,OAAOgoB;YACPxjB,UAAU,CAACF,MAAmC8jB;gBAC1C,MAAMC,kBAAyB,EAAE;gBACjC/jB,KAAKyE,OAAO,CAACuf,CAAAA;oBACTjpB,QAAQ0J,OAAO,CAAC,CAACzE;wBACb,IAAIA,KAAKtE,KAAK,KAAKsoB,eAAe;4BAC9BD,gBAAgBzX,IAAI,CAACtM;wBACzB;oBACJ;gBACJ;gBACAyjB,mBAAmBM;gBACnBJ,gBAAgB3jB;YACpB;4BAIR;IAIhB;IACA,qBACI,gGACI,uCAACmB,aAASA;QAACmB,aAAa;QAAOC,uBAAS,uCAACshB;QAAsBrhB,WAAU;qBACrE,uCAAC7J;QACG0G,WAAW7G,YAAG,CAAC;;;;;;0CAMO,EAAEqJ,MAAME,MAAM,GAAG,oBAAoB,OAAO;;;;;oBAKlE,CAAC;qBAED,uCAACW,cAAO4gB,2BACR,uCAAC5gB;QAAKQ,OAAO;YAAE+gB,aAAa;QAAE;qBAC1B,uCAAChjB,QAAIA;QAACtB,MAAK;;AAMnC;;;AC5F6C;AACC;AAC9C,kDAAkD;AAClD,8CAA8C;AAC9C,uCAAuC;AAKf;AACY;AACpC,yFAAyF;AAG1E,SAASukB,UAAU,EAAEhhB,KAAK,EAAEihB,UAAU,EAAqD;IACxG,MAAMb,aAAarqB,8BAAYA,CAACgqB,+BAAcA;IAC9C,sDAAsD;IACtD,kEAAkE;IAClE,MAAM,CAAC5a,aAAaC,eAAe,GAAGtP,yBAAOA,CAACkqB,gCAAeA;IAC7D,+DAA+D;IAC/D,IAAInY,KAAqC,EAAE;AAAA,EAE1C;IACD,uFAAuF;IACvF,sCAAsC;IAEtC,4BAA4B;IAE5B,+DAA+D;IAC/D,iBAAiB;IACjB,OAAO;IAEP,qBACE,uCAACtR,SAAKA;QACJiC,OAAO2M;QACPnI,UAAU,CAAC7B;gBAEMA;YADfa,QAAQC,GAAG,CAACd;YACZiK,gBAAejK,YAAAA,EAAE8K,MAAM,cAAR9K,gCAAAA,UAAU3C,KAAK;QAChC;QACA2mB,WAAW,CAAChkB;YACV,kCAAkC;YAClC,MAAM+lB,SAAS,EAAWC,WAAW;YACrC,IAAIhmB,EAAE4D,GAAG,KAAK,WAAW,CAAEmiB,CAAAA,UAAUA,OAAOE,WAAW,GAAG;gBACxD,qCAAqC;gBACrC,IAAI;oBACFH,uBAAAA,iCAAAA;gBACF,EAAE,OAAOtH,KAAK;oBACZ,2DAA2D;oBAC3D,sCAAsC;oBACtC3d,QAAQK,KAAK,CAAC,6BAA6Bsd;gBAC7C;YACF;QACF;QACA5c,aACEqjB,eAAe,QAAQ,sEAAsE;QAE/FpgB,OAAOA;;AAqEb;;;;;AC7H0B;AACM;AACiB;AACb;AAErB,SAASqhB,OAAO,EAAEJ,UAAU,EAA+B;IACtE,MAAM,CAAC9b,aAAaC,eAAe,GAAGtP,yBAAOA,CAACkqB,gCAAeA;IAC7D,IAAInY,KAAqC,EAAE;AAAA,EAE1C;IAED,qBACI,uCAACtR,SAAKA;QACFiC,OAAO2M;QACPnI,UAAU,CAAC7B;gBAEQA;YADfa,QAAQC,GAAG,CAACd;YACZiK,gBAAejK,YAAAA,EAAE8K,MAAM,cAAR9K,gCAAAA,UAAU3C,KAAK;QAClC;QACA2mB,WAAW,CAAChkB;YACR,MAAM+lB,SAAS,EAAWC,WAAW;YACrC,IAAIhmB,EAAE4D,GAAG,KAAK,WAAW,CAAEmiB,CAAAA,UAAUA,OAAOE,WAAW,GAAG;gBACtD,IAAI;oBACAH,uBAAAA,iCAAAA;gBACJ,EAAE,OAAOtH,KAAK;oBACV,sCAAsC;oBACtC3d,QAAQK,KAAK,CAAC,6BAA6Bsd;gBAC/C;YACJ;QACJ;QACA5c,aAAY;;AAGxB;;;AChCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAC4D;AAClC;AACqC;AACxB;AACF;AACqB;AACN;AACjB;AAoBX;AACyC;AACc;AACjC;AAC6D;AAE/D;AACd;AAEf,SAASolB,eACpBlf,KAGC;IAED,8BAA8B;IAC9B,8CAA8C;IAC9C,MAAMmf,aAAa9b,4BAAUA,CAACzP,4BAAWA;IACzC,oDAAoD;IACpD,MAAM,CAAC4Q,iBAAiBC,mBAAmB,GAAG5R,yBAAOA,CAACgR,oCAAmBA;IACzE,IAAIe,KAAqC,EAAE;AAAA,EAE1C;IACD,MAAM,CAACpJ,MAAMC,OAAO,GAAG5I,yBAAOA,CAAC8H,6BAAYA;IAC3C,2EAA2E;IAC3E,MAAMykB,iBAAiB/b,4BAAUA,CAAC7P,gCAAeA;IACjD,MAAM,CAAC6rB,YAAYC,cAAc,GAAGzsB,yBAAOA,CAACyrB,+BAAcA;IAC1D,MAAM,CAACiB,cAAcjb,eAAe,GAAGzR,yBAAOA,CAAC+Q,gCAAeA;IAC9D,MAAM6O,mBAAmB3f,8BAAYA,CAACue,qCAAoBA;IAC1D,MAAM,GAAGmM,gBAAgB,GAAG3qB,yBAAOA,CAAC+pB,iCAAgBA;IACpD,MAAM4C,cAAc1sB,8BAAYA,CAACyrB,gCAAeA;IAChD,8CAA8C;IAC9C,MAAM,CAACkB,YAAYC,eAAe,GAAG7sB,yBAAOA,CAACiR,mCAAkBA;IAC/D,uDAAuD;IACvD,sDAAsD;IACtD,gDAAgD;IAChD,oDAAoD;IACpD,wDAAwD;IACxD,oDAAoD;IACpD,MAAM,CAAC6b,oBAAoBC,sBAAsB,GAAG/sB,yBAAOA,CAAC8e,uCAAsBA;IAClF,MAAM,CAAC1I,WAAW5D,aAAa,GAAGxS,yBAAOA,CAACsR,8BAAaA;IACvD,MAAM,CAAC0O,cAAcgN,gBAAgB,GAAGhtB,yBAAOA,CAAC0e,iCAAgBA;IAChE,MAAM,CAACuO,WAAWC,aAAa,GAAGltB,yBAAOA,CAAC4rB,8BAAaA;IACvD,MAAM,CAACuB,QAAQC,UAAU,GAAGptB,yBAAOA,CAAC6rB,2BAAUA;IAC9C,MAAM,CAACwB,aAAa,GAAGrtB,yBAAOA,CAAC2rB,gCAAeA;IAC9C,MAAMrB,aAAarqB,8BAAYA,CAACgqB,+BAAcA;IAC9C,MAAMW,aAAaN,eAAe;IAElC,MAAMzN,aAAa5c,8BAAYA,CAAC6e,uCAAsBA;IACtD,MAAMjW,QAAQT,iBAASA;IAEvB,MAAMklB,iBAAiBptB,oCAAiB,CAAC,CAACqtB;QACtC,IAAI,CAACA,IAAI;YACL,OAAO9nB;QACX;QAEA,OAAOumB,oCAAYA,CAACuB,IAAIC,SAAS,CAAC;YAC9BC,MAAM,CAACC;gBACH,MAAM,EAAEza,IAAI,EAAE6O,EAAE,EAAE,GAAG4L;gBACrB,IAAI5L,IAAI;oBACJ,MAAM6L,QAAQvB,qBAAWA,CAACnZ,KAAK+O,OAAO,CAACgK,YAAY,CAAC/J,MAAM,CAAC,EAAE;oBAC7D,MAAM2L,SAAS/qB,MAAMwT,IAAI,CAACsX,MAAM9N,MAAM,CAAC,EAAE,CAAC+N,MAAM;oBAChD,MAAM7mB,UAAU6mB,OAAOtqB,GAAG,CAAC,CAAC0D,OAAkB;4BAAExE,OAAOwE;4BAAMtE,OAAOsE;wBAAK;oBACzEkmB,aAAanmB;gBACjB;YACJ;YACAR,OAAO,CAACsd,MAAa3d,QAAQC,GAAG,CAAC,eAAe0d;QACpD;IACJ,GAAG;QAACqJ;KAAa;IAEjBjqB,6BAASA,CAAC;QACN,IAAI,CAAC4Z,YAAY;YACb;QACJ;QAEA,MAAMgR,eAAyCP,eAAezQ;QAE9D,OAAO,IAAMgR,yBAAAA,mCAAAA,aAAcC,WAAW;IAC1C,GAAG;QAACjR;QAAYyQ;KAAe;IAE/B,SAASS,UAAUC,aAAkB;QACjC/B,wCAAgBA,CAAC;YACbpP;YACA9B,UAAUpJ,gBAAgBoJ,QAAQ;YAClCjD,OAAOkW,cAActrB,KAAK;QAC9B,GAAG8qB,SAAS,CAAC;YACTC,MAAM,CAAC,EAAExa,IAAI,EAAE6O,EAAE,EAAO;gBACpB,IAAIA,IAAI;oBACJ,MAAM6L,QAAQvB,qBAAWA,CAACnZ,KAAK+O,OAAO,CAAC+L,SAAS,CAAC9L,MAAM,CAAC,EAAE;oBAC1D/b,QAAQC,GAAG,CAAC,SAASwnB;oBACrB,MAAMC,SAAS/qB,MAAMwT,IAAI,CAACsX,MAAM9N,MAAM,CAAC,EAAE,CAAC+N,MAAM;oBAChD,MAAMK,aAAaprB,MAAMwT,IAAI,CAACsX,MAAM9N,MAAM,CAAC,EAAE,CAAC+N,MAAM;oBAEpD,MAAMnsB,cAAcmsB,OAAOtqB,GAAG,CAAC,CAAC0D,MAAWgC;wBACvC,OAAO;4BACHxG,OAAOwE;4BACPtG,OAAOsG;4BACPtE,OAAOsE;4BACPpD,MAAMqqB,UAAU,CAACjlB,MAAM;wBAC3B;oBACJ;oBAEAujB,eAAe9qB;oBAEf,IAAImsB,QAAQ;4BAgBO7mB;wBAff,MAAMA,UAAU6mB,OACXtpB,MAAM,CAAC,CAAC/B,OAAYyG;4BACjB,OAAOyd,2CAAoBA,CAACwH,UAAU,CAACjlB,MAAM,CAAC5D,WAAW;wBAC7D,GACC9B,GAAG,CAAC,CAAC0D;4BACF,OAAO;gCACHxE,OAAOwE;gCACPtE,OAAOsE;4BACX;wBACJ;wBACAd,QAAQC,GAAG,CAAC,QAAOwL;wBAEvBC,mBAAmB,sEACZD;4BACHmG,OAAOkW,cAActrB,KAAK;4BAC1BuY,WAAWlU,EAAAA,YAAAA,OAAO,CAAC,EAAE,cAAVA,gCAAAA,UAAYrE,KAAK,KAAI;;wBAEpC+pB,cAAc1lB;oBAClB;gBACJ;YACJ;YACAR,OAAO,CAACsd;gBACJ3d,QAAQC,GAAG,CAAC,eAAe0d;YAC/B;QACJ;IACJ;IAEA,SAASqK,WAAWF,aAAkB;QAClC9B,yCAAiBA,CAAC;YACdrP;YACA9B,UAAUpJ,gBAAgBoJ,QAAQ;YAClCjD,OAAOkW,cAActrB,KAAK;QAC9B,GAAG8qB,SAAS,CAAC;YACTC,MAAM,CAAC,EAAExa,IAAI,EAAE6O,EAAE,EAAO;gBACpB,IAAIA,IAAI;oBACJ,MAAM6L,QAAQvB,qBAAWA,CAACnZ,KAAK+O,OAAO,CAACkM,UAAU,CAACjM,MAAM,CAAC,EAAE;oBAC3D,MAAM2L,SAAS/qB,MAAMwT,IAAI,CAACsX,MAAM9N,MAAM,CAAC,EAAE,CAAC+N,MAAM;oBAChD,MAAMO,cAActrB,MAAMwT,IAAI,CAACsX,MAAM9N,MAAM,CAAC,EAAE,CAAC+N,MAAM;oBACrD,MAAMQ,eAAevrB,MAAMwT,IAAI,CAACsX,MAAM9N,MAAM,CAAC,GAAG,CAAC+N,MAAM;oBAEvD,IAAI,CAACA,UAAUA,OAAOtmB,MAAM,KAAK,GAAG;wBAChCglB,WAAW,EAAE;wBACb3B,gBAAgB,EAAE;wBAClB;oBACJ;oBAEA,MAAM0D,eAAeT,mBAAAA,6BAAAA,OAAQtqB,GAAG,CAAC,CAAC0D,MAAWgC;wBACzC,OAAO;4BACHxG,OAAOwE;4BACPtE,OAAOsE;4BACP7B,MAAMipB,YAAY,CAACplB,MAAM;4BACzB/D,YAAYkpB,WAAW,CAACnlB,MAAM;wBAClC;oBACJ;oBAEAsjB,WAAW+B;oBAEX,IAAIA,cAAc;wBACd1D,gBAAgB0D;oBACpB;gBACJ;YACJ;YACA9nB,OAAO,CAACsd;gBACJ3d,QAAQC,GAAG,CAAC,eAAe0d;YAC/B;QACJ;IACJ;IAEA,qBACI,uCAAClkB;QACG0G,WAAW7G,YAAG,CAAC;;;kCAGO,EAAEqJ,MAAME,MAAM,GAAG,oBAAoB,OAAO;;;YAGlE,CAAC;qBAED,uCAAC6gB,oBAAoBA;QAACvjB,WAAU;qBAC5B,uCAAC3F,SAAKA;QAAC8B,OAAM;qBAET,uCAACgpB,yBAAgBA;QACZ5e,OAAO;QACPzH,MAAM;QACNU,SAASinB;QACT7lB,aAAY;QACZqnB,WAAAA;QACAhqB,QAAQipB,CAAAA,KAAMA,GAAGpoB,IAAI,KAAK;QAC1B+B,UAAUF,CAAAA;YACNd,QAAQC,GAAG,CAAC,QAAQa;YACpB+lB,sBAAsB/lB;YACtB,iEAAiE;YACjEsmB,eAAetmB;QACnB;uBAIT,uCAACtG,SAAKA;QAAC8B,OAAM;QAAW0H,OAAO;YAAEC,YAAY;QAAE;qBAC3C,uCAAC/J,UAAMA;QACHwM,OAAO;QACP7F,SAASkmB;QACTvqB,OAAOiP,gBAAgBoJ,QAAQ;QAC/B7T,UAAU,CAACqnB;YACP3c,mBAAmB,sEACZD;gBACHoJ,UAAUwT,iBAAiB7rB,KAAK;;YAEpCypB,wCAAgBA,CAAC;gBACbtP;gBACA9B,UAAUwT,iBAAiB7rB,KAAK;YACpC,GAAG8qB,SAAS,CAAC;gBACTC,MAAM,CAACC;oBACH,MAAM,EAAEza,IAAI,EAAE6O,EAAE,EAAE,GAAG4L;oBACrB,IAAI5L,IAAI;wBACJ,MAAM6L,QAAQvB,qBAAWA,CAACnZ,KAAK+O,OAAO,CAACwM,SAAS,CAACvM,MAAM,CAAC,EAAE;wBAC1D,MAAM2L,SAAS/qB,MAAMwT,IAAI,CAACsX,MAAM9N,MAAM,CAAC,EAAE,CAAC+N,MAAM;wBAChD,MAAM7mB,UAAU6mB,OAAOtqB,GAAG,CAAC,CAAC0D,OAAkB;gCAAExE,OAAOwE;gCAAMtE,OAAOsE;4BAAK;wBACzEomB,UAAUrmB;oBACd;gBACJ;gBACAR,OAAO,CAACsd,MAAa3d,QAAQC,GAAG,CAAC,eAAe0d;YACpD;QACJ;uBAIR,uCAACnjB,SAAKA;QAAC8B,OAAM;QAAQ0H,OAAO;YAAEC,YAAY;QAAE;qBACxC,uCAAC/J,UAAMA;QACH2G,SAASomB;QACTvgB,OAAO;QACPlK,OAAOsd;QACP9Y,UAAU,CAAC8mB;YACP9nB,QAAQC,GAAG,CAAC,uBAAsB6nB,cAActrB,KAAK;YAErDkP,mBAAmB,sEACZD;gBACHmG,OAAOkW,cAActrB,KAAK;;YAE9BsqB,gBAAgBgB,cAActrB,KAAK;YACnCqrB,UAAUC;YACVE,WAAWF;QACf;uBAGR,uCAACttB,SAAKA;QAAC8B,OAAM;QAAO0H,OAAO;YAAEC,YAAY;YAAG8gB,aAAa;YAAGre,OAAO;QAAQ;qBACvE,uCAACyd,UAAUA,UAEdC,eAAe,yBACZ,uCAAC5pB,SAAKA;QAAC8B,OAAM;QAAS0H,OAAO;YAAE0C,OAAO;QAAO;qBACzC,uCAAC2e,MAAMA;QAACJ,YAAY,IAAMhe,kBAAAA,4BAAAA,MAAOge,UAAU;wBAG/C,uCAACzqB,SAAKA;QAAC8B,OAAOooB,aAAa,WAAW;QAAO1gB,OAAO;YAAE0C,OAAO;QAAO;qBAChE,uCAACse,SAASA;QACNhhB,OAAO;YAAEukB,MAAM;QAAI;QACnBtD,YAAY;YACRhe,kBAAAA,4BAAAA,MAAOge,UAAU;QACrB;UAKf,CAACwB,6BACE,gGACI,uCAACjsB,SAAKA;QAAC8B,OAAM;qBACT,uCAACpC,UAAMA;QACHsC,OAAOkd;QACP7Y,SAASylB;QACTtlB,UAAU,CAACwnB;YACP9c,mBAAmB,sEACZD;gBACHsJ,WAAWyT,kBAAkBhsB,KAAK;;YAEtCkG,OAAO,CAACzF;gBACJ,MAAMyG,eAAezG,KAAKyG,YAAY;gBACtCA,yBAAAA,mCAAAA,aAAcC,GAAG,CAAC,aAAa6kB,kBAAkBhsB,KAAK;gBACtD,OAAO,sEACAS;oBACHyG;;YAER;QACJ;QACA3C,aAAa;uBAGrB,uCAACvG,SAAKA;QAAC8B,OAAM;QAAa0H,OAAO;YAAEC,YAAY;YAAG8gB,aAAa;QAAE;qBAC7D,uCAACc,kBAAcA;QACX4C,YAAY;QACZznB,UAAUkP,CAAAA;YACN,MAAMwY,QAAQne,mBAAKA,CAAC2F,UAAUC,IAAI,CAACwY,MAAM;YACzC,MAAMC,MAAMre,mBAAKA,CAAC2F,UAAUG,EAAE,CAACsY,MAAM;YACrCjmB,OAAOzF,CAAAA;gBACH,MAAMyG,eAAezG,KAAKyG,YAAY;gBACtCA,yBAAAA,mCAAAA,aAAcC,GAAG,CAAC,aAAa+kB,MAAMtY,MAAM,CAACzF,6BAAWA;gBACvDjH,yBAAAA,mCAAAA,aAAcC,GAAG,CAAC,WAAWilB,IAAIxY,MAAM,CAACzF,6BAAWA;gBACnD,OAAO,sEACA1N;oBACHyG;;YAER;YACA6H,eAAe;gBAACmd;gBAAOE;aAAI;YAC3Btc,aAAa4D;QACjB;QACA1T,OAAO0T;wBAKvB,uCAAC1V,SAAKA;QAAC8B,OAAM;qBACT,uCAAChC,UAAMA;QACHiH,SAAS;YACL,MAAMsnB,aAAajD,oCAAaA,CAACc,uBAAAA,iCAAAA,WAAY3jB,GAAG;YAChD,IAAI8lB,YAAY;gBACZ,MAAM,CAACC,iBAAiBC,cAAc,GAAGF;gBACzCnmB,OAAOzF,CAAAA;oBACH,MAAMyG,eAAezG,KAAKyG,YAAY;oBACtCA,yBAAAA,mCAAAA,aAAcC,GAAG,CAAC,aAAa4G,mBAAKA,CAACue,iBAAiB1Y,MAAM,CAACzF,6BAAWA;oBACxEjH,yBAAAA,mCAAAA,aAAcC,GAAG,CAAC,WAAW4G,mBAAKA,CAACwe,eAAe3Y,MAAM,CAACzF,6BAAWA;oBACpE,OAAO,sEACA1N;wBACHyG;;gBAER;YACJ;YACAuD,kBAAAA,4BAAAA,MAAOge,UAAU;QACrB;QACA3jB,SAAQ;QACRnB,WAAU;QACVgE,MAAM8C,CAAAA,kBAAAA,4BAAAA,MAAOoU,OAAO,IAAG,kBAAkB;QACzC2N,UAAU,CAACtP;OAEV,CAAC,KAAK,CAAC;AAK5B;;;;;;;;;;;ACjXO,SAASuP,oBAAoBC,KAAa;IAC7C,OAAOA,MACFnY,OAAO,CAAC,SAAS,yBACjBA,OAAO,CAAC,WAAW,iBACnBA,OAAO,CAAC,YAAY,kBACpBA,OAAO,CAAC,uBAAuB,sBAC/BA,OAAO,CAAC,QAAQ;AACzB;AAEO,SAASoY,oBAAoBD,KAAa;IAC7C,OAAOA,MACFnY,OAAO,CAAC,QAAQ,KAChBA,OAAO,CAAC,0BAA0B,MAClCA,OAAO,CAAC,iBAAiB,WACzBA,OAAO,CAAC,kBAAkB,YAC1BA,OAAO,CAAC,6BAA6B,gBACrCA,OAAO,CAAC,cAAc;AAC/B;;;ACjBO,MAAMqY,wBAAcA,GAAG,aAAa;AAEpC,MAAMC,gCAAgC;IACzC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACH,CAAC;;;ACVF,MAAMC,WAAW;AAEjB,MAAMC,eAAe,CAAC/sB;IAClB,MAAMgtB,UAAUhtB,MAAMuU,OAAO,CAAC,OAAO,QAAQA,OAAO,CAAC,MAAM;IAC3D,OAAO,CAAC,CAAC,EAAEyY,QAAQ,CAAC,CAAC;AACzB;AAEA,MAAMC,aAAa,CAACjtB;IAChB,MAAMktB,MAAM,CAAC1G,QAAkBA,MAAMhgB,QAAQ,GAAG2mB,QAAQ,CAAC,GAAG;IAC5D,MAAMC,OAAOptB,MAAMqtB,WAAW;IAC9B,MAAMC,QAAQJ,IAAIltB,MAAMutB,QAAQ,KAAK;IACrC,MAAMC,MAAMN,IAAIltB,MAAMytB,OAAO;IAC7B,MAAMC,QAAQR,IAAIltB,MAAM2tB,QAAQ;IAChC,MAAMC,UAAUV,IAAIltB,MAAM6tB,UAAU;IACpC,MAAMC,UAAUZ,IAAIltB,MAAM+tB,UAAU;IAEpC,OAAO,CAAC,CAAC,EAAEX,KAAK,CAAC,EAAEE,MAAM,CAAC,EAAEE,IAAI,CAAC,EAAEE,MAAM,CAAC,EAAEE,QAAQ,CAAC,EAAEE,QAAQ,CAAC,CAAC;AACrE;AAEA,MAAME,kBAAkB,CAAChuB;IACrB,IAAIiuB,MAAMjuB,QAAQ;QACd,OAAOA,MAAMA,KAAK;IACtB;IAEA,IAAIA,UAAU,QAAQA,UAAU+C,WAAW;QACvC,OAAO;IACX;IAEA,IAAI/C,iBAAiBqQ,MAAM;QACvB,OAAO4c,WAAWjtB;IACtB;IAEA,OAAQ,OAAOA;QACX,KAAK;QACL,KAAK;YACD,OAAO,GAAGA,OAAO;QACrB,KAAK;YACD,OAAOA,QAAQ,MAAM;QACzB;YACI,OAAO+sB,aAAahrB,OAAO/B;IACnC;AACJ;AAEA,MAAMkuB,mBAAmB,CAACC;IACtB,IAAIF,MAAME,aAAa;QACnB,OAAOA,WAAWnuB,KAAK;IAC3B;IAEA,OAAOmuB,WACFvU,KAAK,CAAC,KACNhZ,GAAG,CAACkZ,CAAAA;QACD,IAAIA,SAAS,KAAK;YACd,OAAO;QACX;QACA,OAAO,CAAC,EAAE,EAAEA,KAAKvF,OAAO,CAAC,MAAM,MAAM,EAAE,CAAC;IAC5C,GACCwF,IAAI,CAAC;AACd;AAEA,MAAMqU,cAAc,CAACpuB;IACjB,IAAIiuB,MAAMjuB,QAAQ;QACd,OAAOA,MAAMA,KAAK;IACtB;IAEA,IAAIG,MAAMC,OAAO,CAACJ,QAAQ;QACtB,MAAMquB,OAAOruB,MAAMY,GAAG,CAAC0D,CAAAA,OAAQ8pB,YAAY9pB;QAC3C,OAAO,CAAC,CAAC,EAAE+pB,KAAKtU,IAAI,CAAC,MAAM,CAAC,CAAC;IACjC;IAEA,IAAI/Z,SAAS,OAAOA,UAAU,YAAY,CAAEA,CAAAA,iBAAiBqQ,IAAG,GAAI;QAChE,OAAO0c,aAAa3lB,KAAKC,SAAS,CAACrH;IACvC;IAEA,OAAOguB,gBAAgBhuB;AAC3B;AAEA,MAAMiuB,QAAQ,CAACjuB,QAAoCsuB,QAAQtuB,SAAS,OAAOA,UAAU,YAAY8sB,YAAa9sB;AAE9G,MAAM4T,SAAS,CAAC6F,KAAayR;IACzB,IAAI,CAACA,UAAUA,OAAOtmB,MAAM,KAAK,GAAG;QAChC,OAAO6U;IACX;IAEA,IAAInT,QAAQ;IAEZ,OAAOmT,IAAIlF,OAAO,CAAC,YAAYhQ,CAAAA;QAC3B,IAAI+B,SAAS4kB,OAAOtmB,MAAM,EAAE;YACxB,OAAOL;QACX;QAEA,MAAMvE,QAAQkrB,MAAM,CAAC5kB,QAAQ;QAE7B,IAAI/B,gBAAgB,MAAM;YACtB,IAAIpE,MAAMC,OAAO,CAACJ,QAAQ;gBACtB,OAAOA,MAAMY,GAAG,CAACqB,CAAAA,IAAKisB,iBAAiBjsB,IAAI8X,IAAI,CAAC;YACpD;YACA,OAAOmU,iBAAiBluB;QAC5B;QAEA,OAAOouB,YAAYpuB;IACvB;AACJ;AAEA,MAAM8T,MAAM,CAAC9T,QAA2B;QACpCuuB,OAAO;QACPvuB;IACJ;AAEA,MAAMwuB,YAAY;IACd5a;IACAE;AACJ;AAEA,wDAAe0a,SAASA,EAAC;;;ACxHlB,wCAAKC;;;;;;;;;;WAAAA;MAUX;AAEM,MAAMC,4BAA4B,CAACC;IACtC,IAAIA,SAAS9M,UAAU,CAAC,SAAS;QAC7B;IACJ,OAAO,IAAI8M,SAAS9M,UAAU,CAAC,UAAU;QACrC;IACJ,OAAO,IAAI8M,SAAS9M,UAAU,CAAC,QAAQ;QACnC;IACJ,OAAO,IAAI8M,SAAS9M,UAAU,CAAC,UAAU;QACrC;IACJ,OAAO,IACH8M,SAAS9M,UAAU,CAAC,UACpB8M,SAAS9M,UAAU,CAAC,WACpB8M,SAAS9M,UAAU,CAAC,YACpB,uCAAuC;IACvC8M,SAAS9M,UAAU,CAAC,mBACpB8M,SAAS9M,UAAU,CAAC,oBACpB8M,SAAS9M,UAAU,CAAC,mBACtB;QACE;IACJ,OAAO,IACH8M,SAAS9M,UAAU,CAAC,aACpB8M,SAAS9M,UAAU,CAAC,kBACpB8M,SAAS9M,UAAU,CAAC,WACpB8M,SAAS9M,UAAU,CAAC,WACpB8M,SAAS9M,UAAU,CAAC,WACpB8M,SAAS9M,UAAU,CAAC,SACtB;QACE;IACJ,OAAO,IAAI8M,aAAa,QAAQ;QAC5B;IACJ,OAAO,IAAIA,SAAS9M,UAAU,CAAC,SAAS;QACpC;IACJ,OAAO,IAAI8M,SAAS9M,UAAU,CAAC,YAAY;QACvC;IACJ,OAAO,IAAI8M,SAAS9M,UAAU,CAAC,mBAAmB;QAC9C,OAAO6M,0BAA0BC,SAAS9U,KAAK,CAAC,IAAI,CAAC;IACzD;IAEA,OAAO;AACX,EAAE;AAEK,MAAM+U,iCAAiC,CAACD;IAC3C,MAAME,SAASH,0BAA0BC;IAEzC,IAAIE,oBAA6BA,sBAA+BA,oBAA6B;QACzF,MAAM,IAAIC,MAAM;IACpB,OAAO,IAAID,mBAA4B;QACnC;IACJ;IAEA,OAAOA;AACX,EAAE;;;AC/DF,+DAA+D;AACxD,SAASE,wBAAwBvI,KAAa;IACjD,IAAIwI,aAAa;IACjB,IAAIC,cAAc;IAClB,IAAIC,gBAAgB;IACpB,IAAIC,gBAAgB;IAEpB,MAAM3lB,MAAgB,EAAE;IACxB,IAAI4lB,MAAM;IACV,KAAK,MAAMC,KAAK7I,QAAQ,IAAK;QACzB,IAAI6I,MAAM,OAAO,CAACH,eAAe;YAC7BC,gBAAgB,CAACA;YACjBC,OAAOC;YACP;QACJ;QAEA,IAAIA,MAAM,OAAO,CAACF,eAAe;YAC7BD,gBAAgB,CAACA;YACjBE,OAAOC;YACP;QACJ;QACA,yCAAyC;QACzC,IAAI,CAACH,iBAAiB,CAACC,eAAe;YAClC,IAAIE,MAAM,KAAK;gBACXL;YACJ,OAAO,IAAIK,MAAM,KAAK;gBAClBL;YACJ,OAAO,IAAIK,MAAM,KAAK;gBAClBJ;YACJ,OAAO,IAAII,MAAM,KAAK;gBAClBJ;YACJ;QACJ;QAEA,IAAII,MAAM,OAAOL,eAAe,KAAKC,gBAAgB,KAAK,CAACC,iBAAiB,CAACC,eAAe;YACxF,MAAMG,aAAaF,IAAIzN,IAAI;YAC3B,IAAI2N,YAAY;gBACZ9lB,IAAIoH,IAAI,CAAC0e;YACb;;YACAF,MAAM;QACV,OAAO;YACHA,OAAOC;QACX;IACJ;IACA,OAAO7lB;AACX;;;AC7CA,yDAAyD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEb;AACyD;AAChC;AACnB;AAC0B;AA4CrE,MAAMkmB,6BAAiBA;IAClBC,eAAe9vB,KAAa,EAAE;QAClC,IAAIA,UAAU+sB,gBAAgB;YAC1B,OAAO;QACX;QAEA,OAAO,CAAC,CAAC,EAAE/sB,MAAM,CAAC,CAAC;IACvB;IAEAI,SAASuB,EAAmB,EAAE;QAC1B,OAAQA;YACJ,KAAK;YACL,KAAK;gBACD,OAAO;YACX,KAAK;gBACD,OAAO;YACX,mDAAmD;YACnD,KAAK;YACL,KAAK;YACL,KAAK;gBACD,OAAO;YACX,mDAAmD;YACnD,KAAK;YACL,KAAK;gBACD,OAAO;YACX;gBACI,MAAM,IAAIstB,MAAM,CAAC,qBAAqB,EAAEttB,IAAI;QACpD;IACJ;IAEMouB,GAAG/vB,KAAa,EAAEgwB,IAAY,EAAEC,cAAuB;;YACzD,OAAO,GAAG,IAAI,CAACH,cAAc,CAAC9vB,OAAO,CAAC,EAAEiwB,iBAAiB,WAAW,KAAK,CAAC,EAAED,MAAM;QACtF;;IAEME,UAAUlwB,KAAa,EAAEiwB,cAAuB;;YAClD,OAAO,GAAG,IAAI,CAACH,cAAc,CAAC9vB,OAAO,CAAC,EAAEiwB,iBAAiB,YAAY,eAAe;QACxF;;IAEME,IAAInwB,KAAa,EAAEgwB,IAAY;;YACjC,OAAO,GAAG,IAAI,CAACF,cAAc,CAAC9vB,OAAO,6BAA6B,EAAEgwB,MAAM;QAC9E;;IAEMI,IAAIpwB,KAAa,EAAEgwB,IAAY;;YACjC,OAAO,GAAG,IAAI,CAACF,cAAc,CAAC9vB,OAAO,0BAA0B,EAAEgwB,MAAM;QAC3E;;IAEMK,GAAGrwB,KAAa,EAAEgwB,IAAY;;YAChC,OAAO,GAAG,IAAI,CAACF,cAAc,CAAC9vB,OAAO,cAAc,EAAEgwB,MAAM;QAC/D;;IAEMM,GAAGtwB,KAAa,EAAEgwB,IAAY;;YAChC,OAAO,GAAG,IAAI,CAACF,cAAc,CAAC9vB,OAAO,iBAAiB,EAAEgwB,MAAM;QAClE;;IAEMO,YACFvwB,KAAa,EACbgwB,IAAY,EACZC,cAAuB,EACvBO,cAAuB,EACvBC,cAAuB,EACvBC,QAAiB;;YAEjB,IAAI1wB,UAAU+sB,gBAAgB;gBAC1B,OAAO,GAAG,IAAI,CAAC+C,cAAc,CAAC9vB,OAAO,CAAC,EAClCwwB,kBAAkBC,iBACZR,iBACI,qBACA,aACJO,iBACEP,iBACI,sBACA,cACJQ,iBACER,iBACI,wBACA,gBACJA,iBACE,6BACA,iBACf,CAAC,EAAED,MAAM;YACd;YAEA,OAAO,GAAG,IAAI,CAACF,cAAc,CAAC9vB,OAAO,CAAC,EAAEiwB,iBAAiB,qBAAqB,WAAW,CAAC,EAAED,MAAM;QACtG;;IAEMW,MAAM3wB,KAAa,EAAEqsB,KAAa,EAAEE,GAAW,EAAE0D,cAAuB;;YAC1E,OAAO,GAAGjwB,MAAM,CAAC,EAAEiwB,iBAAiB,WAAW,KAAK,SAAS,EAAE5D,MAAM,KAAK,EAAEE,KAAK;QACrF;;AACJ;AAEO,MAAeqE;IAalBxwB,SAASuB,EAAmB,EAAE;QAC1B,OAAQA;YACJ,KAAK;YACL,KAAK;gBACD,OAAO;YACX,KAAK;gBACD,OAAO;YACX,mDAAmD;YACnD,KAAK;YACL,KAAK;YACL,KAAK;gBACD,OAAO;YACX,mDAAmD;YACnD,KAAK;YACL,KAAK;gBACD,OAAO;YACX;gBACI,MAAM,IAAIstB,MAAM,CAAC,qBAAqB,EAAEttB,IAAI;QACpD;IACJ;IAEMouB,GAAG/vB,KAAa,EAAEgwB,IAAY,EAAEC,cAAuB;;YACzD,MAAM,EAAE/Z,MAAM,EAAE2a,UAAU,EAAEC,KAAK,EAAEC,YAAY,EAAEC,kBAAkB,EAAEC,YAAY,EAAE,GAC/E,MAAM,IAAI,CAACC,iBAAiB,CAAClxB;YACjC,IAAI,CAAC8wB,OAAO;gBACR,OAAO,IAAI,CAACK,eAAe;YAC/B;YACA,IAAIJ,iBAAiBnC,UAAUA,CAACwC,IAAI,EAAE;gBAClC,MAAMC,WAAW,GAAGrB,MAAM,CAAClO,IAAI,GAAGzf,WAAW;gBAC7C,OAAOssB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,IAAI,EAAEkc,iBAAiB,MAAM,GAAG,IAAI,CAAC,EAAE;oBAC5D/Z;oBACAmb,aAAa,SAAS,IAAIA,aAAa,UAAU,IAAIC,SAASD,UAAU;iBAC3E;YACL,OAAO,IAAIN,iBAAiBnC,UAAUA,CAAC7I,MAAM,EAAE;gBAC3C,OAAO4I,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAEmC,OAAO,CAAC,EAAE+Z,iBAAiB,MAAM,GAAG,qBAAqB,CAAC,EAAE;oBAACD;iBAAK;YAClG,OAAO,IAAIe,iBAAiBnC,UAAUA,CAACrnB,IAAI,EAAE;gBACzC,OAAOonB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAE8c,uBAAAA,iCAAAA,WAAYU,MAAM,CAAC,CAAC,EAAEtB,iBAAiB,MAAM,GAAG,IAAI,CAAC,EAAE;oBAACD;iBAAK;YAC7F,OAAO,IAAIe,iBAAiBnC,UAAUA,CAAC1sB,MAAM,IAAI8uB,oBAAoB;gBACjE,MAAMQ,eAAetb,UAAUA,OAAOnR,MAAM,GAAG,IAAImR,SAAS+a;gBAC5D,IAAI,CAACO,cAAc;oBACf,OAAO,IAAI,CAACL,eAAe;gBAC/B;gBACA,OAAOxC,iBAASA,CAAC5a,MAAM,CAAC,CAAC,GAAG,EAAEkc,iBAAiB,SAAS,GAAG,eAAe,CAAC,EAAE;oBACzEtB,iBAASA,CAAC1a,GAAG,CAACud;oBACdxB;iBACH;YACL;YACA,OAAOrB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAEmC,OAAO,CAAC,EAAE+Z,iBAAiB,MAAM,GAAG,IAAI,CAAC,EAAE;gBAACD;aAAK;QACjF;;IAEME,UAAUlwB,KAAa,EAAEiwB,cAAuB;;YAClD,MAAM,EAAE/Z,MAAM,EAAE2a,UAAU,EAAEC,KAAK,EAAEC,YAAY,EAAE,GAAG,MAAM,IAAI,CAACG,iBAAiB,CAAClxB;YACjF,IAAI,CAAC8wB,OAAO;gBACR,OAAO,IAAI,CAACK,eAAe;YAC/B;YACA,IAAIJ,iBAAiBnC,UAAUA,CAACrnB,IAAI,EAAE;gBAClC,OAAO,CAAC,SAAS,EAAEspB,uBAAAA,iCAAAA,WAAYU,MAAM,CAAC,EAAE,EAAEtB,iBAAiB,MAAM,GAAG,GAAG,CAAC;YAC5E;YACA,OAAO,CAAC,SAAS,EAAE/Z,OAAO,EAAE,EAAE+Z,iBAAiB,MAAM,GAAG,GAAG,CAAC;QAChE;;IAEME,IAAInwB,KAAa,EAAEgwB,IAAY;;YACjC,MAAM,EAAE9Z,MAAM,EAAE2a,UAAU,EAAEC,KAAK,EAAEC,YAAY,EAAE,GAAG,MAAM,IAAI,CAACG,iBAAiB,CAAClxB;YACjF,IAAI,CAAC8wB,OAAO;gBACR,OAAO,IAAI,CAACK,eAAe;YAC/B;YACA,IAAIJ,iBAAiBnC,UAAUA,CAACrnB,IAAI,EAAE;gBAClC,OAAOonB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAE8c,uBAAAA,iCAAAA,WAAYY,MAAM,CAAC,MAAM,CAAC,EAAE;oBAACzB;iBAAK;YAClE;YACA,OAAOrB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAEmC,OAAO,MAAM,CAAC,EAAE;gBAAC8Z;aAAK;QACtD;;IAEMI,IAAIpwB,KAAa,EAAEgwB,IAAY;;YACjC,MAAM,EAAE9Z,MAAM,EAAE2a,UAAU,EAAEC,KAAK,EAAEC,YAAY,EAAE,GAAG,MAAM,IAAI,CAACG,iBAAiB,CAAClxB;YACjF,IAAI,CAAC8wB,OAAO;gBACR,OAAO,IAAI,CAACK,eAAe;YAC/B;YACA,IAAIJ,iBAAiBnC,UAAUA,CAACrnB,IAAI,EAAE;gBAClC,OAAOonB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAE8c,uBAAAA,iCAAAA,WAAYY,MAAM,CAAC,MAAM,CAAC,EAAE;oBAACzB;iBAAK;YAClE;YACA,OAAOrB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAEmC,OAAO,MAAM,CAAC,EAAE;gBAAC8Z;aAAK;QACtD;;IAEMK,GAAGrwB,KAAa,EAAEgwB,IAAY;;YAChC,MAAM,EAAE9Z,MAAM,EAAE2a,UAAU,EAAEC,KAAK,EAAEC,YAAY,EAAE,GAAG,MAAM,IAAI,CAACG,iBAAiB,CAAClxB;YACjF,IAAI,CAAC8wB,OAAO;gBACR,OAAO,IAAI,CAACK,eAAe;YAC/B;YACA,IAAIJ,iBAAiBnC,UAAUA,CAACrnB,IAAI,EAAE;gBAClC,OAAOonB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAE8c,uBAAAA,iCAAAA,WAAYY,MAAM,CAAC,KAAK,CAAC,EAAE;oBAACzB;iBAAK;YACjE;YACA,OAAOrB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAEmC,OAAO,KAAK,CAAC,EAAE;gBAAC8Z;aAAK;QACrD;;IAEMM,GAAGtwB,KAAa,EAAEgwB,IAAY;;YAChC,MAAM,EAAE9Z,MAAM,EAAE2a,UAAU,EAAEC,KAAK,EAAEC,YAAY,EAAE,GAAG,MAAM,IAAI,CAACG,iBAAiB,CAAClxB;YACjF,IAAI,CAAC8wB,OAAO;gBACR,OAAO,IAAI,CAACK,eAAe;YAC/B;YACA,IAAIJ,iBAAiBnC,UAAUA,CAACrnB,IAAI,EAAE;gBAClC,OAAOonB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAE8c,uBAAAA,iCAAAA,WAAYY,MAAM,CAAC,KAAK,CAAC,EAAE;oBAACzB;iBAAK;YACjE;YACA,OAAOrB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAEmC,OAAO,KAAK,CAAC,EAAE;gBAAC8Z;aAAK;QACrD;;IAEQ0B,qBAAqB1B,IAAY,EAAmB;QACxD,MAAMyB,SAAS1L,OAAO4L,UAAU,CAAC3B;QACjC,IAAIjK,OAAO/iB,KAAK,CAACyuB,SAAS;YACtB,OAAOzB;QACX;QACA,OAAOyB;IACX;IAEQG,aAAa5B,IAAY,EAAY;QACzC,OAAOA,KAAKjW,KAAK,CAAC,yBAAyBhY,MAAM,CAACY,CAAAA,IAAKA,EAAEoC,MAAM,GAAG;IACtE;IAEQ8sB,kBAAkB7B,IAAY,EAAW;QAC7C,OAAOA,KAAK8B,KAAK,CAAC,4BAA4B;IAClD;IAEMvB,YACFvwB,KAAa,EACbgwB,IAAY,EACZC,cAAuB,EACvBO,cAAuB,EACvBC,cAAuB,EACvBC,QAAiB;;YAEjB,MAAMqB,kBAAkB/xB,UAAU+sB,wBAAcA;YAChD,MAAM,EAAE7W,MAAM,EAAE4a,KAAK,EAAEC,YAAY,EAAEC,kBAAkB,EAAEC,YAAY,EAAEe,eAAe,EAAE,GACpF,MAAM,IAAI,CAACd,iBAAiB,CAAClxB;YACjC,IAAI,CAAC8wB,OAAO;gBACR,OAAO,IAAI,CAACK,eAAe;YAC/B;YAEA,IAAIJ,iBAAiBnC,UAAUA,CAACwC,IAAI,EAAE;gBAClC,MAAMC,WAAW,GAAGrB,MAAM,CAAClO,IAAI,GAAGzf,WAAW;gBAC7C,OAAOssB,iBAASA,CAAC5a,MAAM,CAAC,CAAC,IAAI,EAAEkc,iBAAiB,MAAM,GAAG,IAAI,CAAC,EAAE;oBAC5D/Z;oBACAmb,aAAa,SAAS,IAAIA,aAAa,UAAU,IAAIC,SAASD,UAAU;iBAC3E;YACL,OAAO,IAAIN,iBAAiBnC,UAAUA,CAAC7I,MAAM,EAAE;gBAC3C,OAAO4I,iBAASA,CAAC5a,MAAM,CAAC,CAAC,IAAI,EAAEkc,iBAAiB,MAAM,GAAG,qBAAqB,CAAC,EAAE;oBAAC/Z;oBAAQ8Z;iBAAK;YACnG,OAAO,IAAIe,iBAAiBnC,UAAUA,CAACrnB,IAAI,IAAIypB,uBAAuB,OAAO;gBACzE,OAAO,IAAI,CAACG,eAAe;YAC/B;YAEA,IAAInB,KAAKjrB,MAAM,KAAK,GAAG;gBACnB,OAAO;YACX;YAEA,IAAIgtB,iBAAiB;gBACjB,IAAIC,mBAAmBA,gBAAgBjtB,MAAM,GAAG,GAAG;oBAC/C,MAAMktB,kBAAkB,CAACvB,YAAYD,kBAAkB,CAACD;oBACxD,MAAM0B,YAAYxB,WACZV,OACAiC,kBACIjC,OACA,GAAGQ,iBAAiB,MAAM,KAAKR,OAAOS,iBAAiB,MAAM,IAAI;oBAC3E,MAAM0B,UAAUH,gBACXjxB,GAAG,CAAC6M,CAAAA;wBACD,IAAI,CAACA,QAAQ;4BACT,OAAO;wBACX;wBAEA,IACI8iB,YACA9iB,OAAOmjB,YAAY,KAAKnC,UAAUA,CAAC1sB,MAAM,IACzC0L,OAAOmjB,YAAY,KAAKnC,UAAUA,CAACrnB,IAAI,EACzC;4BACE,OAAO;wBACX;wBAEA,IACI,CAACqG,OAAOmjB,YAAY,KAAKnC,UAAUA,CAAC1sB,MAAM,IAAI0L,OAAOmjB,YAAY,KAAKnC,UAAUA,CAACrnB,IAAI,KACrFqG,OAAOojB,kBAAkB,EAC3B;gCACqBpjB;4BAAnB,MAAM0gB,aAAa1gB,CAAAA,uBAAAA,OAAOqjB,YAAY,cAAnBrjB,kCAAAA,uBAAuBA,OAAOsI,MAAM;4BACvD,IAAI,CAACoY,YAAY;gCACb,OAAO;4BACX;4BACA,MAAMluB,WAAWswB,WACX,iBACAuB,kBACI,wBACA;4BACV,OAAOtD,iBAASA,CAAC5a,MAAM,CAAC,CAAC,IAAI,EAAE3T,SAAS,GAAG,CAAC,EAAE;gCAACkuB;gCAAY4D;6BAAU;wBACzE;wBAEA,IAAItkB,OAAOmjB,YAAY,KAAKnC,UAAUA,CAAC7I,MAAM,EAAE;gCACxBnY;4BAAnB,MAAM0gB,aAAa1gB,CAAAA,wBAAAA,OAAOqjB,YAAY,cAAnBrjB,mCAAAA,wBAAuBA,OAAOsI,MAAM;4BACvD,IAAI,CAACoY,YAAY;gCACb,OAAO;4BACX;4BACA,OAAOK,iBAASA,CAAC5a,MAAM,CAAC,CAAC,yBAAyB,CAAC,EAAE;gCAACua;gCAAY0B;6BAAK;wBAC3E;wBAEA,IAAIpiB,OAAOmjB,YAAY,KAAKnC,UAAUA,CAACwC,IAAI,EAAE;gCACtBxjB;4BAAnB,MAAM0gB,aAAa1gB,CAAAA,wBAAAA,OAAOqjB,YAAY,cAAnBrjB,mCAAAA,wBAAuBA,OAAOsI,MAAM;4BACvD,IAAI,CAACoY,YAAY;gCACb,OAAO;4BACX;4BACA,MAAM+C,WAAW,GAAGrB,MAAM,CAAClO,IAAI,GAAGzf,WAAW;4BAC7C,MAAM+vB,YACFf,aAAa,SAAS,IAAIA,aAAa,UAAU,IAAIC,SAASD,UAAU;4BAC5E,OAAO1C,iBAASA,CAAC5a,MAAM,CAAC,CAAC,QAAQ,CAAC,EAAE;gCAACua;gCAAY8D;6BAAU;wBAC/D;wBAEA,OAAO;oBACX,GACCrwB,MAAM,CAAC,CAACswB,SAA6BA,UAAU;oBAEpD,IAAIF,QAAQptB,MAAM,KAAK,GAAG;wBACtB,OAAO,IAAI,CAACosB,eAAe;oBAC/B;oBAEA,MAAMmB,WAAWH,QAAQjY,IAAI,CAAC;oBAC9B,MAAMqY,UAAUJ,QAAQptB,MAAM,KAAK,IAAIotB,OAAO,CAAC,EAAE,GAAG,CAAC,CAAC,EAAEG,SAAS,CAAC,CAAC;oBAEnE,IAAIrC,gBAAgB;wBAChB,OAAO,CAAC,KAAK,EAAEsC,QAAQ,CAAC,CAAC;oBAC7B;oBAEA,OAAOA;gBACX;gBAEA,IAAIrc,QAAQ;oBACR,IAAIsa,kBAAkBC,gBAAgB;wBAClC,OAAO9B,iBAASA,CAAC5a,MAAM,CACnB,CAAC,UAAU,EAAEkc,iBAAiB,SAAS,GAAG,cAAc,CAAC,EACzD;4BACItB,iBAASA,CAAC1a,GAAG,CAACiC,mBAAAA,oBAAAA,SAAU;4BACxB,GAAGsa,iBAAiB,MAAM,KAAKR,OAAOS,iBAAiB,MAAM,IAAI;yBACpE;oBAET,OAAO;wBACH,MAAM+B,gBAAgB,IAAI,CAACX,iBAAiB,CAAC7B;wBAC7C,IAAIwC,eAAe;4BACf,MAAMC,SAAS,IAAI,CAACb,YAAY,CAAC5B;4BACjC,OAAO,CAAC,CAAC,EAAEC,iBAAiB,UAAU,KAAK;mCACpCwC,OAAO1xB,GAAG,CAAC2xB,CAAAA,QACV/D,iBAASA,CAAC5a,MAAM,CAAC,CAAC,4BAA4B,CAAC,EAAE;wCAAC4a,iBAASA,CAAC1a,GAAG,CAACiC,mBAAAA,oBAAAA,SAAU;wCAAKwc;qCAAM;gCAEzF/D,iBAASA,CAAC5a,MAAM,CAAC,CAAC,wBAAwB,CAAC,EAAE;oCAAC4a,iBAASA,CAAC1a,GAAG,CAACiC,mBAAAA,oBAAAA,SAAU;oCAAK,CAAC,CAAC,EAAE8Z,KAAK,CAAC,CAAC;iCAAC;6BAC1F,CAAC9V,IAAI,CAAC,WAAW+V,iBAAiB,MAAM,GAAG,CAAC,CAAC;wBAClD;wBAEA,OAAOtB,iBAASA,CAAC5a,MAAM,CACnB,CAAC,CAAC,EAAEkc,iBAAiB,SAAS,GAAG,6BAA6B,CAAC,EAC/D;4BAACtB,iBAASA,CAAC1a,GAAG,CAACiC,mBAAAA,oBAAAA,SAAU;4BAAK8Z;yBAAK;oBAE3C;gBACJ;gBAEA,OAAO,IAAI,CAACmB,eAAe;YAC/B,OAAO;gBACH,IAAIH,uBAAuB,OAAO;oBAC9B,OAAO,IAAI,CAACG,eAAe;gBAC/B;gBAEA,MAAMK,eAAetb,UAAUA,OAAOnR,MAAM,GAAG,IAAImR,SAAS+a;gBAC5D,IAAI,CAACO,cAAc;oBACf,OAAO,IAAI,CAACL,eAAe;gBAC/B;gBAEA,MAAMc,kBAAkB,CAACvB,YAAYD,kBAAkB,CAACD;gBACxD,MAAM0B,YAAYxB,WACZV,OACAiC,kBACIjC,OACA,GAAGQ,iBAAiB,MAAM,KAAKR,OAAOS,iBAAiB,MAAM,IAAI;gBAC3E,MAAMrwB,WAAWswB,WACX,iBACAuB,kBACI,wBACA;gBACV,OAAOtD,iBAASA,CAAC5a,MAAM,CAAC,CAAC,GAAG,EAAEkc,iBAAiB,SAAS,KAAK7vB,SAAS,GAAG,CAAC,EAAE;oBACxEuuB,iBAASA,CAAC1a,GAAG,CAACud;oBACdU;iBACH;YACL;QACJ;;IAEMvB,MAAM3wB,KAAa,EAAEqsB,KAAa,EAAEE,GAAW,EAAE0D,cAAuB;;YAC1E,MAAM,EAAE/Z,MAAM,EAAE4a,KAAK,EAAE,GAAG,MAAM,IAAI,CAACI,iBAAiB,CAAClxB;YACvD,IAAI,CAAC8wB,OAAO;gBACR,OAAO,IAAI,CAACK,eAAe;YAC/B;YACA,OAAOxC,iBAASA,CAAC5a,MAAM,CAAC,CAAC,CAAC,EAAEmC,OAAO,CAAC,EAAE+Z,iBAAiB,SAAS,GAAG,gBAAgB,CAAC,EAAE;gBAClF,IAAI,CAACyB,oBAAoB,CAACrF;gBAC1B,IAAI,CAACqF,oBAAoB,CAACnF;aAC7B;QACL;;;QAjTA,kCAAQ4E,mBAAkB;;AAkT9B;AAUO,MAAMwB,oCAAoC/B;IA4B/BgC,oBAAoB1c,MAAc;;gBA4B3B;YA3BjB,IAAI,IAAI,CAAC2c,mBAAmB,CAAC5wB,GAAG,CAACiU,SAAS;oBAC/B;gBAAP,OAAO,qCAAI,CAAC2c,mBAAmB,CAACnqB,GAAG,CAACwN,qBAA7B,2EAAwC;YACnD;YAEA,IAAI4c,WAAgC;YAEpC,IAAI;gBACA,MAAM1pB,SAAS,MAAMumB,iCAAiBA,CAAC;oBACnCoD,cAAc,IAAI,CAACA,YAAY;oBAC/Bva,UAAU,IAAI,CAACwa,YAAY;oBAC3Bzd,OAAO,IAAI,CAAC0d,SAAS;oBACrB/c;oBACAgd,gBAAgB,IAAI,CAACA,cAAc;gBACvC;gBAEA,IAAI9pB,QAAQ;oBACR0pB,WAAW;wBACP1uB,MAAMgF,OAAOhF,IAAI;wBACjBxB,MAAMwG,OAAO+pB,cAAc,IAAI/pB,OAAOnB,UAAU,IAAImB,OAAO0lB,QAAQ,IAAI;wBACvEA,UAAU1lB,OAAO0lB,QAAQ;wBACzB7mB,YAAYmB,OAAOnB,UAAU;oBACjC;gBACJ;YACJ,EAAE,OAAOjE,OAAO;YACZ,8EAA8E;YAClF;YAEA,IAAI,CAAC8uB,cAAY,mCAAI,CAACM,sBAAsB,cAA3B,gFAA6B1D,SAAS,GAAE;gBACrD,IAAI;oBACA,MAAM2D,SAAS,MAAM,IAAI,CAACD,sBAAsB,CAAC1D,SAAS,CAAC;wBACvDsD,cAAc,IAAI,CAACA,YAAY;wBAC/BC,WAAW,IAAI,CAACA,SAAS;wBACzB/c;wBACA6c,cAAc,IAAI,CAACA,YAAY;oBACnC;oBAEA,IAAIM,QAAQ;wBACRP,WAAW;4BACP1uB,MAAMivB,OAAOjvB,IAAI;4BACjBxB,MAAMywB,OAAOzwB,IAAI,IAAI;wBACzB;oBACJ;gBACJ,EAAE,OAAO0wB,aAAa;gBAClB,iCAAiC;gBACrC;YACJ;YAEA,IAAI,CAACT,mBAAmB,CAACvrB,GAAG,CAAC4O,QAAQ4c;YACrC,OAAOA;QACX;;IAEcS;;YACV,IAAI,IAAI,CAACC,oBAAoB,EAAE;gBAC3B,OAAO,IAAI,CAACA,oBAAoB;YACpC;YAEA,IAAI,CAAC,IAAI,CAACC,2BAA2B,EAAE;gBACnC,IAAI,CAACA,2BAA2B,GAAG,CAAC;wBAChC,IAAI;4BACA,MAAMre,UAAU,MAAMwa,+CAAuBA,CAAC;gCAC1CmD,cAAc,IAAI,CAACA,YAAY;gCAC/Bva,UAAU,IAAI,CAACwa,YAAY;gCAC3Bzd,OAAO,IAAI,CAAC0d,SAAS;gCACrBC,gBAAgB,IAAI,CAACA,cAAc;4BACvC;4BACA,OAAO,IAAIpxB,IAAIsT,QAAQrU,GAAG,CAACqD,CAAAA,OAAQA,KAAK/B,WAAW;wBACvD,EAAE,OAAO2B,OAAO;4BACZ,OAAO,IAAIlC;wBACf;oBACJ;YACJ;YAEA,MAAMgxB,WAAW,MAAM,IAAI,CAACW,2BAA2B;YACvD,IAAI,CAACD,oBAAoB,GAAGV;YAC5B,OAAOA;QACX;;IAEcY,uBAAuBxd,MAAc;;YAC/C,IAAI,CAACA,QAAQ;gBACT,OAAO;YACX;YAEA,MAAM1W,UAAU,MAAM,IAAI,CAAC+zB,wBAAwB;YACnD,OAAO/zB,QAAQyC,GAAG,CAACiU,OAAO7T,WAAW;QACzC;;IAEcsxB,+BAA+B3zB,KAAa;;YACtD,MAAM4zB,aAAa,MAAM,IAAI,CAAChB,mBAAmB,CAAC5yB;YAElD,IAAI4zB,YAAY;gBACZ,OAAO;oBACH9C,OAAO;oBACP7oB,YAAY2rB,WAAWhxB,IAAI;oBAC3BixB,kBAAkBD,WAAWxvB,IAAI;oBACjC6sB,cAAc2C,WAAWxvB,IAAI;gBACjC;YACJ;YAEA,MAAM0vB,cAAc9zB,MAAM+Z,KAAK,CAAC,IAAI,CAAC,EAAE;YACvC,MAAMga,cAAc,MAAM,IAAI,CAACnB,mBAAmB,CAACkB;YAEnD,IAAIC,aAAa;gBACb,MAAMC,eAAeh0B,MAAM+Z,KAAK,CAAC,KAAKC,KAAK,CAAC,GAAGE,IAAI,CAAC;gBAEpD,IAAI6Z,YAAYnxB,IAAI,CAACof,UAAU,CAAC,QAAQ;wBAClB+R;oBAAlB,MAAME,aAAYF,0BAAAA,YAAYnxB,IAAI,CAACkvB,KAAK,CAAC,6BAAvBiC,8CAAAA,uBAAwC,CAAC,EAAE;oBAC7D,OAAO;wBACHjD,OAAO;wBACP+C,kBAAkBlF,iBAASA,CAAC5a,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE;4BAACggB,YAAY3vB,IAAI;4BAAE4vB;yBAAa;wBAC5E/rB,YAAYgsB,sBAAAA,uBAAAA,YAAa;wBACzBhD,cAAc8C,YAAY3vB,IAAI;oBAClC;gBACJ,OAAO,IAAI2vB,YAAYnxB,IAAI,CAACof,UAAU,CAAC,SAAS;oBAC5C,OAAO;wBACH8O,OAAO;wBACP+C,kBAAkB;wBAClBK,sBAAsB;4BAClB3C,QAAQ5C,iBAASA,CAAC5a,MAAM,CAAC,CAAC,YAAY,CAAC,EAAE;gCAAC/T;6BAAM;4BAChDyxB,QAAQ9C,iBAASA,CAAC5a,MAAM,CAAC,CAAC,6BAA6B,CAAC,EAAE;gCACtD/T;gCACAgtB,6BAA6BA;gCAC7BhtB;6BACH;wBACL;wBACAiI,YAAY;wBACZgpB,cAAc8C,YAAY3vB,IAAI;oBAClC;gBACJ,OAAO,IAAI2vB,YAAYnxB,IAAI,KAAK,UAAU;oBACtC,MAAMuxB,cAAcH,aAAaja,KAAK,CAAC;oBACvC,OAAO;wBACH+W,OAAO;wBACP+C,kBAAkBlF,iBAASA,CAAC5a,MAAM,CAC9B,CAAC,sBAAsB,EAAEzT,MAAM6zB,YAAYpvB,MAAM,EAAE+I,IAAI,CAAC,KAAKoM,IAAI,CAAC,KAAK,CAAC,CAAC,EACzE;4BAAC6Z,YAAY3vB,IAAI;+BAAK+vB;yBAAY;wBAEtClsB,YAAY;wBACZgpB,cAAc8C,YAAY3vB,IAAI;oBAClC;gBACJ;gBAEA,MAAM,IAAI6qB,MAAM;YACpB;YAEA,OAAO;gBACH6B,OAAO;gBACP+C,kBAAkB7zB;gBAClBiI,YAAY;gBACZgpB,cAAcjxB;YAClB;QACJ;;IAEMkxB,kBAAkBlxB,KAAa;;YACjC,IAAIA,UAAU+sB,wBAAcA,EAAE;gBAC1B,IAAI,CAAC,IAAI,CAACqH,wBAAwB,EAAE;oBAChC,MAAM,IAAInF,MAAM;gBACpB;gBAEA,MAAMoF,cAAcnF,uBAAuBA,CAAC,IAAI,CAACkF,wBAAwB;gBACzE,MAAME,0BAA0Bh0B,MAAMwT,IAAI,CACtC,IAAIhS,IACAuyB,YACKxb,MAAM,CAAW,CAAC0b,KAAKC;oBACpBD,IAAIxjB,IAAI,IAAI,IAAI,CAAC0jB,+BAA+B,CAACD;oBACjD,OAAOD;gBACX,GAAG,EAAE,EACJxyB,MAAM,CAAC,CAACqC,OAAyB,CAAC,CAACA;gBAIhD,MAAM4tB,kBAAyB,CAC3B,MAAMrR,QAAQC,GAAG,CACb0T,wBAAwBvzB,GAAG,CAAC,CAAM2zB,YAAAA,8BAAAA;wBAC9B,IAAI;4BACA,MAAMC,sBAAsB,MAAM,IAAI,CAAChB,8BAA8B,CAACe;gCAElE3F;4BADJ,MAAM6F,wBACF7F,CAAAA,kCAAAA,8BAA8BA,CAAC4F,oBAAoB1sB,UAAU,eAA7D8mB,6CAAAA,kCAAkE7rB;4BAEtE,IAAI2xB;4BACJ,IACI,CAACD,0BAA0BhG,UAAUA,CAAC1sB,MAAM,IACxC0yB,0BAA0BhG,UAAUA,CAACrnB,IAAI,KAC7CotB,oBAAoB1D,YAAY,IAChC0D,oBAAoBd,gBAAgB,KAAKc,oBAAoB1D,YAAY,EAC3E;gCACE4D,8BAA8B,MAAM,IAAI,CAACnB,sBAAsB,CAC3DiB,oBAAoB1D,YAAY;4BAExC,OAAO,IACH2D,0BAA0BhG,UAAUA,CAAC1sB,MAAM,IAC3C0yB,0BAA0BhG,UAAUA,CAACrnB,IAAI,EAC3C;gCACEstB,8BAA8B;4BAClC;gCAIkBF;4BAFlB,OAAO;gCACHze,QAAQye,oBAAoBd,gBAAgB;gCAC5C5C,cAAc0D,CAAAA,oCAAAA,oBAAoB1D,YAAY,cAAhC0D,+CAAAA,oCAAoCD;gCAClD3D,cAAc6D;gCACd5D,oBAAoB6D;4BACxB;wBACJ,EAAE,OAAO7wB,OAAO;4BACZ,OAAO;wBACX;oBACJ,eACJ,EACFjC,MAAM,CAAC,CAAC6L,SAAWA,WAAW;gBAEhC,OAAO;oBACHsI,QACIme,YAAYtvB,MAAM,GAAG,IACf,CAAC,wBAAwB,EAAEsvB,YAAYna,IAAI,CAAC,KAAK,CAAC,CAAC,GACnD,IAAI,CAACka,wBAAwB;oBACvCvD,YAAY3tB;oBACZ6tB,cAAcnC,UAAUA,CAAC1sB,MAAM;oBAC/B8uB,oBAAoB9tB;oBACpB+tB,cAAc/tB;oBACd8uB;oBACAlB,OAAO;gBACX;YACJ;YAEA,MAAM0D,aAAa,MAAM,IAAI,CAACb,8BAA8B,CAAC3zB;gBACxC+uB;YAArB,MAAMgC,eAAehC,CAAAA,kCAAAA,8BAA8BA,CAACyF,WAAWvsB,UAAU,eAApD8mB,6CAAAA,kCAAyD7rB;YAE9E,IAAI8tB;YACJ,IACI,CAACD,iBAAiBnC,UAAUA,CAAC1sB,MAAM,IAAI6uB,iBAAiBnC,UAAUA,CAACrnB,IAAI,KACvEitB,WAAWvD,YAAY,IACvBuD,WAAWX,gBAAgB,KAAKW,WAAWvD,YAAY,EACzD;gBACED,qBAAqB,MAAM,IAAI,CAAC0C,sBAAsB,CAACc,WAAWvD,YAAY;YAClF,OAAO,IAAIF,iBAAiBnC,UAAUA,CAAC1sB,MAAM,IAAI6uB,iBAAiBnC,UAAUA,CAACrnB,IAAI,EAAE;gBAC/EypB,qBAAqB;YACzB;YAEA,OAAO;gBACH9a,QAAQse,WAAWX,gBAAgB;gBACnChD,UAAU,EAAE2D,uBAAAA,iCAAAA,WAAYN,oBAAoB;gBAC5CnD;gBACAC;gBACAC,cAAcuD,WAAWvD,YAAY;gBACrCe,iBAAiB9uB;gBACjB4tB,OAAO0D,WAAW1D,KAAK;YAC3B;QACJ;;IAEQ2D,gCAAgCD,UAAkB,EAAY;QAClE,MAAMM,UAAUN,WAAW1C,KAAK,CAAC;QACjC,IAAI,CAACgD,SAAS;YACV,OAAO,EAAE;QACb;QACA,OAAOA,QAAQ/zB,GAAG,CAAC+wB,CAAAA,QAASA,MAAM9X,KAAK,CAAC,GAAG,CAAC;IAChD;IA9QA,YAAY,EACR+a,QAAQ,EACR/B,YAAY,EACZC,SAAS,EACTF,YAAY,EACZqB,wBAAwB,EACxBlB,cAAc,EAC2C,CAAE;QAC3D,KAAK,IAlBT,kCAAQD,aAAR,SACA,kCAAQD,gBAAR,SACA,kCAAQoB,4BAAR,SACA,kCAAQrB,gBAAR,SACA,kCAAQG,kBAAR,SACA,kCAAQE,0BAAR,SACA,kCAAQP,uBAAsB,IAAI5pB,QAClC,kCAAQuqB,wBAAR,SACA,kCAAQC,+BAAR;QAWI,IAAI,CAACL,sBAAsB,GAAG2B;QAC9B,IAAI,CAAC/B,YAAY,GAAGA;QACpB,IAAI,CAACC,SAAS,GAAGA;QACjB,IAAI,CAACmB,wBAAwB,GAAGA;QAChC,IAAI,CAACrB,YAAY,GAAGA;QACpB,IAAI,CAACG,cAAc,GAAGA;IAC1B;AAgQJ;;;ACnuBA,yDAAyD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACpB;AACmC;AAC3B;AACiB;AAEvD,SAASnR,SAAKA,CAAC8K,KAAa;IAC/B,OAAOmI,YAAY,CAACpI,mBAAmBA,CAACC;AAC5C;AAEA,SAAeoI,SAASC,IAAiB,EAAEC,UAAsB;;QAC7D,MAAMn1B,QAAQk1B,KAAKl1B,KAAK,CAAC,EAAE,KAAK,MAAMk1B,KAAKl1B,KAAK,CAACga,KAAK,CAAC,KAAKkb,KAAKl1B,KAAK;QACtE,IAAIiwB,iBAAiBiF,KAAKl1B,KAAK,CAAC,EAAE,KAAK;QACvC,MAAM+xB,kBAAkBmD,KAAKl1B,KAAK,KAAK+sB,wBAAcA;QAErD,IAAI,KAA0BiD,IAAI,IAAI,MAAM;YACxC,MAAMoF,mBAAmBF;YACzB,IAAIlF,OAAOlD,mBAAmBA,CAACsI,iBAAiBpF,IAAI;YACpD,IAAI+B,mBAAmBqD,iBAAiBC,MAAM,KAAK,KAAK;gBACpDpF,iBAAiB;YACrB;YACA,IAAI,CAAC8B,mBAAmBqD,iBAAiBC,MAAM,KAAK,KAAK;gBACrDrF,OAAOoF,iBAAiBC,MAAM,GAAGvI,mBAAmBA,CAACsI,iBAAiBpF,IAAI;YAC9E;YAEA,IAAIoF,iBAAiBE,MAAM,IAAI,CAACvD,iBAAiB;gBAC7C,OAAOoD,WAAWpF,EAAE,CAAC/vB,OAAOgwB,MAAMC;YACtC;YAEA,IAAI,CAACmF,iBAAiBE,MAAM,IAAItF,SAAS,KAAK;gBAC1C,OAAOmF,WAAWjF,SAAS,CAAClwB,OAAOiwB;YACvC;YAEA,IAAI,CAACmF,iBAAiBE,MAAM,IAAItF,KAAKuF,SAAS,CAAC,GAAG,OAAO,MAAM;gBAC3D,IAAItF,gBAAgB;oBAChB,OAAOkF,WAAW9E,EAAE,CAACrwB,OAAOgwB,KAAKhW,KAAK,CAAC;gBAC3C;gBACA,OAAOmb,WAAWhF,GAAG,CAACnwB,OAAOgwB,KAAKhW,KAAK,CAAC;YAC5C;YACA,IAAI,CAACob,iBAAiBE,MAAM,IAAItF,KAAKuF,SAAS,CAAC,GAAG,OAAO,MAAM;gBAC3D,IAAItF,gBAAgB;oBAChB,OAAOkF,WAAW7E,EAAE,CAACtwB,OAAOgwB,KAAKhW,KAAK,CAAC;gBAC3C;gBACA,OAAOmb,WAAW/E,GAAG,CAACpwB,OAAOgwB,KAAKhW,KAAK,CAAC;YAC5C;YACA,IAAI,CAACob,iBAAiBE,MAAM,IAAItF,IAAI,CAAC,EAAE,KAAK,KAAK;gBAC7C,IAAIC,gBAAgB;oBAChB,OAAOkF,WAAW/E,GAAG,CAACpwB,OAAOgwB,KAAKhW,KAAK,CAAC;gBAC5C;gBACA,OAAOmb,WAAW7E,EAAE,CAACtwB,OAAOgwB,KAAKhW,KAAK,CAAC;YAC3C;YACA,IAAI,CAACob,iBAAiBE,MAAM,IAAItF,IAAI,CAAC,EAAE,KAAK,KAAK;gBAC7C,IAAIC,gBAAgB;oBAChB,OAAOkF,WAAWhF,GAAG,CAACnwB,OAAOgwB,KAAKhW,KAAK,CAAC;gBAC5C;gBACA,OAAOmb,WAAW9E,EAAE,CAACrwB,OAAOgwB,KAAKhW,KAAK,CAAC;YAC3C;YAEA,IAAIwW,iBAAiB;YACrB,IAAIC,iBAAiB;YACrB,IAAI,CAAC2E,iBAAiBE,MAAM,IAAItF,IAAI,CAAC,EAAE,KAAK,KAAK;gBAC7CQ,iBAAiB;gBACjBR,OAAOA,KAAKhW,KAAK,CAAC;YACtB;YACA,IAAI,CAACob,iBAAiBE,MAAM,IAAItF,IAAI,CAACA,KAAKjrB,MAAM,GAAG,EAAE,KAAK,KAAK;gBAC3D0rB,iBAAiB;gBACjBT,OAAOA,KAAKhW,KAAK,CAAC,GAAG,CAAC;YAC1B;YAEA,OAAOmb,WAAW5E,WAAW,CAACvwB,OAAOgwB,MAAMC,gBAAgBO,gBAAgBC,gBAAgB2E,iBAAiBE,MAAM;QACtH;QAEA,IAAI,KAAgCE,SAAS,IAAI,MAAM;YACnD,MAAMC,aAAaP;YACnB,OAAOC,WAAWxE,KAAK,CAAC3wB,OAAOy1B,WAAWC,QAAQ,EAAED,WAAWE,QAAQ,EAAE1F;QAC7E;QAEA,MAAM,IAAIhB,MAAM,CAAC,sBAAsB,EAAEiG,MAAM;IACnD;;AAEA,SAAeU,UAAUC,GAA6B,EAAEV,UAAsB;;QAC1E,IAAI,IAAyBnF,IAAI,IAAI,MAAM;YACvC,OAAO,MAAMiF,SAASY,KAAwBV;QAClD;QACA,IAAI,IAA+BK,SAAS,IAAI,MAAM;YAClD,OAAO,MAAMP,SAASY,KAAwBV;QAClD;QAEA,IAAI,IAA0B7jB,KAAK,IAAI,MAAM;YACzC,MAAMwkB,YAAYD;YAClB,MAAMz1B,WAAW+0B,WAAW/0B,QAAQ,CAAC01B,UAAU11B,QAAQ;YACvD,MAAM21B,gBAAgBD,UAAUC,aAAa;YAC7C,OAAO,GAAGA,gBAAgB,MAAM,KAAK,MAAMH,UAAUE,UAAU3kB,IAAI,EAAEgkB,YAAY,CAAC,EAAE/0B,SAAS,CAAC,EAAE,MAAMw1B,UAClGE,UAAUxkB,KAAK,EACf6jB,cACAY,gBAAgB,MAAM,IAAI;QAClC;QAEA,IAAI,IAA4B5kB,IAAI,IAAI,MAAM;YAC1C,MAAM6kB,cAAcH;YACpB,MAAME,gBAAgBC,YAAYD,aAAa;YAC/C,OAAO,GAAGA,gBAAgB,MAAM,KAC5BC,YAAY3J,KAAK,KAAKnpB,YAAY,GAAG8yB,YAAY3J,KAAK,CAAC,CAAC,CAAC,GAAG,KAC7D,MAAMuJ,UAAUI,YAAY7kB,IAAI,EAAEgkB,cAAcY,gBAAgB,MAAM,IAAI;QACjF;QAEA,OAAO;IACX;;AAEO,SAAeE,eAAWA,CAACJ,GAAe,EAAEV,UAAsB;;QACrE,OAAO,MAAMS,UAAUC,KAAKV;IAChC;;AAEO,SAAee,sBAAsBrJ,KAAa;;QACrD,IAAI;YACA,MAAMsJ,UAAUpU,SAAKA,CAAC8K;YAEtB,IAAIsJ,SAAS;gBACT,MAAMhB,aAAa,IAAItF;gBACvB,OAAO,MAAM+F,UAAUO,SAAShB;YACpC;QACJ,EAAE,OAAOryB,GAAG;YACRa,QAAQyyB,IAAI,CAAC,iBAAiBvJ,OAAO/pB;QACzC;QAEA,OAAO,CAAC,mBAAmB,EAAE+pB,OAAO;IACxC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9H2C;AAGuB;AACS;AAEpE,MAAMwJ;IAWTC,cAAcnB,UAAyB,EAAE;QACrC,IAAI,CAACA,UAAU,GAAGA;QAClB,OAAO,IAAI;IACf;IAEAoB,gBAAgB;QACZ,OAAO,IAAI,CAACpB,UAAU;IAC1B;IAEcqB;;YACV,IAAI,CAAC,IAAI,CAACC,OAAO,EAAE;gBACf,OAAO;YACX;YAEA,MAAMN,UAAUpU,MAAM,IAAI,CAAC0U,OAAO;YAElC,OAAO,MAAMR,YAAYE,SAAS,IAAI,CAAChB,UAAU;QACrD;;IAEAuB,IAAIC,SAAiB,EAAE;QACnB,IAAIA,aAAaA,UAAU7U,IAAI,IAAI;YAC/B,IAAI,CAAC8U,UAAU,CAAC7lB,IAAI,CAAC,CAAC,CAAC,EAAE4lB,UAAU,CAAC,CAAC;QACzC;QACA,OAAO,IAAI;IACf;IAEME;;YACF,MAAMC,cAAc,MAAM,IAAI,CAACN,cAAc;YAC7C,IAAI,IAAI,CAACC,OAAO,EAAE;gBACd,IAAI,CAACC,GAAG,CAACI;YACb;YACA,OAAO,IAAI,CAACF,UAAU,CAAC1c,IAAI,CAAC;QAChC;;IAtCA,YAAYuc,OAAe,EAAEtB,UAAyB,CAAE;QAJxD,mCAAiBsB,WAAjB;QACA,mCAAiBG,cAAjB;QACA,mCAAQzB,cAAR;QAGI,IAAI,CAACyB,UAAU,GAAG,EAAE;QACpB,IAAI,CAACH,OAAO,GAAGA;QACf,IAAI,CAACtB,UAAU,GAAGA;IACtB;AAmCJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClDkG;AAW3F,SAAe4B;+CAAqB,EAAElK,KAAK,EAAEmG,YAAY,EAAEC,SAAS,EAAEF,YAAY,EAAEqB,wBAAwB,EAAElB,cAAc,EAAqB;QACpJ,MAAM8D,eAAenK,kBAAAA,4BAAAA,MAAO/K,IAAI;QAChC,IAAI,CAACkV,cAAc;YACf,OAAO;QACX;QAEA,MAAM7B,aAAa,IAAIxC,2BAA2BA,CAAC;YAC/CK;YACAC;YACAF;YACAqB;YACAlB;QACJ;QAEA,IAAI;YACA,MAAM2C,MAAM9T,SAAKA,CAACiV;YAClB,MAAMC,WAAY,MAAMhB,eAAWA,CAACJ,KAAKV;YACzCxxB,QAAQC,GAAG,CAAC;gBACRipB;gBACAoK;YACJ;YACA,OAAOA;QACX,EAAE,OAAOjzB,OAAO;YACZL,QAAQK,KAAK,CAAC,uCAAuCA;YACrD,MAAMA;QACV;IACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrCoC;AACC;AASb;AAC+B;AAEhD,SAASkzB;IACZ,MAAMnP,aAAarqB,8BAAYA,CAACgqB,+BAAcA;IAC9C,MAAM5a,cAAcpP,8BAAYA,CAACiqB,gCAAeA;IAChD,MAAMlK,eAAe/f,8BAAYA,CAACye,iCAAgBA;IAClD,MAAMwB,kBAAkBjgB,8BAAYA,CAAC2e,oCAAmBA;IACxD,MAAM/B,aAAa5c,8BAAYA,CAAC6e,uCAAsBA;IACtD,MAAMrd,cAAcxB,8BAAYA,CAACU,gCAAeA;IAChD,MAAMif,mBAAmB3f,8BAAYA,CAACue,qCAAoBA;IAE1D,OAAOwJ,+BAAWA,CAAC;YACf,IAAIsC,eAAe,UAAU;gBACzB,OAAO;YACX;YAEA,MAAMiP,eAAelqB,wBAAAA,kCAAAA,YAAagV,IAAI;YACtC,IAAI,CAACkV,gBAAgB,CAACvZ,gBAAgB,CAACE,mBAAmB,CAACrD,YAAY;gBACnE,OAAO;YACX;YAEA,MAAM6c,sBAAsB,CAACj4B,eAAe,EAAE,EACzC6B,GAAG,CAAC,CAACf;oBACcA,cAAAA;gBAAhB,MAAMo3B,UAAUp3B,CAAAA,OAAAA,CAAAA,eAAAA,kBAAAA,4BAAAA,MAAO7B,KAAK,cAAZ6B,0BAAAA,eAAgBA,kBAAAA,4BAAAA,MAAOG,KAAK,cAA5BH,kBAAAA,OAAgCA,kBAAAA,4BAAAA,MAAOoE,IAAI;oBACvCpE;gBAApB,MAAM4C,OAAOV,OAAOlC,CAAAA,cAAAA,kBAAAA,4BAAAA,MAAOqB,IAAI,cAAXrB,yBAAAA,cAAe,IAAI6C,WAAW;gBAClD,IAAI,CAACu0B,SAAS;oBACV,OAAO;gBACX;gBAEA,IAAI,CAACx0B,MAAM;oBACP,OAAOw0B;gBACX;gBAEA,OAAO,kCAAkCC,IAAI,CAACz0B,QAAQw0B,UAAU;YACpE,GACCr1B,MAAM,CAAC0sB;YAEZ,MAAM6I,sBAAsBH,oBAAoBnd,KAAK,CAAC,GAAG,IAAIjZ,GAAG,CAACqD,CAAAA,OAAQ,CAAC,WAAW,EAAEA,KAAK,OAAO,CAAC;YAEpG,IAAIgwB;YACJ,IAAIkD,oBAAoBvyB,MAAM,GAAG,GAAG;gBAChCqvB,2BAA2BkD,oBAAoBpd,IAAI,CAAC;YACxD,OAAO,IAAImD,kBAAkB;gBACzB+W,2BAA2B,CAAC,WAAW,EAAE/W,iBAAiB,OAAO,CAAC;YACtE;YAEA,OAAO,MAAM0Z,oBAAoBA,CAAC;gBAC9BlK,OAAOmK;gBACPhE,cAAcrV;gBACdsV,WAAWxV;gBACXsV,cAAczY,WAAWU,GAAG;gBAC5BkY,gBAAgB5Y,WAAW1X,IAAI;gBAC/BwxB;YACJ;QACJ,MAAG;QAACzW;QAAiBF;QAAcJ;QAAkB0K;QAAYjb;QAAawN;QAAYpb;KAAY;AAC1G;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClE+C;AAEW;AAsBlC;AACwG;AACrE;AASvC;AAC+B;AACpB;AAC8C;AACjC;AACkB;AAMvD,SAAS84B;IACZ,MAAM,CAAC7e,MAAM/I,QAAQ,GAAG3S,yBAAOA,CAACqR,yBAAQA;IACxC,MAAM0K,WAAW9b,8BAAYA,CAACmR,6BAAYA;IAC1C,MAAMopB,eAAehqB,4BAAUA,CAAC1P,8BAAaA;IAC7C,MAAM25B,qBAAqBjqB,4BAAUA,CAACU,oCAAmBA;IACzD,MAAM2L,aAAa5c,8BAAYA,CAAC6e,uCAAsBA;IACtD,MAAMc,mBAAmB3f,8BAAYA,CAACue,qCAAoBA;IAC1D,MAAMnM,WAAWpS,8BAAYA,CAACkR,6BAAYA;IAC1C,MAAMupB,iBAAiBz6B,8BAAYA,CAAC8pB,iCAAgBA;IACpD,MAAMtoB,cAAcxB,8BAAYA,CAACU,gCAAeA;IAChD,MAAM2pB,aAAarqB,8BAAYA,CAACgqB,+BAAcA;IAC9C,MAAMvoB,aAAazB,8BAAYA,CAACW,+BAAcA;IAC9C,MAAMyO,cAAcpP,8BAAYA,CAACiqB,gCAAeA;IAChD,MAAMyQ,aAAanqB,4BAAUA,CAACtF,4BAAWA;IACzC,MAAM8U,eAAe/f,8BAAYA,CAACye,iCAAgBA;IAClD,MAAMuB,iBAAiBhgB,8BAAYA,CAAC0e,mCAAkBA;IACtD,MAAMuB,kBAAkBjgB,8BAAYA,CAAC2e,oCAAmBA;IACxD,MAAMpN,cAAcvR,8BAAYA,CAAC8Q,gCAAeA;IAChD,MAAM6pB,qBAAqBpqB,4BAAUA,CAACrF,oCAAmBA;IACzD,MAAM0vB,eAAerqB,4BAAUA,CAACupB,oCAAmBA;IACnD,MAAM,CAACxY,SAASuZ,WAAW,GAAG96B,yBAAOA,CAAC85B,oCAAmBA;IACzD,MAAMiB,yBAAyBtB,oBAAoBA;IAEnD,MAAMuB,eAAehT,+BAAWA,CAAC;gBAWdxW;YAVf,IAAI,CAACwO,gBAAgB,CAACE,mBAAmB,CAACrD,YAAY;gBAClD;YACJ;YACAie,WAAW33B,CAAAA,OAAS,sEAAKA;oBAAM63B,cAAc;;YAC7C,MAAMpgB,mBAAmB0f,0CAAmBA,CAACI,gBAAgBj5B,aAAa4N;YAC1E,MAAMuN,UAAe;gBACjBuF,SAASlC;gBACTlF,UAAUmF;gBACVpI,OAAOkI;gBACP/E,WAAW2E;gBACX1E,SAAS,GAAE1J,gBAAAA,WAAW,CAAC,EAAE,cAAdA,oCAAAA,cAAgB8E,MAAM,CAACzF,6BAAWA;gBAC7CsK,SAAS,WAAY,CAAC,EAAE,CAAW7E,MAAM,CAACzF,6BAAWA;gBACrDuR,SAAS;gBACT/V,MAAM;gBACN2O,aAAasP;gBACbvoB,SAAS;gBACT2Z,MAAMA;gBACND,WAAWM;YACf;YAEA,IAAIuO,eAAe,UAAU;gBACzB1N,QAAQ/B,iBAAiB,GAAGD;YAChC;YACAgC,QAAQjT,YAAY,GAAGjI,WAAW4F,MAAM,GAAG,IAAI5F,aAAa,EAAE;YAE9D,IAAI4oB,eAAe,UAAU;gBACzB,IAAI;oBACA,MAAM2Q,cAAc,MAAMF;oBAC1B,IAAIE,aAAa;wBACbre,QAAQpB,YAAY,GAAGyf;oBAC3B;gBACJ,EAAE,OAAO10B,OAAO;oBACZu0B,WAAW33B,CAAAA,OAAS,sEAAKA;4BAAM63B,cAAc;;oBAC7CR,aAAa,EAAE;oBACft0B,QAAQK,KAAK,CAAC,6BAA6BA;oBAC3C;gBACJ;YACJ;YAEA,IAAI8I,eAAeib,eAAe,UAAU;gBACxC1N,QAAQrB,YAAY,GAAG+O,eAAe,WAAW2P,mCAAYA,CAAC5qB,eAAeA;YACjF;YAEAsN,mBAAmBA,CAAC;gBAChBE;eACGD,UACJ4Q,SAAS,CAAC;gBACTC,MAAM,CAAO,EAAExa,IAAI,EAAE6O,EAAE,EAAO;4BAOX7O,4BAAAA;wBANf6nB,WAAW33B,CAAAA,OAAS,sEAAKA;gCAAM63B,cAAc;;wBAC7C,IAAI,CAAClZ,IAAI;4BACL,qFAAqF;4BACrF0Y,aAAa,EAAE;4BACf;wBACJ;wBACA,MAAMvY,SAAShP,iBAAAA,4BAAAA,gBAAAA,KAAM+O,OAAO,cAAb/O,qCAAAA,6BAAAA,cAAe+nB,YAAY,cAA3B/nB,iDAAAA,2BAA6BgP,MAAM;wBAClD,IAAI,CAACA,UAAU,CAACA,MAAM,CAAC,EAAE,EAAE;4BACvBuY,aAAa,EAAE;4BACf;wBACJ;wBACA,MAAMzY,WAAWxC,yCAAkBA,CAAC0C,MAAM,CAAC,EAAE;wBAC7C,MAAMiZ,UAAUd,iDAA0BA,CACtC;4BACI7e,cAAclM;4BACdtN,SAAS24B,kBAAkB,EAAE;wBACjC,GACA3Y;wBAGJ,MAAMoZ,kBAAkB,MAAM1b,sCAAoBA,CAACyb;wBACnDV,aAAaW;oBACjB;gBACA50B,OAAO,CAACsd;oBACJiX,WAAW33B,CAAAA,OAAS,sEAAKA;4BAAM63B,cAAc;;oBAC7C,yEAAyE;oBACzER,aAAa,EAAE;oBACft0B,QAAQC,GAAG,CAAC,eAAe0d;gBAC/B;YACJ;QACJ,MAAG;QACCkX;QACA9a;QACAzO;QACA0O;QACAwa;QACA1a;QACAJ;QACAle;QACAga;QACAK;QACAuO;QACAjb;QACAwN;QACAie;QACAN;QACA/4B;KACH;IAED,MAAM25B,qBAAqBpT,+BAAWA,CAAC;gBAcpBxW;YAbf,IAAI,CAACwO,gBAAgB,CAACE,mBAAmB,CAACrD,YAAY;gBAClD;YACJ;YACAie,WAAW33B,CAAAA,OAAS,sEAAKA;oBAAMi4B,oBAAoB;;YACnD,MAAMC,eAAezqB,qCAAeA,CAACY;YACrC,MAAMoB,eAAeP,aAAa3B,8BAAYA,CAACmC,IAAI,GAAGwoB,aAAarlB,aAAa,GAAG3D;YACnF,MAAMipB,oBAAoBjpB,aAAa3B,8BAAYA,CAACmC,IAAI,GAAGwoB,aAAalpB,cAAc,GAAG;YACzF,MAAMyI,mBAAmB0f,0CAAmBA,CAACI,gBAAgBj5B,aAAa4N;YAC1E,MAAMuN,UAAe;gBACjBuF,SAAS;gBACTpH,UAAUmF;gBACVpI,OAAOkI;gBACP/E,WAAW2E;gBACX1E,SAAS,GAAE1J,gBAAAA,WAAW,CAAC,EAAE,cAAdA,oCAAAA,cAAgB8E,MAAM,CAACzF,6BAAWA;gBAC7CsK,SAAS,WAAY,CAAC,EAAE,CAAW7E,MAAM,CAACzF,6BAAWA;gBACrDuR,SAAS;gBACTzY,cAAc,EAAE;gBAChB0C,MAAM;gBACNgG,UAAUO;gBACVT,gBAAgBmpB;gBAChBtgB,aAAasP;gBACbvoB,SAAS6Y;YACb;YAEA,IAAIlZ,WAAW4F,MAAM,GAAG,GAAG;gBACvBsV,QAAQjT,YAAY,GAAGjI;YAC3B;YAEA,IAAI4oB,eAAe,UAAU;gBACzB,IAAI;oBACA,MAAM2Q,cAAc,MAAMF;oBAC1B,IAAIE,aAAa;wBACbre,QAAQpB,YAAY,GAAGyf;oBAC3B;gBACJ,EAAE,OAAO10B,OAAO;oBACZu0B,WAAW33B,CAAAA,OAAS,sEAAKA;4BAAMi4B,oBAAoB;;oBACnDX,mBAAmB,EAAE;oBACrBv0B,QAAQK,KAAK,CAAC,6BAA6BA;oBAC3C;gBACJ;YACJ;YAEA,IAAI8I,eAAeib,eAAe,UAAU;gBACxC1N,QAAQrB,YAAY,GAAG+O,eAAe,WAAW2P,mCAAYA,CAAC5qB,eAAeA;YACjF;YAEAqO,yBAAyBA,CAAC;gBACtBb;eACGD,UACJ4Q,SAAS,CAAC;gBACTC,MAAM,CAAC,EAAExa,IAAI,EAAE6O,EAAE,EAAO;wBAQK6L,gBACCA;oBAR1BmN,WAAW33B,CAAAA,OAAS,sEAAKA;4BAAMi4B,oBAAoB;;oBACnD,IAAI,CAACtZ,IAAI;wBACL,4CAA4C;wBAC5C2Y,mBAAmB,EAAE;wBACrB;oBACJ;oBACA,MAAM9M,QAAQvB,qBAAWA,CAACnZ,KAAK+O,OAAO,CAACoZ,kBAAkB,CAACnZ,MAAM,CAAC,EAAE;oBACnE,MAAMrW,QAAQ/I,MAAMwT,IAAI,CAACsX,CAAAA,kBAAAA,6BAAAA,iBAAAA,MAAO9N,MAAM,CAAC,EAAE,cAAhB8N,qCAAAA,eAAkBC,MAAM,KAAI,EAAE;oBACvD,MAAMA,SAAS/qB,MAAMwT,IAAI,CAACsX,CAAAA,kBAAAA,6BAAAA,kBAAAA,MAAO9N,MAAM,CAAC,EAAE,cAAhB8N,sCAAAA,gBAAkBC,MAAM,KAAI,EAAE;oBACxD,IAAI,CAAChiB,MAAMtE,MAAM,IAAI,CAACsmB,OAAOtmB,MAAM,EAAE;wBACjCmzB,mBAAmB,EAAE;wBACrB;oBACJ;oBACA,MAAM3oB,kBAAkBlG,MAAMtI,GAAG,CAAC,CAAC0D,MAAWgC,QAAmB;4BAC7DuyB,IAAIv0B;4BACJ,YAAY4mB,MAAM,CAAC5kB,MAAM;wBAC7B;oBACA,MAAMwyB,aAAatB,oCAAaA,CAACpoB,iBAAiBN;oBAClDipB,mBAAmBe;gBACvB;gBACAj1B,OAAO,CAACsd;oBACJiX,WAAW33B,CAAAA,OAAS,sEAAKA;4BAAMi4B,oBAAoB;;oBACnD,8CAA8C;oBAC9CX,mBAAmB,EAAE;oBACrBv0B,QAAQC,GAAG,CAAC,eAAe0d;gBAC/B;YACJ;QACJ,MAAG;QACCkX;QACAvpB;QACA0O;QACAwa;QACA1a;QACAJ;QACAle;QACA2Q;QACAiY;QACAjb;QACAwN;QACAie;QACAL;QACAh5B;KACH;IAED,MAAMg6B,aAAazT,+BAAWA,CAAC;gBAUZxW;YATf,IAAI,CAACwO,gBAAgB,CAACE,mBAAmB,CAACrD,YAAY;gBAClD;YACJ;YACA,MAAMjC,mBAAmB0f,0CAAmBA,CAACI,gBAAgBj5B,aAAa4N;YAC1E,MAAMuN,UAAe;gBACjBuF,SAASlC;gBACTlF,UAAUmF;gBACVpI,OAAOkI;gBACP/E,WAAW2E;gBACX1E,SAAS,GAAE1J,gBAAAA,WAAW,CAAC,EAAE,cAAdA,oCAAAA,cAAgB8E,MAAM,CAACzF,6BAAWA;gBAC7CsK,SAAS,WAAY,CAAC,EAAE,CAAW7E,MAAM,CAACzF,6BAAWA;gBACrDuR,SAAS;gBACT/V,MAAM;gBACN2O,aAAasP;gBACbvoB,SAAS;gBACT2Z,MAAMA;gBACND,WAAW;YACf;YAEA,IAAI6O,eAAe,UAAU;gBACzB1N,QAAQ/B,iBAAiB,GAAGD;YAChC;YACAgC,QAAQjT,YAAY,GAAGjI,WAAW4F,MAAM,GAAG,IAAI5F,aAAa,EAAE;YAE9D,IAAI2N,eAAeib,eAAe,UAAU;gBACxC1N,QAAQrB,YAAY,GAAG+O,eAAe,WAAW2P,mCAAYA,CAAC5qB,eAAeA;YACjF;YAEA,IAAIib,eAAe,UAAU;gBACzB,IAAI;oBACA,MAAM2Q,cAAc,MAAMF;oBAC1B,IAAIE,aAAa;wBACbre,QAAQpB,YAAY,GAAGyf;oBAC3B;gBACJ,EAAE,OAAO10B,OAAO;oBACZL,QAAQK,KAAK,CAAC,6BAA6BA;oBAC3Co0B,WAAW,EAAE;oBACb;gBACJ;YACJ;YAEA/c,iBAAiBA,CAAC;gBACdf;eACGD,UACJ4Q,SAAS,CAAC;gBACTC,MAAM,CAAC,EAAExa,IAAI,EAAE6O,EAAE,EAAO;wBAIL7O,+BAAAA;oBAHf,IAAI,CAAC6O,IAAI;wBACL;oBACJ;oBACA,MAAMG,SAAShP,iBAAAA,4BAAAA,gBAAAA,KAAM+O,OAAO,cAAb/O,qCAAAA,gCAAAA,cAAeyoB,eAAe,cAA9BzoB,oDAAAA,8BAAgCgP,MAAM;oBACrD,IAAI,CAACA,UAAU,CAACA,MAAM,CAAC,EAAE,EAAE;wBACvB0Y,WAAW,EAAE;wBACb;oBACJ;oBACA,MAAM5Y,WAAWoY,sDAA+BA,CAAClY,MAAM,CAAC,EAAE,EAAExgB;oBAC5Dk5B,WAAW5Y;gBACf;gBACAxb,OAAO,CAACsd;oBACJ3d,QAAQC,GAAG,CAAC,eAAe0d;oBAC3B8W,WAAW,EAAE;gBACjB;YACJ;QACJ,MAAG;QACCI;QACA9a;QACAzO;QACA0O;QACAwa;QACA1a;QACAJ;QACAle;QACAga;QACA4O;QACAjb;QACAwN;QACA8d;QACAl5B;KACH;IAED,MAAMk6B,oBAAoB3T,+BAAWA,CAAC;gBAanBxW;YAZf,IAAI,CAACwO,gBAAgB,CAACE,mBAAmB,CAACrD,YAAY;gBAClD;YACJ;YACA,MAAMwe,eAAezqB,qCAAeA,CAACY;YACrC,MAAMoB,eAAeP,aAAa3B,8BAAYA,CAACmC,IAAI,GAAGwoB,aAAarlB,aAAa,GAAG3D;YACnF,MAAMipB,oBAAoBjpB,aAAa3B,8BAAYA,CAACmC,IAAI,GAAGwoB,aAAalpB,cAAc,GAAG;YACzF,MAAMyI,mBAAmB0f,0CAAmBA,CAACI,gBAAgBj5B,aAAa4N;YAC1E,MAAMuN,UAAe;gBACjBuF,SAAS;gBACTpH,UAAUmF;gBACVpI,OAAOkI;gBACP/E,WAAW2E;gBACX1E,SAAS,GAAE1J,gBAAAA,WAAW,CAAC,EAAE,cAAdA,oCAAAA,cAAgB8E,MAAM,CAACzF,6BAAWA;gBAC7CsK,SAAS,WAAY,CAAC,EAAE,CAAW7E,MAAM,CAACzF,6BAAWA;gBACrDuR,SAAS;gBACT/V,MAAM;gBACNgG,UAAUO;gBACVjJ,cAAc,EAAE;gBAChBwI,gBAAgBmpB;gBAChBtgB,aAAasP;gBACbvoB,SAAS6Y;YACb;YAEA,IAAIlZ,WAAW4F,MAAM,GAAG,GAAG;gBACvBsV,QAAQjT,YAAY,GAAGjI;YAC3B;YAEA,IAAI4oB,eAAe,UAAU;gBACzB,IAAI;oBACA,MAAM2Q,cAAc,MAAMF;oBAC1B,IAAIE,aAAa;wBACbre,QAAQpB,YAAY,GAAGyf;oBAC3B;gBACJ,EAAE,OAAO10B,OAAO;oBACZL,QAAQK,KAAK,CAAC,6BAA6BA;oBAC3Cq0B,mBAAmB;oBACnB;gBACJ;YACJ;YAEA,IAAIvrB,eAAeib,eAAe,UAAU;gBACxC1N,QAAQrB,YAAY,GAAG+O,eAAe,WAAW2P,mCAAYA,CAAC5qB,eAAeA;YACjF;YAEAwO,wBAAwBA,CAAC;gBACrBhB;eACGD,UACJ4Q,SAAS,CAAC;gBACTC,MAAM,CAAC,EAAExa,IAAI,EAAE6O,EAAE,EAAO;wBAQD6L;oBAPnBmN,WAAW33B,CAAAA,OAAS,sEAAKA;4BAAMw4B,mBAAmB;;oBAClD,IAAI,CAAC7Z,IAAI;wBACL,2CAA2C;wBAC3C8Y,mBAAmB;wBACnB;oBACJ;oBACA,MAAMjN,QAAQvB,qBAAWA,CAACnZ,KAAK+O,OAAO,CAAC4Z,iBAAiB,CAAC3Z,MAAM,CAAC,EAAE;oBAClE,MAAM4Z,cAAalO,iBAAAA,MAAM9N,MAAM,CAAC,EAAE,cAAf8N,qCAAAA,eAAiBC,MAAM,CAAC,EAAE;oBAC7C,IAAI,CAACiO,YAAY;wBACbjB,mBAAmB;wBACnB;oBACJ;oBACAA,mBAAmBiB;gBACvB;gBACAt1B,OAAO,CAACsd;oBACJ,uEAAuE;oBACvE+W,mBAAmB;oBACnB10B,QAAQC,GAAG,CAAC,eAAe0d;gBAC/B;YACJ;QACJ,MAAG;QACCkX;QACAvpB;QACA0O;QACAwa;QACA1a;QACAJ;QACAle;QACA2Q;QACAiY;QACAjb;QACAwN;QACA+d;QACAn5B;KACH;IAED,MAAMmlB,eAAeoB,+BAAWA,CAC5B,CAAC0B,UAAkB5R,OAAgBmQ;YAOhBzW;QANf,MAAMoJ,mBAAmB0f,0CAAmBA,CAACI,gBAAgBj5B,aAAa4N;QAC1E,MAAMuN,UAAe;YACjBuF,SAASlC;YACTlF,UAAUmF;YACVpI,OAAOA,SAASkI,gBAAgB;YAChC/E,WAAW2E;YACX1E,SAAS,GAAE1J,gBAAAA,WAAW,CAAC,EAAE,cAAdA,oCAAAA,cAAgB8E,MAAM,CAACzF,6BAAWA;YAC7CsK,SAAS,WAAY,CAAC,EAAE,CAAW7E,MAAM,CAACzF,6BAAWA;YACrDuR,SAAS;YACT/V,MAAM;YACN2O,aAAasP;YACbvoB,SAAS;YACT2Z,MAAMA;YACND,WAAWM;YACX2N;QACJ;QACA,IAAIY,eAAe,UAAU;YACzB1N,QAAQ/B,iBAAiB,GAAGD;QAChC;QAEAgC,QAAQjT,YAAY,GAAGjI,WAAW4F,MAAM,GAAG,IAAI5F,aAAa,EAAE;QAE9D,IAAI2N,aAAa;YACbuN,QAAQrB,YAAY,GAAG0e,mCAAYA,CAAC5qB;QACxC;QAEA2qB,2CAAwBA,CAAC;YACrBnd;WACGD,UACJ4Q,SAAS,CAAC;YACTC,MAAM,CAAC,EAAExa,IAAI,EAAE6O,EAAE,EAAO;gBACpBmG,YAAYA,SAAShV,KAAK+O,OAAO,CAAC8Z,iBAAiB,CAAC/uB,MAAM;gBAC1D,IAAI,CAAC+U,IAAI;oBACLtb,uBAAOA,CAACD,KAAK,CAAC;oBACd;gBACJ;gBACA,MAAMw1B,gBAAgB1B,0CAAmBA,CAACpnB,KAAK+O,OAAO,CAAC8Z,iBAAiB,CAAC7Z,MAAM,CAAC,EAAE;gBAClF4Y,aAAakB;YACjB;YACAx1B,OAAO,CAACsd;gBACJ,4BAA4B;gBAC5BgX,aAAa,EAAE;gBACf30B,QAAQC,GAAG,CAAC,eAAe0d;gBAC3BoE,YAAYA,SAASpE,IAAI9W,MAAM;gBAC/BvG,uBAAOA,CAACD,KAAK,CAAC;gBACds0B,aAAa;YACjB;QACJ;IACJ,GACA;QACI5a;QACAzO;QACA0O;QACAwa;QACA1a;QACAJ;QACAle;QACAga;QACAK;QACAuO;QACAjb;QACAwN;QACAge;QACAp5B;KACH;IAGL,MAAMu6B,YAAYhU,+BAAWA,CAAC;QAC1ByS,mBAAmB,EAAE;QACrBG,mBAAmB;QACnBJ,aAAa,EAAE;QACfG,WAAW,EAAE;IACjB,GAAG;QAACH;QAAcC;QAAoBG;QAAoBD;KAAW;IAErE,MAAMsB,cAAcjU,+BAAWA,CAC3B,CAAC,EAAEkU,gBAAgB,KAAK,EAAkB,GAAG,CAAC,CAAC;QAC3C,IAAI,CAACA,eAAe;YAChBvpB,QAAQ;QACZ;QACA,IAAI,CAACiN,kBAAkB;YACnBoc;YACA;QACJ;QACA,KAAKZ;QACL,KAAKO;QACL,KAAKX;QACL,KAAKS;IACT,GACA;QACIO;QACApc;QACAob;QACAI;QACAO;QACAF;QACA9oB;KACH;IAGL,MAAMwpB,iBAAiBnU,+BAAWA,CAAC;QAC/B,IAAI,CAACpI,kBAAkB;YACnBoc;YACA;QACJ;QACAC;IACJ,GAAG;QAACD;QAAWpc;QAAkBqc;KAAY;IAE7Ch5B,6BAASA,CAAC;QACN,IAAI,CAAC2c,kBAAkB;YACnB;QACJ;QACA,KAAKob;QACL,KAAKS;QACL,KAAKL;QACL,KAAKO;IACL,uDAAuD;IAC3D,GAAG;QAAC/b;QAAkBlE;KAAK;IAE3BzY,6BAASA,CAAC;QACNg5B,YAAY;YAAEC,eAAe;QAAM;IACnC,uDAAuD;IAC3D,GAAG;QAAC1qB;QAAaoO;QAAkBle;QAAY2Q;KAAS;IAExD,OAAO;QACHkP;QACA4J,YAAYgR;QACZvV;IACJ;AACJ;;;AC/iB0B;AACS;AACW;AACM;AAEI;AACE;AACQ;AACR;AACC;AACX;AACiB;AAElD,SAAS0V;IACpB,MAAMzzB,QAAQT,iBAASA;IACvB,MAAM,EAAEmZ,OAAO,EAAE4J,UAAU,EAAEvE,YAAY,EAAE,GAAG2T,eAAeA;IAE7D,qBACI,uCAAC56B;QACG0G,WAAW7G,YAAG,CAAC;;sCAEW,EAAEqJ,MAAME,MAAM,GAAG,YAAY,UAAU;;;YAGjE,CAAC;qBAED,uCAACqzB,mBAAUA;QAACG,SAAS;YAAE9yB,MAAM;QAAG;qBAC5B,uCAAC9J;QAAI68B,eAAaH,sBAAOA,CAACI,OAAO,CAACC,SAAS;qBACvC,uCAACrQ,cAAcA;QAAClB,YAAYA;QAAY5J,SAASA,QAAQyZ,YAAY,IAAIzZ,QAAQ6Z,kBAAkB;sBACnG,uCAAC/yB,cAAcA,wBAEnB,uCAACs0B;QACGt2B,WAAW7G,YAAG,CAAC;;;;;;;oBAOf,CAAC;qBAED,uCAACG;QACGuK,OAAO;YACH2C,QAAQ;QACZ;qBAEA,uCAACgC,eAAeA,wBAEpB,uCAAClP;QACG0G,WAAW7G,YAAG,CAAC;;;;;;8CAMO,EAAEqJ,MAAME,MAAM,GAAG,oBAAoB,OAAO;;;wBAGlE,CAAC;qBAED,uCAACpJ;QAAIuK,OAAO;YAAE8b,UAAU;YAAYrS,KAAK;YAAG/G,OAAO;QAAO;OAAI2U,QAAQ6Z,kBAAkB,kBAAI,uCAACjd,cAAUA;QAACvR,OAAO;uBAC/G,uCAAC2E,iBAAiBA,uBAClB,uCAAC5R;QACG0G,WAAW7G,YAAG,CAAC;;4BAEf,CAAC;qBAED,uCAACknB,eAAeA;QAACE,cAAcA;QAAcD,eAAe,KAAO;;AAO/F;;;;;;;;;;;AC1EO,MAAM0V,UAAU;IACrBO,WAAW;QACTC,QAAQ;QACRC,QAAQ;QACRC,QAAQ;IACV;IACAC,SAAS;QACPN,WAAW;QACXO,gBAAgB;IAClB;IACAR,SAAS;QACPC,WAAW;IACb;IACAQ,WAAW;QACTR,WAAW;IACb;IACAS,UAAU;QACRT,WAAW;QACXU,cAAc;IAChB;AACF,EAAE","sources":["webpack://doris-app/./components/discover-filter/discover-filter.style.ts","webpack://doris-app/./components/discover-filter/filter-content.tsx","webpack://doris-app/./components/discover-filter/index.tsx","webpack://doris-app/./utils/icon.tsx","webpack://doris-app/./utils/tailwind.ts","webpack://doris-app/./components/discover-sidebar/field-item/top-data/top-data.tsx","webpack://doris-app/./components/discover-sidebar/field-item/field-item.tsx","webpack://doris-app/./components/discover-sidebar/filter-content/filter-content.tsx","webpack://doris-app/./components/discover-sidebar/index.tsx","webpack://doris-app/./components/discover-histogram/index.tsx","webpack://doris-app/./components/selectdb-ui/sd-collapsible-table/index.tsx","webpack://doris-app/./components/discover-content/discover-content.style.ts","webpack://doris-app/./components/discover-content/content-table-actions.tsx","webpack://doris-app/./components/discover-content/content-item.tsx","webpack://doris-app/./components/surrounding-logs/surrounding-content-item.tsx","webpack://doris-app/./components/surrounding-logs/logs-actions.tsx","webpack://doris-app/./components/surrounding-logs/discover-filter/discover-filter.style.ts","webpack://doris-app/./components/surrounding-logs/discover-filter/filter-content.tsx","webpack://doris-app/./components/surrounding-logs/discover-filter/index.tsx","webpack://doris-app/./services/sql.ts","webpack://doris-app/./services/discover.ts","webpack://doris-app/./components/surrounding-logs/content/content-table-actions.tsx","webpack://doris-app/./components/surrounding-logs/index.tsx","webpack://doris-app/./components/discover-content/index.tsx","webpack://doris-app/./components/discover-header/discover-header.style.ts","webpack://doris-app/./components/discover-header/search-type.tsx","webpack://doris-app/./components/discover-header/sql-search.tsx","webpack://doris-app/./components/discover-header/lucene.tsx","webpack://doris-app/./components/discover-header/index.tsx","webpack://doris-app/./utils/query-parser/tokenUtils.ts","webpack://doris-app/./utils/query-parser/constants.ts","webpack://doris-app/./utils/query-parser/sqlstring-browser.ts","webpack://doris-app/./utils/query-parser/enums.ts","webpack://doris-app/./utils/query-parser/utils.ts","webpack://doris-app/./utils/query-parser/serializers.ts","webpack://doris-app/./utils/query-parser/ast.ts","webpack://doris-app/./utils/query-parser/query-parser.ts","webpack://doris-app/./services/lucene.ts","webpack://doris-app/./pages/PageDiscover/useLuceneWhereClause.ts","webpack://doris-app/./pages/PageDiscover/useDiscoverData.ts","webpack://doris-app/./pages/PageDiscover.tsx","webpack://doris-app/./components/testIds.ts"],"sourcesContent":["import { css } from '@emotion/css';\nimport styled from '@emotion/styled';\n\nexport const DiscoverFilterWrapper = styled.div`\n    display: flex;\n    align-items: center;\n    .filter {\n        align-self: flex-start;\n        margin-top: 3px;\n        margin-right: 8px;\n        font-weight: 500;\n        font-size: 14px;\n        font-style: normal;\n        line-height: 18px;\n    }\n    .filter-tag {\n        display: flex;\n        flex: 1;\n        flex-wrap: wrap;\n        align-items: center;\n        row-gap: 8px;\n        column-gap: 8px;\n        padding: 0 8px;\n        .tag {\n            display: flex;\n            align-items: center;\n            max-width: 400px;\n            height: 24px;\n            padding: 2px 8px;\n            font-weight: 400;\n            font-size: 12px;\n            font-style: normal;\n            line-height: 18px;\n            border: 0px;\n            border-radius: 6px;\n            .text {\n                overflow: hidden;\n                white-space: nowrap;\n                text-overflow: ellipsis;\n            }\n        }\n    }\n`;\n\nexport const containerStyle = css`\n    width: 320px;\n`;\n\nexport const rowStyle = css`\n    display: flex;\n    gap: 8px;\n    margin-bottom: 12px;\n`;\n\nexport const colStyle = css`\n    flex: 1;\n`;\n\nexport const footerStyle = css`\n    display: flex;\n    justify-content: flex-end;\n    gap: 8px;\n    margin-top: 16px;\n\n    & button {\n        flex: 1;\n        display: block;\n        text-align: center;\n        \n        span {\n            display: inline;\n        }\n    }\n`;\n","import { useAtom, useAtomValue } from 'jotai';\nimport React from 'react';\nimport { nanoid } from 'nanoid';\nimport { Select, InlineField, InlineFieldRow, InlineSwitch, Button, Input, Field } from '@grafana/ui';\nimport { tableFieldsAtom, dataFilterAtom, tableFieldValuesAtom, tableDataAtom, indexesAtom } from 'store/discover';\nimport { DataFilterType, Operator } from 'types/type';\nimport { OPERATORS, getFieldType } from 'utils/data';\nimport { Controller, useForm } from 'react-hook-form';\nimport { containerStyle, rowStyle, colStyle, footerStyle } from './discover-filter.style';\nimport { uniqBy } from 'lodash-es';\n\nexport function FilterContent({ onHide, dataFilterValue }: { onHide: () => void; dataFilterValue?: DataFilterType }) {\n    const tableFields = useAtomValue(tableFieldsAtom);\n    const [dataFilter, setDataFilter] = useAtom(dataFilterAtom);\n    const [tableFieldValue, setTableFieldValue] = useAtom(tableFieldValuesAtom);\n    const tableData = useAtomValue(tableDataAtom);\n    const indexes = useAtomValue(indexesAtom);\n\n    const {\n        control,\n        handleSubmit,\n        watch,\n        register,\n        setValue,\n        formState: { errors },\n    } = useForm({\n        defaultValues: {\n            field: {\n                label: dataFilterValue?.fieldName,\n                value: dataFilterValue?.fieldName\n            },\n            operator: {\n                label: dataFilterValue?.operator,\n                value: dataFilterValue?.operator\n            },\n            value: dataFilterValue?.value,\n            minValue: Array.isArray(dataFilterValue?.value) ? dataFilterValue?.value[0] : '',\n            maxValue: Array.isArray(dataFilterValue?.value) ? dataFilterValue?.value[1] : '',\n            label: dataFilterValue?.label || '',\n            showLabel: !!dataFilterValue?.label, // Initialize based on dataFilterValue\n        },\n    });\n\n    const field: any = watch('field');\n    const operator: any = watch('operator');\n    const showLabel: any = watch('showLabel');\n\n    // When user turns off the Custom Label switch, clear the label form value so it won't persist.\n    React.useEffect(() => {\n        if (!showLabel) {\n            // Clear the label in the form state so it won't be saved or re-displayed.\n            setValue('label', '');\n\n            // If we're editing an existing filter, also remove the label from the stored filter\n            // so the filter chip/list updates immediately and the switch remains off when reopened.\n            if (dataFilterValue?.id) {\n                setDataFilter(prev => {\n                    let changed = false;\n                    const updated = prev.map(f => {\n                        if (f.id === dataFilterValue.id) {\n                            if (f.label) {\n                                changed = true;\n                                return { ...f, label: '' };\n                            }\n                            return f;\n                        }\n                        return f;\n                    });\n                    return changed ? updated : prev;\n                });\n            }\n        }\n    }, [showLabel, setValue, dataFilterValue?.id, setDataFilter]);\n\n    // use centralized getFieldType from utils\n    const selectedFieldType = React.useMemo(() => {\n        const fieldName = typeof field === 'string' ? field : field?.value;\n        if (!fieldName) {\n            return '';\n        }\n        const tf = tableFields.find((f: any) => f.Field === fieldName);\n        return getFieldType(tf?.Type);\n    }, [field, tableFields]);\n\n    const isNumberField = selectedFieldType === 'NUMBER';\n    const isBooleanField = selectedFieldType === 'BOOLEAN';\n    const isTimeField = selectedFieldType === 'DATE';\n\n    // Normalize OPERATORS to the form {label, value} and filter out inapplicable operators based on field type.\n    const operatorOptions = React.useMemo(() => {\n        const normalized = ((OPERATORS || []) as any[]).map(op => ({ label: (op && op.label) || op, value: (op && op.value) || op }));\n        // match_* operators require doris inverted index. Keep LIKE/NOT LIKE available for string-like fields\n        const matchOnlyOps = ['match_all', 'match_any', 'match_phrase', 'match_phrase_prefix'];\n\n        if (isBooleanField) {\n            // BOOLEAN should only allow equality and null checks\n            const allowed = new Set(['=', '!=', 'is null', 'is not null']);\n            return normalized.filter(opItem => allowed.has(String(opItem.value)));\n        }\n\n        const isNumberOrTime = isNumberField || isTimeField;\n        if (isNumberOrTime) {\n            // remove text match ops (including LIKE/NOT LIKE and match_*) for number or time fields\n            return normalized.filter(opItem => {\n                const v = String(opItem.value).toLowerCase();\n                return !(v === 'like' || v === 'not like' || matchOnlyOps.includes(v));\n            });\n        }\n\n        // non-number, non-boolean, non-time fields: keep full list\n        // For string-like fields, only allow doris inverted-index text operators when the field has an inverted index\n        try {\n            const fieldName = typeof field === 'string' ? field : field?.value;\n            // If the user hasn't selected a field yet, show the full list (no gating)\n            if (!fieldName) {\n                return normalized;\n            }\n            // treat \"string\" here as any type except NUMBER, BOOLEAN, DATE\n            if (!isNumberField && !isBooleanField && !isTimeField) {\n                const hasInverted = Array.isArray(indexes) && indexes.some((idx: any) => {\n                    if (!idx || !idx.columnName) {\n                        return false;\n                    }\n                    const t = idx.type || '';\n                    return String(idx.columnName) === String(fieldName) && t.toUpperCase().includes('INVERT');\n                });\n\n                if (!hasInverted) {\n                    // remove only the match_* operators; allow LIKE/NOT LIKE to remain because they work without inverted index\n                    return normalized.filter(opItem => {\n                        const v = String(opItem.value).toLowerCase();\n                        return !matchOnlyOps.includes(v);\n                    });\n                }\n             }\n         } catch (e) {\n             // swallow any unexpected errors and fall back to returning full list\n         }\n\n         return normalized;\n      }, [isNumberField, isBooleanField, isTimeField, field, indexes]);\n\n    const getValue = (value: string): string | number => (isNaN(+value) ? value : +value);\n\n    // Convert an input value according to current field type.\n    // Preserve explicit empty string ('') so users can set an empty-string value.\n    const convertValue = (v: any): any => {\n        // Preserve explicit empty string so the user can set ''\n        if (v === '')  {\n            return '';\n        }\n        if (v === undefined || v === null) {\n            return v;\n        }\n\n        // If array, convert each element\n        if (Array.isArray(v)) {\n            return v.map(convertValue);\n        }\n\n        // Handle booleans\n        if (v === true || v === 'true') {\n            return true;\n        }\n        if (v === false || v === 'false') {\n            return false;\n        }\n\n        // Prefer field-type-based conversion when possible\n        if (isNumberField) {\n            return getValue(String(v));\n        }\n\n        // NOTE: removed previous fallback that converted numeric-looking strings to Number for\n        // non-number fields. Now we only convert to Number when the field type is numeric.\n\n        return v;\n    };\n\n    const onSubmit = (formValues: any) => {\n        const { field, operator: opField, value, minValue, maxValue, label, showLabel } = formValues;\n        const current = dataFilter.find(f => f.id === dataFilterValue?.id);\n        const id = dataFilterValue?.id || nanoid();\n\n        // The compatible operator could be string or {label, value}.\n        const opValue = typeof opField === 'string' ? opField : opField?.value;\n\n        let newValue: any[] = [];\n\n        if (opValue === 'between' || opValue === 'not between') {\n            // Use convertValue so numbers/booleans are properly typed; preserve empty strings if provided\n            if ((minValue !== undefined && minValue !== '') && (maxValue !== undefined && maxValue !== '')) {\n                newValue = [convertValue(minValue), convertValue(maxValue)];\n            }\n        } else if (value !== undefined) {\n            // accept empty string, 0 and other falsy numeric values.\n            if (Array.isArray(value)) {\n                newValue = value.map(v => convertValue(v));\n            } else {\n                newValue = [convertValue(value)];\n            }\n        }\n\n        const newItem = {\n            id,\n            fieldName: field.value,\n            operator: opValue,\n            // Only persist label when showLabel is true. Otherwise ensure it's empty.\n            label: showLabel ? label : '',\n            value: newValue,\n        };\n        if (current) {\n            const updated = dataFilter.map(f => (f.id === id ? newItem : f));\n            setDataFilter(updated);\n        } else {\n            setDataFilter([...dataFilter, newItem]);\n        }\n\n        onHide();\n    };\n\n    function renderFiledComponent() {\n        // const currentField = field.value;\n        // console.log(operator);\n        console.log(operator);\n        const currentOperator = (typeof operator === 'string' ? operator : operator?.value) as Operator | undefined;\n        if (currentOperator && currentOperator !== 'is null' && currentOperator !== 'is not null' && (currentOperator === 'between' || currentOperator === 'not between')) {\n            return (\n                <div className={rowStyle}>\n                    <div className={colStyle}>\n                        <Field label=\"Min Value\" invalid={!!errors.minValue} error={errors.minValue?.message}>\n                            <Input {...register('minValue', { required: 'Enter the minValue' })} />\n                        </Field>\n                    </div>\n                    <div className={colStyle}>\n                        <Field label=\"Max Value\" invalid={!!errors.maxValue} error={errors.maxValue?.message}>\n                            <Input {...register('maxValue', { required: 'Enter the maxValue' })} />\n                        </Field>\n                    </div>\n                </div>\n            );\n        }\n        console.log('currentOperator', currentOperator);\n        if (\n            currentOperator === '=' ||\n            currentOperator === '!=' ||\n            currentOperator === 'like' ||\n            currentOperator === 'not like' ||\n            currentOperator === 'match_all' ||\n            currentOperator === 'match_any' ||\n            currentOperator === 'match_phrase' ||\n            currentOperator === 'match_phrase_prefix'\n        ) {\n            return (\n                <>\n                    <Field label=\"Value\" invalid={!!errors.value} error={(errors.value as any)?.message}>\n                        {/* Allow empty string as a valid value: treat undefined as missing but accept '' */}\n                        <Input {...register('value', { validate: (v: any) => v !== undefined || 'Enter the value' })} />\n                    </Field>\n                </>\n            );\n        }\n        if (currentOperator === 'in' || currentOperator === 'not in') {\n            return (\n                <Field label=\"Value\" invalid={!!errors.value} error={(errors.value as any)?.message}>\n                    <Controller\n                        name=\"value\"\n                        control={control}\n                        rules={{ required: 'Enter the value' }}\n                        render={({ field }) => (\n                            <Select\n                                {...field}\n                                isMulti={true}\n                                options={tableFieldValue.map(item => ({\n                                    label: item.value,\n                                    value: item.value,\n                                }))}\n                                placeholder=\"Select value\"\n                                onChange={selected => field.onChange(selected ? selected.map((s: any) => s.value) : [])}\n                                value={tableFieldValue\n                                    .filter(item => Array.isArray(field.value) && field.value.includes(item.value))\n                                    .map(item => ({\n                                        label: item.value,\n                                        value: item.value,\n                                    }))}\n                            />\n                        )}\n                    />\n                </Field>\n            );\n        }\n        return <></>;\n    }\n\n    return (\n        <form onSubmit={handleSubmit(onSubmit)} className={containerStyle}>\n            <div className={rowStyle}>\n                <div className={colStyle}>\n                    <Field label=\"Columns\" invalid={!!errors.field} error={(errors.field as any)?.message}>\n                        <Controller\n                            name=\"field\"\n                            control={control}\n                            rules={{ required: 'Select Field' }}\n\n                            render={({ field }) => (\n                                <Select\n                                    {...field}\n                                    onChange={(selected) => {\n                                        // Only update tableFieldValue when we actually have table data and a selected field\n                                        if (selected?.value && Array.isArray(tableData) && tableData.length > 0) {\n                                            setTableFieldValue(\n                                                uniqBy(\n                                                    tableData.map((item) => ({\n                                                        label: selected.value,\n                                                        value: item._original[selected.value],\n                                                    })),\n                                                    'value',\n                                                ),\n                                            );\n                                        } else {\n                                            setTableFieldValue([]);\n                                        }\n                                        field.onChange(selected)\n                                    }}\n\n                                    options={tableFields.map(f => ({\n                                        label: f.Field,\n                                        value: f.Field,\n                                    }))}\n                                />\n                            )}\n                        />\n                    </Field>\n                </div>\n                <div className={colStyle}>\n                    <Field label=\"Operator\" invalid={!!errors.operator} error={(errors.operator as any)?.message}>\n                        <Controller\n                            name=\"operator\"\n                            control={control}\n                            rules={{ required: 'Select Operator' }}\n                            render={({ field }) => (\n                                <Select\n                                    {...field}\n                                    options={operatorOptions}\n                                />\n                            )}\n                        />\n                    </Field>\n                </div>\n            </div>\n\n            {renderFiledComponent()}\n\n            <InlineFieldRow>\n                <InlineField label=\"Custom Label\">\n                    <Controller name=\"showLabel\" control={control} render={({ field }) => <InlineSwitch {...field} />}></Controller>\n                </InlineField>\n            </InlineFieldRow>\n\n            {showLabel && (\n                <Field invalid={!!errors.label} error={errors.label?.message}>\n                    <Input {...register('label', { required: 'Please enter label' })} />\n                </Field>\n            )}\n\n            <div className={footerStyle}>\n                <Button\n                    variant=\"secondary\"\n                    onClick={e => {\n                        e.preventDefault();\n                        onHide();\n                    }}\n                >\n                    Cancel\n                </Button>\n                <Button type=\"submit\">Confirm</Button>\n            </div>\n        </form>\n    );\n}\n","import React, { useRef, useState } from 'react';\nimport { DiscoverFilterWrapper } from './discover-filter.style';\nimport { useTranslation } from 'react-i18next';\nimport { useAtom } from 'jotai';\nimport { FilterContent } from './filter-content';\nimport { dataFilterAtom, locationAtom } from 'store/discover';\nimport { getFilterSQL } from 'utils/data';\nimport { css } from '@emotion/css';\nimport { Badge, Icon, IconButton, Toggletip, useTheme2 } from '@grafana/ui';\n// import { set } from 'lodash-es';\n\nexport default function DiscoverFilter() {\n    const [dataFilter, setDataFilter] = useAtom(dataFilterAtom);\n    const [open, setOpen] = useState<boolean>(false);\n    const [dataFilterOpen, setDataFilterOpen] = useState<any>({});\n    const discoverFilterRef = useRef(null);\n    const { t } = useTranslation();\n    const [_loc, setLoc] = useAtom(locationAtom);\n    const theme = useTheme2();\n\n    return (\n        //  className=\"mt-px rounded-b-sm bg-n8 p-4 pb-6\"\n        <DiscoverFilterWrapper\n            ref={discoverFilterRef}\n            className={css`\n                background-color: ${theme.isDark ? 'rgb(24, 27, 31)' : '#FFF'};\n                padding: 1rem;\n                padding-bottom: 1.5rem;\n                margin-top: 1px;\n                border-radius: 0 0 0.25rem 0.25rem;\n            `}\n        >\n            <div className=\"text-xs font-medium\">{t`Filter`}</div>\n            <div className=\"filter-tag\">\n                {dataFilter.map((dataFilterValue, index) => {\n                    return (\n                        <div\n                            key={index.toString()}\n                            className={css`\n                                margin: '0 4px';\n                            `}\n                        >\n                            <Toggletip\n                                show={dataFilterOpen[dataFilterValue.id]}\n                                onOpen={() => {\n                                    setDataFilterOpen({\n                                        ...dataFilterOpen,\n                                        [dataFilterValue.id]: true,\n                                    });\n                                }}\n                                onClose={() => {\n                                    setDataFilterOpen({\n                                        ...dataFilterOpen,\n                                        [dataFilterValue.id]: false,\n                                    });\n                                }}\n                                closeButton={true}\n                                content={\n                                    <FilterContent\n                                        onHide={() => {\n                                            setDataFilterOpen({\n                                                ...dataFilterOpen,\n                                                [dataFilterValue.id]: false,\n                                            });\n                                        }}\n                                        dataFilterValue={dataFilterValue}\n                                    />\n                                }\n                                placement=\"bottom\"\n                            >\n                                <div>\n                                    <Badge\n                                        // className=\"mx-1 rounded px-2 py-[2px] text-xs leading-[18px] text-n3 first:ml-2 hover:border-b7 group-data-[state=open]:border-b7 dark:hover:border-b3 dark:group-data-[state=open]:border-b3\"\n                                        key={index}\n                                        text={\n                                            <div\n                                                className={css`\n                                                    display: flex;\n                                                    align-items: center;\n                                                    justify-content: space-between;\n                                                `}\n                                            >\n                                                <span>{dataFilterValue.label ? <span>{dataFilterValue.label}</span> : <span>{getFilterSQL(dataFilterValue)}</span>}</span>\n                                                <div\n                                                    className={css`\n                                                        margin-left: 0.5rem;\n                                                        cursor: pointer;\n                                                    `}\n                                                    onClick={() => {\n                                                        const data_filters = dataFilter.filter(e => e !== dataFilterValue);\n                                                        setDataFilter(data_filters);\n                                                        setLoc(prev => {\n                                                            const searchParams = prev.searchParams;\n                                                            searchParams?.set('data_filters', JSON.stringify(data_filters));\n                                                            return {\n                                                                ...prev,\n                                                                searchParams,\n                                                            };\n                                                        });\n                                                    }}\n                                                >\n                                                    <Icon name=\"times\" />\n                                                </div>\n                                            </div>\n                                        }\n                                        color=\"blue\"\n                                    ></Badge>\n                                </div>\n                            </Toggletip>\n                        </div>\n                    );\n                })}\n                <Toggletip\n                    show={open}\n                    closeButton={false}\n                    onOpen={() => {\n                        setOpen(true);\n                    }}\n                    content={\n                        <FilterContent\n                            onHide={() => {\n                                console.log('onHide');\n                                setOpen(false);\n                            }}\n                        />\n                    }\n                    placement=\"bottom\"\n                >\n                    <IconButton name=\"plus\" tooltip=\"Add filter\" style={{marginLeft: 10}} />\n                </Toggletip>\n            </div>\n        </DiscoverFilterWrapper>\n    );\n}\n","import { Icon } from '@grafana/ui';\nimport React from 'react';\n\nexport const FIELD_TYPES = [\n    {\n        key: 'STRING',\n        value: ['VARCHAR', 'STRING', 'CHAR', 'TEXT'],\n        icon: <Icon name=\"text-fields\" />,\n    },\n    {\n        key: 'NUMBER',\n        value: ['INT', 'LARGEINT', 'SMALLINT', 'TINYINT', 'DECIMAL', 'BIGINT', 'FLOAT', 'DOUBLE'],\n        icon: <Icon name=\"list-ol\" />,\n    },\n    {\n        key: 'DATE',\n        value: ['DATE', 'DATETIME', 'DATEV2', 'DATETIMEV2'],\n        icon: <Icon name=\"clock-nine\" />,\n    },\n    {\n        key: 'JSONB',\n        value: ['JSONB'],\n        icon: <Icon name=\"brackets-curly\" />,\n        complex: true,\n    },\n    {\n        key: 'ARRAY',\n        value: ['ARRAY'],\n        icon: <Icon name=\"list-ul\" />,\n        complex: true,\n    },\n    {\n        key: 'BOOLEAN',\n        value: ['BOOLEAN'],\n        icon: <Icon name=\"toggle-on\" />,\n    },\n    {\n        key: 'BITMAP',\n        value: ['BITMAP'],\n        icon: <Icon name=\"building\" />,\n        complex: true,\n    },\n    {\n        key: 'HLL',\n        value: ['HLL'],\n        icon: <Icon name=\"draggabledots\" />,\n        complex: true,\n    },\n    {\n        key: 'VARIANT',\n        value: ['VARIANT'],\n        icon: <Icon name=\"brackets-curly\" />,\n        complex: true,\n    },\n    {\n        key: 'JSON',\n        value: ['JSON'],\n        icon: <Icon name=\"brackets-curly\" />,\n        complex: true,\n    },\n];\n\nexport const getFieldIcon = (columnType: string) => {\n    const currentColumnType = FIELD_TYPES.find(item => item.value.some(val => columnType.toLocaleUpperCase().includes(val)));\n    return currentColumnType?.icon;\n};\n","import { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\nexport function cn(...inputs: ClassValue[]) {\n    return twMerge(clsx(inputs));\n}","import { css } from '@emotion/css';\nimport { IconButton } from '@grafana/ui';\nimport { Progress } from 'antd';\nimport { useAtom, useAtomValue } from 'jotai';\nimport { get } from 'lodash-es';\nimport { nanoid } from 'nanoid';\nimport React from 'react';\nimport { topDataAtom, tableTotalCountAtom, dataFilterAtom } from 'store/discover';\nimport { isComplexType } from 'utils/data';\ninterface JsonObject {\n    [key: string]: any;\n}\nfunction countValueDistribution(jsonArray: JsonObject[], key: string): { [value: string]: number } {\n    const valueCountMap = new Map<string, number>();\n\n    jsonArray.forEach(obj => {\n        let value = get(obj, key);\n        if (value === undefined) {\n            value = '';\n        }\n        valueCountMap.set(value, (valueCountMap.get(value) || 0) + 1);\n    });\n\n    const result: { [value: string]: number } = {};\n    valueCountMap.forEach((times, valueStr) => {\n        const value = valueStr;\n        result[value] = times;\n    });\n\n    return result;\n}\n\nexport function TopData({ field }: any) {\n    console.log(field);\n    const topData = useAtomValue(topDataAtom);\n    const tableTotalCount = useAtomValue(tableTotalCountAtom);\n    const [dataFilter, setDataFilter] = useAtom(dataFilterAtom);\n    const canDisplayTopData = field?.Type?.toUpperCase() !== 'VARIANT';\n    const res = Object.entries(countValueDistribution(topData, field.Field)).sort((a: any, b: any) => b[1].count - a[1].count);\n\n    return (\n        <div\n            className={css`\n                max-height: 400px;\n                overflow-y: auto;\n                padding: 8px;\n            `}\n        >\n            <div className=\"mb-2 mt-2 break-words text-xs text-n5\">\n                <span className=\"mr-2\">{field.Field}</span>\n                <span>({field.Type})</span>\n            </div>\n            <div\n                className={css`\n                    display: flex;\n                    align-items: center;\n                    justify-content: space-between;\n                `}\n            >\n                <div\n                    className={css`\n                        font-size: 16px;\n                        margin: 8px 0;\n                    `}\n                >\n                    TOP5\n                </div>\n                <small className=\"text-n2\">{tableTotalCount >= 500 ? 500 : tableTotalCount} Items</small>\n            </div>\n            {canDisplayTopData ? (\n                <div className=\"mt-3 space-y-3 text-n5\">\n                    {res.map(\n                        ([value, count], index) =>\n                            index < 5 && (\n                                <div key={index} className=\"flex items-center justify-between\">\n                                    <div\n                                        className={css`\n                                            overflow: hidden;\n                                            text-overflow: ellipsis;\n                                            white-space: nowrap;\n                                        `}\n                                    >\n                                        <div\n                                            className={css`\n                                                display: flex;\n                                                align-items: center;\n                                                width: 180px;\n                                                justify-content: space-between;\n                                            `}\n                                        >\n                                            <div\n                                                className={css`\n                                                    flex: 1 1 0%;\n                                                    overflow: hidden;\n                                                    text-overflow: ellipsis;\n                                                    white-space: nowrap;\n                                                `}\n                                            >\n                                                {value}\n                                            </div>\n                                            <div\n                                                className={css`\n                                                    margin-left: 20px;\n                                                    flex-shrink: 0;\n                                                `}\n                                            >\n                                                {+((count * 100) / topData.length).toFixed(1)}%\n                                            </div>\n                                        </div>\n                                        <Progress\n                                            size={4}\n                                            className={css`\n                                                .ant-progress-outer {\n                                                    .ant-progress-inner {\n                                                        position: absolute;\n                                                        top: 0px;\n                                                    }\n                                                }\n                                            `}\n                                            style={{ width: '100%', height: '0px' }}\n                                            percent={+((count * 100) / topData.length).toFixed(1)}\n                                            status=\"normal\"\n                                            showInfo={false}\n                                        />\n                                    </div>\n                                    {!isComplexType(field.Type) && (\n                                        <div\n                                            className={css`\n                                                margin-left: 30px;\n                                            `}\n                                        >\n                                            <IconButton\n                                                name=\"plus-circle\"\n                                                onClick={e => {\n                                                    console.log(value);\n                                                    setDataFilter([\n                                                        ...dataFilter,\n                                                        {\n                                                            fieldName: field.Field,\n                                                            operator: '=',\n                                                            value: [typeof value === 'string' ? value : +value],\n                                                            id: nanoid(),\n                                                        },\n                                                    ]);\n                                                    e.stopPropagation();\n                                                }}\n                                                tooltip=\"Equivalent filtration\"\n                                            />\n                                            <IconButton\n                                                name=\"minus-circle\"\n                                                style={{ marginLeft: '4px' }}\n                                                tooltip=\"Nonequivalent filtration\"\n                                                onClick={e => {\n                                                    setDataFilter([\n                                                        ...dataFilter,\n                                                        {\n                                                            fieldName: field.Field,\n                                                            operator: '!=',\n                                                            value: [typeof value ? value : +value],\n                                                            id: nanoid(),\n                                                        },\n                                                    ]);\n                                                    e.stopPropagation();\n                                                }}\n                                            />\n                                        </div>\n                                    )}\n                                </div>\n                            ),\n                    )}\n                </div>\n            ) : (\n                <div className=\"mt-2 text-xs text-n5\">Does not supported</div>\n            )}\n        </div>\n    );\n}\n","import React from 'react';\nimport { getFieldIcon } from 'utils/icon';\nimport { IconButton, Toggletip, useTheme2 } from '@grafana/ui';\nimport { css } from '@emotion/css';\nimport { cn } from 'utils/tailwind';\nimport { TopData } from './top-data/top-data';\n\ninterface FieldItemProps {\n    field: any;\n    onAdd?: (field: any) => void;\n    onRemove?: (field: any) => void;\n    type: 'add' | 'remove';\n}\n\nexport default function FieldItem(props: FieldItemProps) {\n    const theme = useTheme2();\n    const { field } = props;\n    field.key = field.Field;\n    if (field.children) {\n        field.icon = <div className=\"w-4 text-sm leading-8 text-n4\">{}</div>;\n        return (\n            <div className=\"-ml-3 flex\">\n                Tree\n                {/* <Tree showIcon className={`${TreeStyle} ${DiscoverTreeStyle}`} treeData={[field]} switcherIcon={<SDIcon type=\"icon-arrow-down\" className=\"dark:text-n6\" />} /> */}\n            </div>\n        );\n    }\n    return (\n        <div>\n            <Toggletip placement='right' content={<TopData field={field} />}>\n                <div\n                    className={css`\n                        width: 100%;\n                        text-align: left;\n                        display: flex;\n                        align-items: center;\n                        justify-content: space-between;\n                        height: 32px;\n                        padding: 0 8px;\n                        cursor: pointer;\n                        &:hover .icon-wrapper {\n                            opacity: 1;\n                        }\n                        &:hover {\n                            background-color: ${theme.colors.background.secondary};\n                        }\n                    `}\n                >\n                    <div className=\"flex\">\n                        <div>{getFieldIcon(field['Type'])}</div>\n                        <div\n                            className={css`\n                                display: flex;\n                                margin-left: 4px;\n                                overflow: hidden;\n                                text-overflow: ellipsis;\n                                white-space: nowrap;\n                                max-width: 130px;\n                            `}\n                        >\n                            {field['Field']}\n                        </div>\n                    </div>\n                    <div\n                        className={cn(\n                            'icon-wrapper',\n                            css`\n                                opacity: 0;\n                                transition: opacity 0.2s;\n                                margin-left: auto;\n                                display: flex;\n                                align-items: center;\n                                color: ${theme.colors.text.secondary};\n                                &:hover {\n                                    color: ${theme.colors.text.primary};\n                                }\n                            `,\n                        )}\n                    >\n                        {props.type === 'add' ? (\n                            <IconButton\n                                name=\"plus\"\n                                tooltip=\"Add to table\"\n                                onClick={e => {\n                                    props?.onAdd?.(field);\n                                    e.stopPropagation();\n                                }}\n                            />\n                        ) : (\n                            <IconButton\n                                name=\"minus\"\n                                tooltip=\"Delete from table\"\n                                onClick={(e: any) => {\n                                    props?.onRemove?.(field);\n                                    e.stopPropagation();\n                                }}\n                            />\n                        )}\n                    </div>\n                </div>\n            </Toggletip>\n        </div>\n    );\n}\n","import { useTranslation } from 'react-i18next';\nimport { useAtom } from 'jotai';\nimport React from 'react';\nimport { searchableAtom, aggregatableAtom, fieldTypeAtom } from 'store/discover';\nimport { AggregatableEnum, AGGREGATABLE, SearchableEnum, SEARCHABLE } from 'utils/data';\nimport { Select, RadioButtonGroup } from '@grafana/ui';\nimport { css } from '@emotion/css';\n\nexport function FilterContent() {\n  const { t } = useTranslation();\n  const [searchable, setSearchable] = useAtom(searchableAtom);\n  const [aggregatable, setAggregatable] = useAtom(aggregatableAtom);\n  const [fieldType, setFieldType] = useAtom(fieldTypeAtom);\n  return (\n    //  className=\"w-auto divide-y rounded-md dark:divide-gray-700\"\n    <div className={css`\n      width: auto;\n      border-radius: 0.375rem;\n    `}>\n      {/* className=\"title dark:text-n2\" */}\n      <div className={css`\n        font-size: 1.125rem;\n        font-weight: 500;\n        `}>{`Field Filter`}</div>\n      <div className={css`\n          margin-top: 1rem;\n          border: none;\n        `}>\n        <div className={css`\n          font-size: 0.875rem;\n          margin-bottom: 0.5rem;\n          `} >{t`Aggregatable`}</div>\n        <div>\n          <RadioButtonGroup\n            //   name=\"aggregatable\"\n            options={AGGREGATABLE}\n            value={aggregatable}\n            onChange={(val) => {\n              setAggregatable(val as AggregatableEnum);\n            }}\n          />\n        </div>\n      </div>\n      <div className={css`\n          margin-top: 1rem;\n          border: none;\n        `}>\n        <div className={css`\n          font-size: 0.875rem;\n          margin-bottom: 0.5rem;\n          `} >{t`Searchable`}</div>\n        <div>\n          <RadioButtonGroup\n            //   name=\"searchable\"\n            options={SEARCHABLE}\n            value={searchable}\n            onChange={(val) => {\n              setSearchable(val as SearchableEnum);\n            }}\n          />\n        </div>\n      </div>\n      <div className={css`\n          margin-top: 1rem;\n          border: none;\n        `}>\n        <div className={css`\n          font-size: 0.875rem;\n          margin-bottom: 0.5rem;\n          `} >{t`Type`}</div>\n        <Select\n          value={fieldType as any}\n          onChange={(value) => {\n            setFieldType(value as any);\n          }}\n          options={[\n            {\n              value: 'ANY',\n              label: 'Any',\n            },\n            {\n              value: 'STRING',\n              label: 'String',\n            },\n            {\n              value: 'NUMBER',\n              label: 'Number',\n            },\n            {\n              value: 'DATE',\n              label: 'Date',\n            },\n          ]}\n        />\n      </div>\n    </div>\n  );\n}\n","import { useAtom, useAtomValue } from 'jotai';\nimport React, { useState } from 'react';\nimport FieldItem from './field-item/field-item';\nimport { FilterContent } from './filter-content/filter-content';\nimport { selectedFieldsAtom, tableFieldsAtom, searchableAtom, aggregatableAtom, fieldTypeAtom, indexesAtom, surroundingSelectedFieldsAtom } from 'store/discover';\nimport { AggregatableEnum, getFieldType, SearchableEnum, FieldTypeEnum } from 'utils/data';\nimport { Button, CollapsableSection, Icon, Input, useTheme2, Toggletip } from '@grafana/ui';\nimport { css } from '@emotion/css';\n\nexport default function DiscoverSidebar() {\n    const [selectedFields, setSelectedFields] = useAtom(selectedFieldsAtom);\n    const [selectedSurroundingFields, setSelectedSurroundingFields] = useAtom(surroundingSelectedFieldsAtom);\n    const tableFields = useAtomValue(tableFieldsAtom);\n    const [searchable, _setSearchable] = useAtom(searchableAtom);\n    const [aggregatable, _setAggregatable] = useAtom(aggregatableAtom);\n    const [fieldType, _setFieldType] = useAtom(fieldTypeAtom);\n    const [searchValue, setSearchValue] = useState('');\n    const indexes = useAtomValue(indexesAtom);\n    const theme = useTheme2();\n    const filteredFields = tableFields\n        .filter(field => {\n            if (aggregatable === AggregatableEnum.ANY) {\n                return true;\n            }\n            if (aggregatable === AggregatableEnum.YES) {\n                return getFieldType(field.Type) === 'NUMBER';\n            }\n            if (aggregatable === AggregatableEnum.NO) {\n                return getFieldType(field.Type) !== 'NUMBER';\n            }\n            return false;\n        })\n        .filter((field: any) => {\n            if (searchable === SearchableEnum.ANY) {\n                return true;\n            }\n            if (searchable === SearchableEnum.YES) {\n                return indexes.some(index => field.Field === index.Field);\n            }\n            if (searchable === SearchableEnum.NO) {\n                return !indexes.some(index => field.Field === index.Field);\n            }\n            return false;\n        })\n        .filter(field => {\n            if (fieldType === FieldTypeEnum.ANY) {\n                return true;\n            }\n            return getFieldType(field.Type) === fieldType;\n        });\n    const hasSelectedFields = selectedFields.length > 0;\n    const availableFields = filteredFields.filter(filed => {\n        if (selectedFields.find(item => filed['Field'] === item['Field'])) {\n            return false;\n        }\n        return true;\n    });\n\n    function handleAdd(field: any) {\n        setSelectedFields([...selectedFields, field] as any);\n        setSelectedSurroundingFields([...selectedSurroundingFields, field] as any)\n    }\n\n    function handleRemove(field: any) {\n        const index = selectedFields.findIndex((item: any) => item.Field === field.Field);\n        selectedFields.splice(index, 1);\n\n        const surIndex = selectedSurroundingFields.findIndex((item: any) => item.Field === field.Field);\n        selectedSurroundingFields.splice(surIndex, 1);\n        setSelectedFields([...selectedFields]);\n        setSelectedSurroundingFields([...selectedSurroundingFields]);\n    }\n\n    return (\n        <div\n            className={css`\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n            `}\n        >\n            <div\n                className={css`\n                    display: flex;\n                    background-color: ${theme.isDark ? 'rgb(24, 27, 31)' : '#FFF'};\n                    padding: 1rem 0.5rem;\n                    border-raduis: 0.25rem 0;\n                    align-items: center;\n                    column-gap: 0.5rem;\n                `}\n            >\n                <Icon name=\"search\" />\n                <Input\n                    placeholder={`Search`}\n                    className={css`\n                        border: none;\n                    `}\n                    value={searchValue}\n                    onChange={(e: any) => setSearchValue(e.target.value)}\n                />\n                <Toggletip content={<FilterContent />}>\n                    <Icon name=\"filter\" />\n                </Toggletip>\n            </div>\n            <div\n                className={css`\n                    margin-top: 1px;\n                    flex: 1;\n                    padding: 0.5rem 1rem 0.5rem 1rem;\n                    background-color: ${theme.isDark ? 'rgb(24, 27, 31)' : '#FFF'};\n                    height: 100%;\n                    overflow: auto;\n                `}\n            >\n                <CollapsableSection label={<span className={css`\n                        margin-left: 4px;\n                        font-size: 14px;\n                        line-height: 32px;\n                    `}>Selected fields</span>} isOpen={true}>\n                    <div\n                        className={css`\n                            width: 100%;\n                        `}\n                    >\n                        {hasSelectedFields ? (\n                            <div\n                                className={css`\n                                    width: 100%;\n                                `}\n                            >\n                                {selectedFields\n                                    .filter((field: any) => {\n                                        return field['Field'].toLowerCase().includes(searchValue.toLowerCase());\n                                    })\n                                    .map((field: any, index) => (\n                                        <FieldItem type=\"remove\" key={index} field={field} onRemove={field => handleRemove(field)} />\n                                    ))}\n                            </div>\n                        ) : (\n                            <Button\n                                icon=\"arrow\"\n                                size=\"sm\"\n                                variant=\"secondary\"\n                                fill=\"text\"\n                                fullWidth={true}\n                                className={css`\n                                    width: 100%;\n                                    text-align: left;\n                                    justify-content: flex-start;\n                                `}\n                            >\n                                _source\n                            </Button>\n                        )}\n                    </div>\n                </CollapsableSection>\n                <CollapsableSection label={<span className={css`\n                        margin-left: 4px;\n                        font-size: 14px;\n                        line-height: 32px;\n                    `}>Available fields</span>}  isOpen={true}>\n                    <div\n                        className={css`\n                            width: 100%;\n                        `}\n                    >\n                        {availableFields\n                            .filter((field: any) => {\n                                return field['Field'].toLowerCase().includes(searchValue.toLowerCase());\n                            })\n                            .map((field: any, index) => (\n                                <FieldItem type=\"add\" field={field} key={index} onAdd={field => handleAdd(field)} />\n                            ))}\n                    </div>\n                </CollapsableSection>\n            </div>\n        </div>\n    );\n}\n","import ReactECharts from 'echarts-for-react';\nimport { useAtom, useAtomValue, useSetAtom } from 'jotai';\nimport React, { useEffect, useRef, useState } from 'react';\nimport dayjs from 'dayjs';\nimport { Select, useTheme2 } from '@grafana/ui';\nimport { IntervalEnum } from 'types/type';\nimport { TIME_INTERVALS } from 'utils/data';\nimport { getAutoInterval, FORMAT_DATE, translationDateIntervalType } from '../../constants';\nimport { currentDateAtom, discoverCurrentAtom, activeShortcutAtom, tableDataChartsAtom, intervalAtom, tableTotalCountAtom, pageSizeAtom, pageAtom, timeRangeAtom } from 'store/discover';\nimport { css } from '@emotion/css';\n\nexport function DiscoverHistogram() {\n    const theme = useTheme2().isDark ? 'dark' : 'light';\n    const [currentDate, setCurrentDate] = useAtom(currentDateAtom);\n    const ReactEChartsInstance = useRef<ReactECharts>(null);\n    const [discoverCurrent, setDiscoverCurrent] = useAtom(discoverCurrentAtom);\n    const setActiveItem = useSetAtom(activeShortcutAtom);\n\n    const tableDataCharts = useAtomValue(tableDataChartsAtom);\n    if (process.env.NODE_ENV !== 'production') {\n        tableDataChartsAtom.debugLabel = 'tableDataCharts';\n    }\n    const [interval_value, setInterval_value] = useState(1);\n    const [interval, setInterval] = useAtom(intervalAtom);\n    if (process.env.NODE_ENV !== 'production') {\n        intervalAtom.debugLabel = 'interval';\n    }\n    const tableTotalCount = useAtomValue(tableTotalCountAtom);\n    const [_timeRange, setTimeRange] = useAtom(timeRangeAtom);\n    const [_pageSize, setPageSize] = useAtom(pageSizeAtom);\n    const setPage = useSetAtom(pageAtom);\n\n    useEffect(() => {\n        const v = getAutoInterval(currentDate as any).interval_value;\n        setInterval_value(v);\n    }, [currentDate]);\n\n    const timeInterval = interval === IntervalEnum.Auto ? translationDateIntervalType(interval) : `${interval_value} ${translationDateIntervalType(interval)}`;\n\n    let base = +new Date(1988, 9, 3);\n    let oneDay = 24 * 3600 * 1000;\n    let data = [[base, Math.random() * 300]];\n    for (let i = 1; i < 20000; i++) {\n        let now = new Date((base += oneDay));\n        data.push([+now, Math.round((Math.random() - 0.5) * 20 + data[i - 1][1])]);\n    }\n\n    const options: any = {\n        title: {\n            subtext: `${`Time Interval`}: ${timeInterval}`,\n            left: 'right',\n            top: 12,\n        },\n        grid: {\n            left: '32px',\n            right: '32px',\n            bottom: '0px',\n            containLabel: true,\n        },\n        color: theme === 'light' ? ['#608DFF'] : ['#608DFF'],\n        xAxis: {\n            type: 'category',\n            data: tableDataCharts.map(e => e['TT']),\n            axisLabel: {\n                fontSize: '12px', // \n                fontStyle: 'normal',\n                fontWeight: 400,\n                color: theme === 'light' ? '#9F9FA2' : '#5F5F64',\n            },\n            axisLine: {\n                lineStyle: {\n                    width: 0.5,\n                    color: theme === 'light' ? '#BFBFC1' : '#3F3F45',\n                },\n            },\n            axisTick: {\n                show: false,\n            },\n        },\n        toolbox: {\n            show: false,\n        },\n        brush: {\n            xAxisIndex: 0,\n        },\n        yAxis: {\n            name: `Count`,\n            nameTextStyle: {\n                align: 'right',\n                padding: [5, 0],\n            },\n            type: 'value',\n            splitLine: {\n                show: true,\n                lineStyle: {\n                    width: 0.5, // \n                    color: theme === 'light' ? '#BFBFC1' : '#3F3F45',\n                },\n            },\n            axisLabel: {\n                fontSize: '12px',\n                fontStyle: 'normal',\n                fontWeight: 400,\n            },\n        },\n        tooltip: {\n            trigger: 'axis',\n            axisPointer: {\n                type: 'line',\n            },\n            padding: 0,\n            borderWidth: 0,\n            backgroundColor: theme === 'light' ? '#ffffff' : 'rgba(63, 63, 69, 0.64)',\n            formatter: function (params: any) {\n                const html = `<div className=\"text-n2\"\n                                       style=\"\n                                          padding: 8px;\n                                          min-width: 120px;\n                                          border-radius: 6px;\n                                          backdrop-filter: blur(12px);\n                                          color: ${theme === 'light' ? '#1F1F26' : '#EFEFF0'};\n                                        \">\n                                      <div style=\"padding-bottom: 4px; border-bottom: 1px solid ${theme === 'light' ? '#DFDFE0' : '#3F3F45'};\">${[params[0].name]}</div>\n                                      <div style=\"padding-top:4px;display: flex;justify-content: space-between;\"><span>Count:</span><span style=\"font-family:DIN Alternate;font-size:14;font-weight:500;\">${[\n                        params[0].value || 0,\n                    ]}</span></div>\n                                  </div>`;\n                return html;\n            },\n        },\n\n        series: [\n            {\n                data: tableDataCharts.map(e => e['sum(cnt)']),\n                type: 'bar',\n                barWidth: '99.3%',\n            },\n        ],\n\n        animation: false,\n    };\n\n    useEffect(() => {\n        const chart = ReactEChartsInstance.current;\n        if (chart && tableDataCharts.length > 0) {\n            const handler = ({ areas }: any) => {\n                if (!areas.length) {\n                    return;\n                }\n                setPage(1);\n                setPageSize(50);\n                setActiveItem(undefined);\n                const [startIndex, endIndex] = (areas[0] as any).coordRange as [startIndex: number, endIndex: number];\n                const timeInterval = interval === IntervalEnum.Auto ? getAutoInterval(currentDate as any).interval_unit : interval;\n                const chartsEndDate = dayjs(new Date(tableDataCharts[endIndex]['TT'])).add(interval_value, timeInterval);\n                console.log('aaa',discoverCurrent);\n                \n                setDiscoverCurrent({\n                    ...discoverCurrent,\n                    date: [dayjs(tableDataCharts[startIndex]['TT']), chartsEndDate],\n                });\n\n                setCurrentDate([dayjs(tableDataCharts[startIndex]['TT']), chartsEndDate]);\n                const timeRange = {\n                    from: dayjs(tableDataCharts[startIndex]['TT']).format(FORMAT_DATE),\n                    to: chartsEndDate.format(FORMAT_DATE),\n                    raw: {\n                        from: dayjs(tableDataCharts[startIndex]['TT']).format(FORMAT_DATE),\n                        to: chartsEndDate.format(FORMAT_DATE),\n                    },\n                };\n                setTimeRange(timeRange);\n                chart.getEchartsInstance().dispatchAction({\n                    type: 'brush',\n                    command: 'clear',\n                    areas: [],\n                });\n            };\n\n            if (chart.ele) {\n                chart.getEchartsInstance().dispatchAction({\n                    type: 'takeGlobalCursor',\n                    key: 'brush',\n                    brushOption: {\n                        brushType: 'lineX',\n                    },\n                });\n                chart.getEchartsInstance().on('brushEnd', handler);\n\n                return () => {\n                    if (chart.ele) {\n                        chart.getEchartsInstance().off('brushEnd', handler);\n                    }\n                };\n            }\n        }\n        return undefined;\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [tableDataCharts]);\n    return (\n        <div className={css`padding: 0 16px;`}>\n            <div\n                className={css`\n                    display: flex;\n                    align-items: center;\n                    justify-content: space-between;\n                `}\n            >\n                <div>\n                    <span className={css`\n                            font-size: 24px;\n                            font-weight: 600;\n                        `}\n                    >\n                        {tableTotalCount ? tableTotalCount.toString().replace(/(\\d)(?=(?:\\d{3})+$)/g, '$1,') : '0'}\n                    </span>{' '}\n                    <span className={css`font-size: 12px;`}>{`hits`}</span>\n                </div>\n                <div className={css`\n                        font-size: 14px;\n                        color: rgb(190,190,193)\n                    `}\n                >{currentDate && `${currentDate[0]?.format(FORMAT_DATE)} ~ ${currentDate[1]?.format(FORMAT_DATE)} `}</div>\n                <div\n                    className={css`\n                        width: 160px;\n                    `}\n                >\n                    <Select\n                        value={interval}\n                        onChange={selectdbInterval => {\n                            setInterval(selectdbInterval.value as any);\n                        }}\n                        options={TIME_INTERVALS}\n                    />\n                </div>\n            </div>\n            <div\n                className={css`\n                    height: 300px;\n                `}\n            >\n                <ReactECharts option={options} ref={ReactEChartsInstance}></ReactECharts>\n            </div>\n        </div>\n    );\n}\n","import React, { Fragment } from 'react';\nimport { ColumnDef, Row, flexRender, getCoreRowModel, getExpandedRowModel, useReactTable } from '@tanstack/react-table';\nimport { EmptySearchResult, useTheme2 } from '@grafana/ui';\nimport { css } from '@emotion/css';\n\ninterface SDCollapsibleTableProps<TData> {\n    data: TData[];\n    columns: Array<ColumnDef<TData>>;\n    renderSubComponent: (props: { row: Row<TData> }) => React.ReactElement;\n    getRowCanExpand: (row: Row<TData>) => boolean;\n    className?: string;\n}\n\nexport default function SDCollapsibleTable<T>(props: SDCollapsibleTableProps<T>) {\n    const { data, columns, renderSubComponent, getRowCanExpand, className } = props;\n    const theme = useTheme2();\n    const table = useReactTable<any>({\n        data,\n        columns,\n        getRowCanExpand,\n        getCoreRowModel: getCoreRowModel(),\n        getExpandedRowModel: getExpandedRowModel(),\n    });\n\n    return (\n        <table className={className}>\n            <thead>\n                {table.getHeaderGroups().map(headerGroup => (\n                    <tr key={headerGroup.id} className={css`${theme.isDark ? 'border-bottom: 1px solid hsl(var(--border-dark));' : 'border-bottom: 1px solid hsl(var(--border));'} `}>\n                        {headerGroup.headers.map(header => {\n                            return (\n                                <th\n                                    key={header.id}\n                                    colSpan={header.colSpan}\n                                    className={css`\n                                            position: sticky;\n                                            top: 0;\n                                            z-index: 2;\n                                            height: 48px; \n                                            white-space: nowrap;\n                                            background-color: ${theme.isLight ? 'hsl(var(--table-header-background)' : 'hsl(var(--table-header-background-dark)'} ); \n                                            padding-left: 16px; \n                                            padding-right: 16px;\n                                            text-align: left;\n                                            vertical-align: middle;\n                                            font-size: 14px;\n                                            font-weight: 500;    \n                                            color: hsl(var(--n2)}  \n\n                                            &:has([role=\"checkbox\"]) {\n                                                padding-right: 0;\n                                            }\n                                        `}\n                                >\n                                    {header.isPlaceholder ? null : flexRender(header.column.columnDef.header, header.getContext())}\n                                </th>\n                            );\n                        })}\n                    </tr>\n                ))}\n            </thead>\n            <tbody\n                className={css`\n                    #selected {\n                        background-color: #3f3f46cc;\n                    }\n                `}\n            >\n                {table.getRowModel().rows.length > 0 ? (\n                    table.getRowModel().rows.map(row => {\n                        return (\n                            <Fragment key={row.id}>\n                                <tr\n                                    id={row.original.selected ? 'selected' : ''}\n                                    // className={classNames(\n                                    //     'transition-colors dark:hover:bg-n7/80 hover:bg-b1/80 data-[state=selected]:bg-muted',\n                                    //     row.getIsExpanded() ? 'border-none' : 'border-b',\n                                    //     row.original.selected ? 'dark:bg-n7 bg-b1/60' : 'hsl(val(--n8))',\n                                    // )}\n                                    className={css`\n                                        ${row.getIsExpanded() ? `border:none;` : `${theme.isDark ? 'border-bottom: 1px solid hsl(var(--border-dark));' : 'border-bottom: 1px solid hsl(var(--border));'} `}\n\n                                        ${theme.isLight ? `\n                                             background-color: ${row.original.selected ? 'hsl(var(--b1) / 0.6)' : 'hsl(val(--n8))'}; \n                                        &:hover {\n                                            background-color: hsl(var(--b1) / 0.8);\n                                        }\n                                            `\n                                            :\n                                            `\n                                            background-color: ${row.original.selected ? 'hsl(var(--n7))' : 'hsl(val(--n8))'}; \n                                            &:hover {\n                                                    background-color: hsl(var(--n7) / 0.8);\n                                                }\n                                            }\n                                            `\n                                        }\n                                    `}\n                                >\n                                    {row.getVisibleCells().map(cell => {\n                                        return (\n                                            <td key={cell.id} className={css`\n                                                height: 48px;\n                                                padding: 0 16px;\n                                                font-size: 14px;\n                                            `} >\n                                                {cell.getContext().getValue() !== null ? flexRender(cell.column.columnDef.cell, cell.getContext()) : '-'}\n                                            </td>\n                                        );\n                                    })}\n                                </tr>\n                                {row.getIsExpanded() && (\n                                    <tr\n                                        //  className=\"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\"\n                                        className={css`\n                                        border-bottom: 1px solid rgb(63,63,70);\n                                        transition-property: background-color, border-color, color, fill, stroke;\n                                        transition-duration: 150ms;\n                                        transition-timing-function: ease-in-out;\n                                        \n                                        &:hover {\n                                            background-color: hsl(var(--muted) / 0.5);\n                                        }\n                                        \n                                        [data-state=\"selected\"] {\n                                            background-color: hsl(var(--muted))\n                                        }\n                                    `}\n                                    >\n                                        <td colSpan={row.getVisibleCells().length} className={css`\n                                                height: 32px;\n                                                padding: 0;\n                                            `}>\n                                            {renderSubComponent({ row })}\n                                        </td>\n                                    </tr>\n                                )}\n                            </Fragment>\n                        );\n                    })\n                ) : (\n                    <tr >\n                        <td colSpan={columns.length}>\n                            <EmptySearchResult>{`No Data`}</EmptySearchResult>\n                        </td>\n                    </tr>\n                )}\n            </tbody>\n        </table>\n    );\n}\n","import { css } from '@emotion/css';\nimport styled from '@emotion/styled';\n\nexport const HoverStyle = css`\n    &:hover {\n        .filter-content {\n            visibility: visible;\n        }\n    }\n`;\n\nexport const ColumnStyleWrapper = styled.div`\n    .field-key {\n        padding: 0px 4px 2px;\n        margin-right: 4px;\n        border-radius: 4px;\n    }\n`;\n","import { IconButton } from '@grafana/ui';\nimport { useAtom, useAtomValue } from 'jotai';\nimport { nanoid } from 'nanoid';\nimport React from 'react';\nimport { selectedFieldsAtom, dataFilterAtom, tableFieldsAtom } from 'store/discover';\nimport { isComplexType } from 'utils/data';\n\nexport function ContentTableActions({ fieldName, fieldValue }: any) {\n    const [selectedFields, setSelectedFields] = useAtom(selectedFieldsAtom);\n    const [dataFilter, setDataFilter] = useAtom(dataFilterAtom);\n    const tableFields = useAtomValue(tableFieldsAtom);\n    const fieldType = tableFields.find(field => field.Field === fieldName)?.Type;\n    const hasField = selectedFields.some((item: any) => item.Field === fieldName);\n    const filterValue = typeof fieldValue === 'object' ? JSON.stringify(fieldValue) : fieldValue;\n    return (\n        <>\n            <div className=\"icons\" style={{ display: 'flex', justifyContent: 'flex-end' }}>\n                {!isComplexType(fieldType) && (\n                    <>\n                        <IconButton\n                            name=\"plus-circle\"\n                            tooltip=\"Equivalent filtration\"\n                            onClick={() => {\n                                setDataFilter([...dataFilter, { fieldName: fieldName, operator: '=', value: [filterValue], id: nanoid() }]);\n                            }}\n                        />\n                        <IconButton\n                            name=\"minus-circle\"\n                            tooltip=\"Nonequivalent filtration\"\n                            onClick={() => {\n                                setDataFilter([...dataFilter, { fieldName: fieldName, operator: '!=', value: [filterValue], id: nanoid() }]);\n                            }}\n                        />\n                    </>\n                )}\n                <IconButton\n                        name=\"plus\"\n                        tooltip={hasField ? 'Delete From Table' : 'Add To Table'}\n                        onClick={() => {\n                            const field = tableFields.find(field => field.Field === fieldName);\n                            if (hasField) {\n                                const index = selectedFields.findIndex((item: any) => item.Field === fieldName);\n                                selectedFields.splice(index, 1);\n                                setSelectedFields([...selectedFields]);\n                            } else {\n                                setSelectedFields([...selectedFields, field]);\n                            }\n                        }}\n                    />\n            </div>\n        </>\n    );\n}\n","import { useAtom } from 'jotai';\nimport { css } from '@emotion/css';\nimport { nanoid } from 'nanoid';\nimport { dataFilterAtom } from 'store/discover';\nimport React from 'react';\nimport { isComplexType } from 'utils/data';\nimport { IconButton } from '@grafana/ui';\n\ninterface ContentItemProps {\n    fieldName: string;\n    fieldValue: string | number;\n    fieldType: string;\n}\n\nexport function ContentItem({ fieldName, fieldValue, fieldType }: ContentItemProps) {\n    const [dataFilter, setDataFilter] = useAtom(dataFilterAtom);\n    return (\n        <div>\n            {!isComplexType(fieldType) && (\n                <div className={css`\n                    display: flex;\n                    alignItems: 'center';\n                    margin-left: 10px;\n                `}>\n                    <IconButton\n                        name=\"plus-circle\"\n                        onClick={e => {\n                            setDataFilter([...dataFilter, { fieldName, operator: '=', value: [fieldValue], id: nanoid() }]);\n                            e.stopPropagation();\n                        }}\n                        tooltip=\"Equivalent filtration\"\n                    />\n                    <IconButton\n                        name=\"minus-circle\"\n                        style={{ marginLeft: '4px' }}\n                        onClick={e => {\n                            setDataFilter([\n                                ...dataFilter,\n                                {\n                                    fieldName,\n                                    operator: '!=',\n                                    value: [fieldValue],\n                                    id: nanoid(),\n                                },\n                            ]);\n                            e.stopPropagation();\n                        }}\n                        tooltip=\"Nonequivalent filtration\"\n                    />\n                </div>\n            )}\n        </div>\n    );\n}\n","import { useAtom } from 'jotai';\nimport { nanoid } from 'nanoid';\nimport { isComplexType } from 'utils/data';\nimport { IconButton } from '@grafana/ui';\nimport React from 'react';\nimport { css } from '@emotion/css';\nimport { surroundingDataFilterAtom } from 'store/discover';\n\ninterface ContentItemProps {\n    fieldName: string;\n    fieldValue: string | number;\n    fieldType: string;\n}\n\nexport function SurroundingContentItem({ fieldName, fieldValue, fieldType }: ContentItemProps) {\n    const [surroundingDataFilter, setSurroundingDataFilter] = useAtom(surroundingDataFilterAtom);\n    return (\n        <div>\n            {!isComplexType(fieldType) && (\n                <div className={css`\n                    display: flex;\n                    alignItems: 'center';\n                    margin-left: 10px;\n                `}>\n                    <IconButton\n                        name=\"plus-circle\"\n                        onClick={e => {\n                            setSurroundingDataFilter([...surroundingDataFilter, { fieldName, operator: '=', value: [fieldValue], id: nanoid() }]);\n                            e.stopPropagation();\n                        }}\n                        tooltip=\"Equivalent filtration\"\n                    />\n                    <IconButton\n                        name=\"minus-circle\"\n                        style={{ marginLeft: '4px' }}\n                        onClick={e => {\n                            setSurroundingDataFilter([\n                                ...surroundingDataFilter,\n                                {\n                                    fieldName,\n                                    operator: '!=',\n                                    value: [fieldValue],\n                                    id: nanoid(),\n                                },\n                            ]);\n                            e.stopPropagation();\n                        }}\n                        tooltip=\"Nonequivalent filtration\"\n                    />\n                </div>\n            )}\n        </div>\n    );\n}\n","import { css } from '@emotion/css';\nimport { Button, IconButton } from '@grafana/ui';\nimport React from 'react';\nimport { useTranslation } from 'react-i18next';\n\ninterface SurroundingLogsActionsProps {\n    getSurroundingData: (params: { time: string }) => void;\n    getSurroundingDataLoading: boolean;\n    time: string;\n    timeFieldPageSize: number;\n    setTimeFieldPageSize: (value: number) => void;\n    tips: string;\n    count: number;\n    type: 'before' | 'after';\n}\n\nexport function SurroundingLogsActions(props: SurroundingLogsActionsProps) {\n    const { getSurroundingData, getSurroundingDataLoading, time, timeFieldPageSize, tips, count, type } = props;\n    const { t } = useTranslation();\n    return (\n        <div\n            className={css`\n                display: flex;\n                align-items: center;\n                justify-content: flex-start;\n            `}\n        >\n            <Button\n                // loading={getSurroundingDataLoading}\n                className=\"font-normal text-n2 hover:text-b7 hover:no-underline\"\n                onClick={() => {\n                    getSurroundingData({ time: time });\n                }}\n                type=\"reset\"\n            >\n                {!getSurroundingDataLoading && (\n                    <>{type === 'before' ? <IconButton name=\"arrow-up\" aria-label={`Load After`} /> : <IconButton name=\"arrow-down\" aria-label={`Load Before`} />}</>\n                )}\n                {`Load`} {timeFieldPageSize} {t`Items`}\n            </Button>\n            <div\n                className={css`\n                    margin-left: 8px;\n                `}\n            >\n                {count} {`Items`} {` `}\n                {tips}\n            </div>\n        </div>\n    );\n}\n","import { css } from '@emotion/css';\nimport styled from '@emotion/styled';\n\nexport const DiscoverFilterWrapper = styled.div`\n    display: flex;\n    align-items: center;\n    .filter {\n        align-self: flex-start;\n        margin-top: 3px;\n        margin-right: 8px;\n        font-weight: 500;\n        font-size: 14px;\n        font-style: normal;\n        line-height: 18px;\n    }\n    .filter-tag {\n        display: flex;\n        flex: 1;\n        flex-wrap: wrap;\n        align-items: center;\n        row-gap: 8px;\n        .tag {\n            display: flex;\n            align-items: center;\n            max-width: 400px;\n            height: 24px;\n            padding: 2px 8px;\n            font-weight: 400;\n            font-size: 12px;\n            font-style: normal;\n            line-height: 18px;\n            border: 0px;\n            border-radius: 6px;\n            .text {\n                overflow: hidden;\n                white-space: nowrap;\n                text-overflow: ellipsis;\n            }\n        }\n    }\n`;\n\nexport const containerStyle = css`\n    width: 320px;\n`;\n\nexport const rowStyle = css`\n    display: flex;\n    gap: 8px;\n    margin-bottom: 12px;\n`;\n\nexport const colStyle = css`\n    flex: 1;\n`;\n\nexport const footerStyle = css`\n    display: flex;\n    justify-content: flex-end;\n    gap: 8px;\n    margin-top: 16px;\n`;\n","import { useAtom, useAtomValue } from 'jotai';\nimport React from 'react';\nimport { nanoid } from 'nanoid';\nimport { Select, InlineField, InlineFieldRow, InlineSwitch, Button, Input, Field } from '@grafana/ui';\nimport { tableFieldsAtom, tableFieldValuesAtom, surroundingDataFilterAtom, tableDataAtom, indexesAtom } from 'store/discover';\nimport { Operator } from 'types/type';\nimport { OPERATORS, getFieldType } from 'utils/data';\nimport { Controller, useForm } from 'react-hook-form';\nimport { containerStyle, rowStyle, colStyle, footerStyle } from './discover-filter.style';\nimport { FilterContentProps } from '../types';\nimport { uniqBy } from 'lodash-es';\n\nexport function FilterContent(props: FilterContentProps) {\n    const { onHide, dataFilterValue } = props;\n    const [surroundingDataFilter, setSurroundingDataFilter] = useAtom(surroundingDataFilterAtom);\n    const tableFields = useAtomValue(tableFieldsAtom);\n    const indexes = useAtomValue(indexesAtom);\n    if (process.env.NODE_ENV !== 'production') {\n        // add a debug label for dev to help with jotai debugging\n        // @ts-ignore\n        surroundingDataFilterAtom.debugLabel = 'surroundingDataFilter';\n    }\n    const [tableFieldValue, setTableFieldValue] = useAtom(tableFieldValuesAtom);\n    const tableData = useAtomValue(tableDataAtom);\n\n    const {\n        control,\n        handleSubmit,\n        watch,\n        register,\n        setValue,\n        formState: { errors },\n    } = useForm({\n        defaultValues: {\n            field: {\n                label: dataFilterValue?.fieldName,\n                value: dataFilterValue?.fieldName,\n            },\n            operator: {\n                label: dataFilterValue?.operator,\n                value: dataFilterValue?.operator,\n            },\n            value: dataFilterValue?.value,\n            minValue: Array.isArray(dataFilterValue?.value) ? dataFilterValue?.value[0] : '',\n            maxValue: Array.isArray(dataFilterValue?.value) ? dataFilterValue?.value[1] : '',\n            label: dataFilterValue?.label || '',\n            showLabel: !!dataFilterValue?.label, // Initialize based on dataFilterValue\n        },\n    });\n    const field: any = watch('field');\n    const operator: any = watch('operator');\n    const showLabel: any = watch('showLabel');\n\n\n    const getValue = (value: string): string | number => (isNaN(+value) ? value : +value);\n\n    // use centralized getFieldType from utils\n    const selectedFieldType = React.useMemo(() => {\n        const fieldName = typeof field === 'string' ? field : field?.value;\n        if (!fieldName) {\n            return '';\n        }\n        const tf = tableFields.find((f: any) => f.Field === fieldName);\n        return getFieldType(tf?.Type);\n    }, [field, tableFields]);\n\n    const isNumberField = selectedFieldType === 'NUMBER';\n    const isBooleanField = selectedFieldType === 'BOOLEAN';\n    const isTimeField = selectedFieldType === 'DATE';\n\n    // Normalize OPERATORS to the form {label, value} and filter out inapplicable operators based on field type.\n    const operatorOptions = React.useMemo(() => {\n        const normalized = ((OPERATORS || []) as any[]).map(op => ({ label: (op && op.label) || op, value: (op && op.value) || op }));\n        // match_* operators require doris inverted index. Keep LIKE/NOT LIKE available for string-like fields\n        const matchOnlyOps = ['match_all', 'match_any', 'match_phrase', 'match_phrase_prefix'];\n\n        if (isBooleanField) {\n            // BOOLEAN should only allow equality and null checks\n            const allowed = new Set(['=', '!=', 'is null', 'is not null']);\n            return normalized.filter(opItem => allowed.has(String(opItem.value)));\n        }\n\n        const isNumberOrTime = isNumberField || isTimeField;\n        if (isNumberOrTime) {\n            // remove text match ops (including LIKE/NOT LIKE and match_*) for number or time fields\n            return normalized.filter(opItem => {\n                const v = String(opItem.value).toLowerCase();\n                return !(v === 'like' || v === 'not like' || matchOnlyOps.includes(v));\n            });\n        }\n\n        // non-number, non-boolean, non-time fields: keep full list but gate match_* on inverted index\n        try {\n            const fieldName = typeof field === 'string' ? field : field?.value;\n            if (!fieldName) {\n                return normalized;\n            }\n            if (!isNumberField && !isBooleanField && !isTimeField) {\n                const hasInverted = Array.isArray(indexes) && indexes.some((idx: any) => {\n                    if (!idx || !idx.columnName) {\n                        return false;\n                    }\n                    const t = idx.type || '';\n                    return String(idx.columnName) === String(fieldName) && t.toUpperCase().includes('INVERT');\n                });\n\n                if (!hasInverted) {\n                    // remove only the match_* operators; allow LIKE/NOT LIKE to remain\n                    return normalized.filter(opItem => {\n                        const v = String(opItem.value).toLowerCase();\n                        return !matchOnlyOps.includes(v);\n                    });\n                }\n            }\n        } catch (e) {\n            // fallback to full list\n        }\n\n        return normalized;\n     }, [isNumberField, isBooleanField, isTimeField, field, indexes]);\n\n    // Convert an input value according to current field type.\n    // Preserve explicit empty string ('') so users can set an empty-string value.\n    const convertValue = (v: any): any => {\n        // Preserve explicit empty string so the user can set ''\n        if (v === '')  {\n            return '';\n        }\n        if (v === undefined || v === null) {\n            return v;\n        }\n\n        // If array, convert each element\n        if (Array.isArray(v)) {\n            return v.map(convertValue);\n        }\n\n        // Handle booleans\n        if (v === true || v === 'true') {\n            return true;\n        }\n        if (v === false || v === 'false') {\n            return false;\n        }\n\n        // Prefer field-type-based conversion when possible\n        if (isNumberField) {\n            return getValue(String(v));\n        }\n\n        // NOTE: only convert to Number when the field type is numeric. For non-number fields\n        // preserve the original string so values like '00123' remain strings.\n\n        return v;\n    };\n\n    const onSubmit = (formValues: any) => {\n        const { field, operator: opField, value, minValue, maxValue, label, showLabel } = formValues;\n        const current = surroundingDataFilter.find(f => f.id === dataFilterValue?.id);\n        const id = dataFilterValue?.id || nanoid();\n\n        // The compatible operator could be string or {label, value}.\n        const opValue = typeof opField === 'string' ? opField : opField?.value;\n\n        let newValue: any[] = [];\n\n        if (opValue === 'between' || opValue === 'not between') {\n            // Use convertValue so numbers/booleans are properly typed; preserve empty strings if provided\n            if ((minValue !== undefined && minValue !== '') && (maxValue !== undefined && maxValue !== '')) {\n                newValue = [convertValue(minValue), convertValue(maxValue)];\n            }\n        } else if (value !== undefined) {\n            // accept empty string, 0 and other falsy numeric values.\n            if (Array.isArray(value)) {\n                newValue = value.map(v => convertValue(v));\n            } else {\n                newValue = [convertValue(value)];\n            }\n        }\n\n        const newItem = {\n            id,\n            fieldName: field.value,\n            operator: opValue,\n            // Only persist label when showLabel is true. Otherwise ensure it's empty.\n            label: showLabel ? label : '',\n            value: newValue,\n        };\n\n        if (current) {\n            const updated = surroundingDataFilter.map(f => (f.id === id ? newItem : f));\n            setSurroundingDataFilter(updated);\n        } else {\n            setSurroundingDataFilter([...surroundingDataFilter, newItem]);\n        }\n\n        onHide();\n    };\n\n    // When user turns off the Custom Label switch, clear the label form value so it won't persist.\n    React.useEffect(() => {\n        // watch 'showLabel' via the form's watch above; this effect runs when showLabel changes\n        // but we need access to the current 'showLabel' value - use watch above.\n        const currentShowLabel = (watch as any)('showLabel');\n        if (!currentShowLabel) {\n            // Clear the label in the form state so it won't be saved or re-displayed.\n            setValue('label', '');\n\n            // If we're editing an existing filter, also remove the label from the stored filter\n            // so the filter chip/list updates immediately and the switch remains off when reopened.\n            if (dataFilterValue?.id) {\n                setSurroundingDataFilter(prev => {\n                    let changed = false;\n                    const updated = prev.map(f => {\n                        if (f.id === dataFilterValue.id) {\n                            if (f.label) {\n                                changed = true;\n                                return { ...f, label: '' };\n                            }\n                            return f;\n                        }\n                        return f;\n                    });\n                    return changed ? updated : prev;\n                });\n            }\n        }\n        // We only want this effect to run when the form's showLabel changes or when editing a different filter\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [watch, setValue, dataFilterValue?.id, setSurroundingDataFilter]);\n\n    function renderFiledComponent() {\n        const currentOperator = (typeof operator === 'string' ? operator : operator?.value) as Operator | undefined;\n        if (currentOperator && currentOperator !== 'is null' && currentOperator !== 'is not null' && (currentOperator === 'between' || currentOperator === 'not between')) {\n            return (\n                <div className={rowStyle}>\n                    <div className={colStyle}>\n                        <Field label=\"Min Value\" invalid={!!errors.minValue} error={errors.minValue?.message}>\n                            <Input {...register('minValue', { required: 'Enter the minValue' })} />\n                        </Field>\n                    </div>\n                    <div className={colStyle}>\n                        <Field label=\"Max Value\" invalid={!!errors.maxValue} error={errors.maxValue?.message}>\n                            <Input {...register('maxValue', { required: 'Enter the maxValue' })} />\n                        </Field>\n                    </div>\n                </div>\n            );\n        }\n        if (\n            currentOperator === '=' ||\n            currentOperator === '!=' ||\n            currentOperator === 'like' ||\n            currentOperator === 'not like' ||\n            currentOperator === 'match_all' ||\n            currentOperator === 'match_any' ||\n            currentOperator === 'match_phrase' ||\n            currentOperator === 'match_phrase_prefix'\n        ) {\n            return (\n                <>\n                    <Field label=\"Value\" invalid={!!errors.value} error={(errors.value as any)?.message}>\n                        {/* Allow empty string as a valid value: treat undefined as missing but accept '' */}\n                        <Input {...register('value', { validate: (v: any) => v !== undefined || 'Enter the value' })} />\n                    </Field>\n                 </>\n            );\n        }\n        if (currentOperator === 'in' || currentOperator === 'not in') {\n            return (\n                <Field label=\"Value\" invalid={!!errors.value} error={(errors.value as any)?.message}>\n                    <Controller\n                        name=\"value\"\n                        control={control}\n                        rules={{ required: 'Enter the value' }}\n                        render={({ field }) => (\n                            <Select\n                                {...field}\n                                isMulti={true}\n                                options={tableFieldValue.map(item => ({\n                                    label: item.value,\n                                    value: item.value,\n                                }))}\n                                placeholder=\"Select value\"\n                                onChange={selected => field.onChange(selected ? selected.map((s: any) => s.value) : [])}\n                                value={tableFieldValue\n                                    .filter(item => Array.isArray(field.value) && field.value.includes(item.value))\n                                    .map(item => ({\n                                        label: item.value,\n                                        value: item.value,\n                                    }))}\n                            />\n                        )}\n                    />\n                </Field>\n            );\n        }\n        return <></>;\n    }\n\n    return (\n        <form onSubmit={handleSubmit(onSubmit)} className={containerStyle}>\n            <div className={rowStyle}>\n                <div className={colStyle}>\n                    <Field label=\"Columns\" invalid={!!errors.field} error={(errors.field as any)?.message}>\n                        <Controller\n                            name=\"field\"\n                            control={control}\n                            rules={{ required: 'Select Field' }}\n                            render={({ field }) => (\n                                <Select\n                                    {...field}\n                                    onChange={(selected) => {\n                                        // Only update tableFieldValue when we actually have table data and a selected field\n                                        if (selected?.value && Array.isArray(tableData) && tableData.length > 0) {\n                                            setTableFieldValue(\n                                                uniqBy(\n                                                    tableData.map((item) => ({\n                                                        label: selected.value,\n                                                        value: item._original[selected.value],\n                                                    })),\n                                                    'value',\n                                                ),\n                                            );\n                                        } else {\n                                            setTableFieldValue([]);\n                                        }\n                                        field.onChange(selected);\n                                    }}\n                                    options={tableFields.map(f => ({\n                                        label: f.Field,\n                                        value: f.Field,\n                                    }))}\n                                />\n                            )}\n                        />\n                    </Field>\n                </div>\n                <div className={colStyle}>\n                    <Field label=\"Operator\" invalid={!!errors.operator} error={(errors.operator as any)?.message}>\n                        <Controller\n                            name=\"operator\"\n                            control={control}\n                            rules={{ required: 'Select Operator' }}\n                            render={({ field }) => (\n                                <Select\n                                    {...field}\n                                    options={operatorOptions}\n                                />\n                            )}\n                        />\n                    </Field>\n                </div>\n            </div>\n\n            {renderFiledComponent()}\n\n            <InlineFieldRow>\n                <InlineField label=\"Custom Label\">\n                    <Controller name=\"showLabel\" control={control} render={({ field }) => <InlineSwitch {...field} />}></Controller>\n                </InlineField>\n            </InlineFieldRow>\n\n            {showLabel && (\n                <Field invalid={!!errors.label} error={errors.label?.message}>\n                    <Input {...register('label', { required: 'Please enter label' })} />\n                </Field>\n            )}\n\n            <div className={footerStyle}>\n                <Button\n                    variant=\"secondary\"\n                    onClick={e => {\n                        e.preventDefault();\n                        onHide();\n                    }}\n                >\n                    Cancel\n                </Button>\n                <Button type=\"submit\">Confirm</Button>\n            </div>\n        </form>\n    );\n}\n\n","import React, { useRef, useState } from 'react';\nimport { DiscoverFilterWrapper } from './discover-filter.style';\nimport { useTranslation } from 'react-i18next';\nimport { useAtom } from 'jotai';\nimport { FilterContent } from './filter-content';\nimport { surroundingDataFilterAtom } from 'store/discover';\nimport { getFilterSQL } from 'utils/data';\nimport { css } from '@emotion/css';\nimport { Badge, Icon, IconButton, Toggletip, useTheme2 } from '@grafana/ui';\nimport { DiscoverFilterProps } from '../types';\n\nexport default function SurroundingDiscoverFilter(props: DiscoverFilterProps) {\n    const [surroundingDataFilter, setSurroundingDataFilter] = useAtom(surroundingDataFilterAtom);\n    const [open, setOpen] = useState<boolean>(false);\n    const [dataFilterOpen, setDataFilterOpen] = useState<any>({});\n    const discoverFilterRef = useRef(null);\n    const { t } = useTranslation();\n    const theme = useTheme2();\n\n    console.log('surroundingDataFilter', surroundingDataFilter);\n\n    return (\n        <DiscoverFilterWrapper\n            ref={discoverFilterRef}\n            className={css`\n                background-color: ${theme.isDark ? 'rgb(24, 27, 31)' : '#FFF'};\n                padding: 1rem;\n                padding-bottom: 1.5rem;\n                margin-top: 1px;\n                border-radius: 0 0 0.25rem 0.25rem;\n            `}\n        >\n            <div className=\"text-xs font-medium\">{t`Filter`}</div>\n            <div className=\"filter-tag\">\n                {surroundingDataFilter.map((dataFilterValue, index) => {\n                    return (\n                        <div\n                            key={index.toString()}\n                            className={css`\n                                margin-left: 8px;\n                            `}\n                        >\n                            <Toggletip\n                                show={dataFilterOpen[dataFilterValue.id]}\n                                onOpen={() => {\n                                    setDataFilterOpen({\n                                        ...dataFilterOpen,\n                                        [dataFilterValue.id]: true,\n                                    });\n                                }}\n                                onClose={() => {\n                                    setDataFilterOpen({\n                                        ...dataFilterOpen,\n                                        [dataFilterValue.id]: false,\n                                    });\n                                }}\n                                closeButton={true}\n                                content={\n                                    <FilterContent\n                                        onHide={() => {\n                                            setDataFilterOpen({\n                                                ...dataFilterOpen,\n                                                [dataFilterValue.id]: false,\n                                            });\n                                        }}\n                                        dataFilterValue={dataFilterValue}\n                                    />\n                                }\n                                placement=\"bottom\"\n                            >\n                                <div>\n                                    <Badge\n                                        key={index}\n                                        text={\n                                            <div\n                                                className={css`\n                                                    display: flex;\n                                                    align-items: center;\n                                                    justify-content: space-between;\n                                                `}\n                                            >\n                                                <span>{dataFilterValue.label ? <span>{dataFilterValue.label}</span> : <span>{getFilterSQL(dataFilterValue)}</span>}</span>\n                                                <div\n                                                    className={css`\n                                                        margin-left: 0.5rem;\n                                                        cursor: pointer;\n                                                    `}\n                                                    onClick={() => {\n                                                        const data_filters = surroundingDataFilter.filter(e => e !== dataFilterValue) || [];\n                                                        console.log('data_filters', data_filters);\n                                                        setSurroundingDataFilter(data_filters);\n                                                        // setLoc(prev => {\n                                                        //     const searchParams = prev.searchParams;\n                                                        //     searchParams?.set('data_filters', JSON.stringify(data_filters));\n                                                        //     return {\n                                                        //         ...prev,\n                                                        //         searchParams,\n                                                        //     };\n                                                        // });\n                                                    }}\n                                                >\n                                                    <Icon name=\"times\" />\n                                                </div>\n                                            </div>\n                                        }\n                                        color=\"blue\"\n                                    ></Badge>\n                                </div>\n                            </Toggletip>\n                        </div>\n                    );\n                })}\n                <Toggletip\n                    show={open}\n                    closeButton={false}\n                    onOpen={() => {\n                        setOpen(true);\n                    }}\n                    content={\n                        <FilterContent\n                            onHide={() => {\n                                console.log('onHide');\n                                setOpen(false);\n                            }}\n                        />\n                    }\n                    placement=\"bottom\"\n                >\n                    <IconButton name=\"plus\" tooltip=\"Add filter\" style={{ marginLeft: 10 }} />\n                </Toggletip>\n            </div>\n        </DiscoverFilterWrapper>\n    );\n}\n","import { QueryTableDataParams, DataFilterType, SurroundingParams } from 'types/type';\n\nexport function getQueryTableResultSQL(params: QueryTableDataParams) {\n    const indexesStatement = params.indexes_statement;\n    let statement = `SELECT * FROM \\`${params.database}\\`.\\`${params.table}\\` WHERE`;\n\n    if (indexesStatement && params.search_type === 'Search') {\n        statement += ` (${indexesStatement}) AND`;\n    }\n\n    // timeField \n    statement += ` (\\`${params.timeField}\\` BETWEEN '${params.startDate}' AND '${params.endDate}') `;\n\n    statement = params.data_filters.reduce((prev, curr) => {\n        return addSqlFilter(prev, curr);\n    }, statement);\n\n    if (params.search_type === 'SQL' && params.search_value) {\n        statement = statement + ` AND ${params.search_value}`;\n    }\n\n    if (params.search_type === 'Lucene' && params.lucene_where) {\n        statement = statement + ` AND (${params.lucene_where})`;\n    }\n\n    // ORDER BY  timeField \n    statement = statement + ` ORDER BY \\`${params.timeField}\\` DESC LIMIT ${+params.page_size} OFFSET ${(+params?.page - 1) * params.page_size} `;\n\n    return statement;\n}\n\nexport function getQueryTableChartsSQL(params: QueryTableDataParams) {\n    const indexes = params.indexes;\n    let statement = `SELECT ${params.interval}_FLOOR(table_per_time.T,${params.interval_value}) as TT,sum(table_per_time.cnt) FROM (SELECT ${params.interval}_FLOOR(${params.timeField}) as T,count(*) as cnt FROM \\`${params.database}\\`.\\`${params.table}\\` WHERE`;\n    if (indexes && params.search_type === 'Search') {\n        statement += ` (${indexes}) AND`;\n    }\n    statement += ` (\\`${params.timeField}\\` between '${params.startDate}' AND '${params.endDate}') `;\n    if (params.data_filters.length > 0) {\n        statement = params.data_filters.reduce((prev, curr) => {\n            return addSqlFilter(prev, curr);\n        }, statement);\n    }\n    if (params.search_type === 'SQL' && params.search_value) {\n        statement = statement + ` ` + `AND ${params.search_value}`;\n    }\n\n    if (params.search_type === 'Lucene' && params.lucene_where) {\n        statement = statement + ` AND (${params.lucene_where})`;\n    }\n    statement = statement + ` ` + `GROUP BY T ORDER BY T) as table_per_time GROUP BY TT ORDER BY TT`;\n\n    return statement;\n}\n\nexport function getQueryTableResultCountSQL(params: QueryTableDataParams) {\n    const indexes = params.indexes;\n    let statement = `SELECT SUM(table_per_time.cnt) AS total_count\n        FROM (\n          SELECT ${params.interval}_FLOOR(${params.timeField}) as T, COUNT(*) as cnt\n          FROM \\`${params.database}\\`.\\`${params.table}\\`\n          WHERE`;\n    if (indexes && params.search_type === 'Search') {\n        statement += ` (${indexes}) AND`;\n    }\n    statement += ` (\\`${params.timeField}\\` between '${params.startDate}' AND '${params.endDate}')`;\n\n    if (params.data_filters.length > 0) {\n        statement = params.data_filters.reduce((prev, curr) => {\n            return addSqlFilter(prev, curr);\n        }, statement);\n    }\n    if (params.search_type === 'SQL' && params.search_value) {\n        statement = statement + ` ` + `AND ${params.search_value}`;\n    }\n\n    if (params.search_type === 'Lucene' && params.lucene_where) {\n        statement = statement + ` AND (${params.lucene_where})`;\n    }\n    statement = statement + ` ` + `GROUP BY T) AS table_per_time;`;\n    return statement;\n}\n\nexport function getSurroundingSQL(params: SurroundingParams) {\n    let statement = `SELECT * FROM \\`${params.database}\\`.\\`${params.table}\\` WHERE`;\n    statement += ` (\\`${params.timeField}\\` ${params.operator} '${params.time}')`;\n    statement = params.data_filters.reduce((prev: any, curr: any) => {\n        return addSqlFilter(prev, curr);\n    }, statement);\n    const orderSymbol = params.operator === '<' ? 'DESC' : 'ASC';\n    statement = statement + ` ` + `ORDER BY \\`${params.timeField}\\` ${orderSymbol} LIMIT ${+params.pageSize}`;\n    return statement;\n}\n\nexport function getFilterSQL({ fieldName, operator, value }: DataFilterType): string {\n    const valueString = value.map(e => {\n        if (typeof e === 'string') {\n            return `'${e}'`;\n        } else {\n            return e;\n        }\n    });\n\n    const transformedFieldName = transformFieldPath(fieldName);\n\n    if (\n        operator === '=' ||\n        operator === '!=' ||\n        operator === 'like' ||\n        operator === 'not like' ||\n        operator === 'match_all' ||\n        operator === 'match_any' ||\n        operator === 'match_phrase' ||\n        operator === 'match_phrase_prefix'\n    ) {\n        return `${transformedFieldName} ${operator} ${valueString[0]}`;\n    }\n\n    if (operator === 'is null' || operator === 'is not null') {\n        return `${transformedFieldName} ${operator}`;\n    }\n\n    if (operator === 'between' || operator === 'not between') {\n        return `${transformedFieldName} ${operator} ${valueString[0]} AND ${valueString[1]}`;\n    }\n\n    if (operator === 'in' || operator === 'not in') {\n        return `${transformedFieldName} ${operator} ('${valueString}')`;\n    }\n\n    return '';\n}\n\nexport function addSqlFilter(sql: string, dataFilterValue: DataFilterType): string {\n    let result = sql;\n    if (!sql.toUpperCase().includes('WHERE')) {\n        result += ' WHERE';\n    } else {\n        result += ' AND';\n    }\n\n    result += ` (${getFilterSQL(dataFilterValue)})`;\n\n    return result;\n}\n\nexport function transformFieldPath(fieldPath: string): string {\n    const parts = fieldPath.split('.');\n    return (\n        parts[0] +\n        parts\n            .slice(1)\n            .map(part => `['${part}']`)\n            .join('')\n    );\n}\n","import { getBackendSrv } from '@grafana/runtime';\nimport { getQueryTableChartsSQL, getQueryTableResultCountSQL, getQueryTableResultSQL, getSurroundingSQL } from './sql';\n\nexport function getTableDataService(payload: any) {\n    const { selectdbDS, ...rest } = payload;\n    const QueryTableResultSQL = getQueryTableResultSQL(rest);\n    const response = getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getTableData',\n                    datasource: {\n                        type: 'mysql',\n                        uid: selectdbDS.uid,\n                    },\n                    rawSql: QueryTableResultSQL,\n                    format: 'table',\n                },\n            ],\n        },\n        credentials: 'include',\n    });\n    return response;\n}\n\nexport function getTableDataChartsService(payload: any) {\n    const { selectdbDS, ...rest } = payload;\n    const QueryTableChartsSQL = getQueryTableChartsSQL(rest);\n    const response = getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getTableDataCharts',\n                    datasource: {\n                        type: 'mysql',\n                        uid: selectdbDS.uid,\n                    },\n                    rawSql: QueryTableChartsSQL,\n                    format: 'table',\n                },\n            ],\n        },\n        credentials: 'include',\n    });\n    return response;\n}\n\nexport function getTopDataService(payload: any) {\n    const { selectdbDS, ...rest } = payload;\n    const QueryTableResultSQL = getQueryTableResultSQL(rest);\n    const response = getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getTableTopData',\n                    datasource: {\n                        type: 'mysql',\n                        uid: selectdbDS.uid,\n                    },\n                    rawSql: QueryTableResultSQL,\n                    format: 'table',\n                },\n            ],\n        },\n        credentials: 'include',\n    });\n    return response;\n}\n\nexport function getTableDataCountService(payload: any) {\n    const { selectdbDS, ...rest } = payload;\n    const QueryTableResultCountSQL = getQueryTableResultCountSQL(rest);\n    const response = getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getTableCountData',\n                    datasource: {\n                        type: 'mysql',\n                        uid: selectdbDS.uid,\n                    },\n                    rawSql: QueryTableResultCountSQL,\n                    format: 'table',\n                },\n            ],\n        },\n        credentials: 'include',\n    });\n    return response;\n}\n\n\nexport function getSurroundingDataService(payload: any) {\n    const { selectdbDS, ...rest } = payload;\n    const surroundingSQL = getSurroundingSQL(rest);\n    const response = getBackendSrv().fetch({\n        url: '/api/ds/query',\n        method: 'POST',\n        data: {\n            queries: [\n                {\n                    refId: 'getSurroundingData',\n                    datasource: {\n                        type: 'mysql',\n                        uid: selectdbDS.uid,\n                    },\n                    rawSql: surroundingSQL,\n                    format: 'table',\n                },\n            ],\n        },\n        credentials: 'include',\n    });\n    return response;\n}\n\n","\nimport { useAtom, useAtomValue } from 'jotai';\nimport { nanoid } from 'nanoid';\nimport { IconButton } from '@grafana/ui';\nimport React from 'react';\nimport { surroundingDataFilterAtom, tableFieldsAtom } from 'store/discover';\nimport { isComplexType } from 'utils/data';\nimport { css } from '@emotion/css';\n\nexport function SurroundingContentTableActions({ fieldName, fieldValue }: any) {\n    console.log(fieldName, fieldValue);\n    // const [selectedSurroundingFields, setSelectedSurroundingFields] = useAtom(surroundingSelectedFieldsAtom);\n    const [surroundingDataFilter, setSurroundingDataFilter] = useAtom(surroundingDataFilterAtom);\n    const tableFields = useAtomValue(tableFieldsAtom);\n    const fieldType = tableFields.find(field => field.Field === fieldName).Type;\n    // const hasField = selectedSurroundingFields.some((item: any) => item.Field === fieldName);\n    // const filterValue = typeof fieldValue === 'object' ? JSON.stringify(fieldValue) : fieldValue;\n    return (\n        <>\n            <div className=\"icons\" style={{ display: 'flex', justifyContent: 'flex-end' }}>\n                {!isComplexType(fieldType) && (\n                    <div\n                        className={css`\n                            display: flex;\n                            align-items: 'center';\n                            margin-left: 10px;\n                        `}\n                    >\n                        <IconButton\n                            name=\"plus-circle\"\n                            onClick={e => {\n                                console.log(e);\n                                setSurroundingDataFilter([...surroundingDataFilter, { fieldName, operator: '=', value: [fieldValue], id: nanoid() }]);\n                                e.stopPropagation();\n                            }}\n                            tooltip=\"Equivalent filtration\"\n                        />\n                        <IconButton\n                            name=\"minus-circle\"\n                            style={{ marginLeft: '4px' }}\n                            onClick={e => {\n                                console.log(e);\n                                setSurroundingDataFilter([\n                                    ...surroundingDataFilter,\n                                    {\n                                        fieldName,\n                                        operator: '!=',\n                                        value: [fieldValue],\n                                        id: nanoid(),\n                                    },\n                                ]);\n                                e.stopPropagation();\n                            }}\n                            tooltip=\"Nonequivalent filtration\"\n                        />\n                    </div>\n                )}\n            </div>\n        </>\n    );\n}\n","'use client';\n\nimport { Row, ColumnDef } from '@tanstack/react-table';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { ColumnStyleWrapper, HoverStyle } from '../discover-content/discover-content.style';\nimport { useAtom, useAtomValue } from 'jotai';\nimport { useRequest } from 'ahooks';\nimport { css } from '@emotion/css';\nimport { SurroundingContentItem } from './surrounding-content-item';\nimport { SurroundingLogsActions } from './logs-actions';\nimport SurroundingDiscoverFilter from './discover-filter';\nimport { Button, IconButton, LoadingBar, Tab, TabContent, TabsBar, useTheme2 } from '@grafana/ui';\nimport { SurroundingParams } from './types';\nimport SDCollapsibleTable from 'components/selectdb-ui/sd-collapsible-table';\nimport {\n    selectedRowAtom,\n    currentTimeFieldAtom,\n    currentClusterAtom,\n    currentTableAtom,\n    currentCatalogAtom,\n    currentDatabaseAtom,\n    surroundingTableDataAtom,\n    selectedDatasourceAtom,\n    afterCountAtom,\n    afterTimeAtom,\n    afterTimeFieldPageSizeAtom,\n    beforeCountAtom,\n    beforeTimeAtom,\n    beforeTimeFieldPageSizeAtom,\n    surroundingDataFilterAtom,\n    surroundingSelectedFieldsAtom,\n} from 'store/discover';\n// import dayjs from 'dayjs';\nimport { get, sortBy } from 'lodash-es';\nimport { getSurroundingDataService } from 'services/discover';\nimport { lastValueFrom } from 'rxjs';\nimport { convertColumnToRow, formatTimestampToDateTime } from 'utils/data';\nimport { generateTableDataUID } from 'utils/utils';\nimport { SurroundingContentTableActions } from './content/content-table-actions';\n\nexport default function SurroundingLogs() {\n    const theme = useTheme2();\n    const selectedRow = useAtomValue(selectedRowAtom);\n    const selectdbDS = useAtomValue(selectedDatasourceAtom);\n    const currentTimeField = useAtomValue(currentTimeFieldAtom);\n    const [selectedSurroundingFields, setSelectedSurroundingFields] = useAtom(surroundingSelectedFieldsAtom);\n    const [surroundingDataFilter] = useAtom<any>(surroundingDataFilterAtom);\n    const hasSelectedFields = selectedSurroundingFields.length > 0;\n    const [fields, setFields] = useState<any[]>([]);\n    const currentCluster = useAtomValue(currentClusterAtom);\n    const currentTable = useAtomValue(currentTableAtom);\n    const currentCatalog = useAtomValue(currentCatalogAtom);\n    const currentDatabase = useAtomValue(currentDatabaseAtom);\n    const [surroundingTableData, setSurroundingTableData] = useAtom(surroundingTableDataAtom);\n    const [beforeCount, setBeforeCount] = useAtom(beforeCountAtom);\n    const [afterCount, setAfterCount] = useAtom(afterCountAtom);\n    const [beforeTimeFieldPageSize, setBeforeTimeFieldPageSize] = useAtom(beforeTimeFieldPageSizeAtom);\n    const [afterTimeFieldPageSize, setAfterTimeFieldPageSize] = useAtom(afterTimeFieldPageSizeAtom);\n    const [beforeTime, setBeforeTime] = useAtom(beforeTimeAtom);\n    const [afterTime, setAfterTime] = useAtom(afterTimeAtom);\n    const [state, updateState] = useState([\n        {\n            label: 'Table',\n            value: 'Table',\n            active: true,\n        },\n        {\n            label: 'JSON',\n            value: 'JSON',\n            active: false,\n        },\n    ]);\n\n    function handleRemove(field: any) {\n        const index = selectedSurroundingFields.findIndex((item: any) => item.Field === field.Field);\n        selectedSurroundingFields.splice(index, 1);\n        setSelectedSurroundingFields([...selectedSurroundingFields]);\n    }\n\n    const getAfterResultWrap = (result: any[]) => {\n        const [_, ...newResult] = result;\n        return newResult;\n    }\n\n    const { loading: getAfterSurroundingDataLoading, run: getAfterSurroundingData } = useRequest(\n        ({ pageSize = afterTimeFieldPageSize, time = afterTime }: any) => {\n            console.log(time);\n            const params: SurroundingParams = getQueryParams({\n                pageSize: pageSize + 1,\n                operator: '>',\n                time,\n            });\n            console.log(params.time);\n\n            return lastValueFrom(\n                getSurroundingDataService({\n                    selectdbDS,\n                    ...params,\n                }),\n            );\n        },\n        {\n            manual: true,\n            onSuccess: async (res: any, params: any) => {\n                if (res.ok) {\n                    const rowsData = convertColumnToRow(res.data.results.getSurroundingData.frames[0]);\n                    const result = getAfterResultWrap(generateSurroundingResult(rowsData, currentTimeField));\n                    let data = [...surroundingTableData];\n                    data.push(...result);\n                    setAfterCount(afterCount + result.length);\n                    setAfterTime(result[result.length - 1]._original[currentTimeField]);\n                    setSurroundingTableData(data);\n                    // setTimeout(() => {\n                    //     scrollToSelectedRow();\n                    // }, 50);\n                }\n            },\n        },\n    );\n\n    function getQueryParams({ pageSize = 5, operator = '>', time = selectedRow.time }: any) {\n        const params: SurroundingParams = {\n            catalog: currentCatalog,\n            database: currentDatabase,\n            table: currentTable,\n            timeField: currentTimeField,\n            time,\n            data_filters: [],\n            pageSize,\n            operator,\n            cluster: currentCluster,\n            theme: theme.isDark ? 'dark' : 'light',\n        };\n        if (surroundingDataFilter.length > 0) {\n            params.data_filters = surroundingDataFilter;\n        }\n        return params;\n    }\n\n    const { loading: getBeforeSurroundingDataLoading, run: getBeforeSurroundingData } = useRequest(\n        ({ pageSize = beforeTimeFieldPageSize, time = selectedRow.time }: any) => {\n            const params: SurroundingParams = getQueryParams({\n                pageSize,\n                operator: '<',\n                time,\n            });\n\n            return lastValueFrom(\n                getSurroundingDataService({\n                    selectdbDS,\n                    ...params,\n                }),\n            );\n        },\n        {\n            manual: true,\n            onSuccess: async (res: any, params: any) => {\n                if (res.ok) {\n                    const rowsData = convertColumnToRow(res.data.results.getSurroundingData.frames[0]);\n                    const result = generateSurroundingResult(rowsData, currentTimeField);\n                    let data = [...surroundingTableData];\n                    data.unshift(...result);\n                    setBeforeCount(beforeCount + result.length);\n                    setBeforeTime(result[0]._original[currentTimeField]);\n                    setSurroundingTableData(data);\n                    // setTimeout(() => {\n                    //     scrollToSelectedRow();\n                    // }, 50);\n                }\n            },\n        },\n    );\n\n    function scrollToSelectedRow() {\n        const selectedElement = document.getElementById('selected');\n        if (selectedElement) {\n            selectedElement.scrollIntoView({ block: 'center', behavior: 'smooth' });\n        }\n    }\n\n    const { loading: initLoading } = useRequest(\n        () => {\n            const prevTimeParams: SurroundingParams = getQueryParams({\n                operator: '<',\n            });\n            const afterTimeParams: SurroundingParams = getQueryParams({\n                operator: '>',\n                pageSize: 6\n            });\n            return Promise.all([\n                lastValueFrom(\n                    getSurroundingDataService({\n                        selectdbDS,\n                        ...prevTimeParams,\n                    }),\n                ),\n                lastValueFrom(\n                    getSurroundingDataService({\n                        selectdbDS,\n                        ...afterTimeParams,\n                    }),\n                ),\n            ]);\n        },\n        {\n            refreshDeps: [surroundingDataFilter],\n            onSuccess: async (res: any) => {\n                if (res[0].ok && res[1].ok) {\n                    const rowsData1 = convertColumnToRow(res[0].data.results.getSurroundingData.frames[0]);\n                    const rowsData2 = convertColumnToRow(res[1].data.results.getSurroundingData.frames[0]);\n                    const result1 = generateSurroundingResult(rowsData1, currentTimeField);\n                    const result2 = getAfterResultWrap(generateSurroundingResult(rowsData2, currentTimeField));\n                    const selectedResult = generateSurroundingResult([selectedRow._original], currentTimeField);\n                    const data = [...result1, ...selectedResult, ...result2];\n                    const rowsDataWithUID = await generateTableDataUID(data);\n\n                    if (result1.length > 0) {\n                        setBeforeCount(result1.length);\n                        setBeforeTime(result1[0]._original[currentTimeField]);\n                    } else {\n                        setBeforeTime(selectedRow.time);\n                    }\n                    if (result2.length > 0) {\n                        setAfterCount(result2.length);\n                        setAfterTime(result2[result2.length - 1]._original[currentTimeField]);\n                    } else {\n                        setAfterTime(selectedRow.time);\n                    }\n                    setSurroundingTableData(rowsDataWithUID);\n                    setTimeout(() => {\n                        scrollToSelectedRow();\n                    }, 50);\n                } else {\n                    // toast.error(res[1].message);\n                }\n            },\n            onError: err => {\n                console.log(err);\n            },\n        },\n    );\n\n    useEffect(() => {\n        const data = surroundingTableData.map(item => {\n            return {\n                _original: item._original,\n                time: item._original?.[currentTimeField] || '',\n                _source: item._source,\n                _uid: item._uid,\n                selected: item._uid === selectedRow._uid,\n            };\n        });\n        setFields(data);\n    }, [surroundingTableData, currentTimeField, selectedRow._uid]);\n\n    const renderBeforeLoadingBar = () => {\n        if (initLoading || getBeforeSurroundingDataLoading) {\n            return (\n                <div\n                    className={css`\n                        position: absolute;\n                        bottom: 0;\n                        left: 0;\n                        width: 100%;\n                    `}\n                >\n                    <LoadingBar width={100} />\n                </div>\n            );\n        }\n        return null;\n    };\n\n    const renderAfterLoadingBar = () => {\n        if (initLoading || getAfterSurroundingDataLoading) {\n            return (\n                <div\n                    className={css`\n                        position: absolute;\n                        top: 0;\n                        left: 0;\n                        width: 100%;\n                    `}\n                >\n                    <LoadingBar width={100} />\n                </div>\n            );\n        }\n        return null;\n    };\n\n    const renderSubComponent = ({ row }: { row: Row<any> }) => {\n        // processObject copied/adapted from discover-content to normalize stringified JSON inside fields\n        const processObject = (obj: any): any => {\n            if (typeof obj !== 'object' || obj === null) {\n                return obj;\n            }\n\n            const result: any = {};\n            for (const key in obj) {\n                if (obj.hasOwnProperty(key)) {\n                    let value = obj[key];\n\n                    if (typeof value === 'string') {\n                        let cleanValue = value.trim();\n\n                        // check for escaped double quotes\n                        if (cleanValue.includes('\\\\\"')) {\n                            try {\n                                cleanValue = JSON.parse(`\"${cleanValue}\"`);\n                            } catch (e) {\n                                // if parsing fails, keep the original value\n                            }\n                        }\n\n                        // check for JSON\n                        if ((cleanValue.startsWith('{') && cleanValue.endsWith('}')) || (cleanValue.startsWith('[') && cleanValue.endsWith(']'))) {\n                            try {\n                                const parsed = JSON.parse(cleanValue);\n                                value = processObject(parsed);\n                            } catch (e) {\n                                value = obj[key];\n                            }\n                        } else {\n                            value = obj[key];\n                        }\n                    } else if (Array.isArray(value)) {\n                        value = value.map(item => {\n                            if (typeof item === 'string') {\n                                let cleanItem = item.trim();\n\n                                if (cleanItem.includes('\\\\\"')) {\n                                    try {\n                                        cleanItem = JSON.parse(`\"${cleanItem}\"`);\n                                    } catch (e) { }\n                                }\n\n                                if ((cleanItem.startsWith('{') && cleanItem.endsWith('}')) || (cleanItem.startsWith('[') && cleanItem.endsWith(']'))) {\n                                    try {\n                                        const parsed = JSON.parse(cleanItem);\n                                        return processObject(parsed);\n                                    } catch {\n                                        return item;\n                                    }\n                                }\n                                return item;\n                            }\n                            return typeof item === 'object' && item !== null ? processObject(item) : item;\n                        });\n                    } else if (typeof value === 'object' && value !== null) {\n                        value = processObject(value);\n                    }\n\n                    result[key] = value;\n                }\n            }\n            return result;\n        };\n\n        const processedData = processObject(row.original._original);\n\n        const subTableData = Object.keys(processedData).map(key => {\n            return {\n                field: key,\n                value: row.original._original[key],\n            };\n        });\n\n        return (\n            <div\n                className={css`\n                    position: relative;\n                `}\n            >\n                <TabsBar\n                    className={css`\n                        ${theme.isDark ? 'background-color: hsl(var(--n9) / 0.4);' : 'background-color: hsl(var(--b1) / 0.6);'}\n                    `}\n                >\n                    {state.map((tab, index) => {\n                        return (\n                            <Tab\n                                key={index}\n                                label={tab.label}\n                                active={tab.active}\n                                onChangeTab={() =>\n                                    updateState(\n                                        state.map((tab, idx) => ({\n                                            ...tab,\n                                            active: idx === index,\n                                        })),\n                                    )\n                                }\n                                counter={subTableData.length}\n                            />\n                        );\n                    })}\n                </TabsBar>\n                <TabContent>\n                    {state[0].active && (\n                        <table className=\"bg-b1/20 pl-4 backdrop-blur-md dark:bg-n9/60\">\n                            <tbody>\n                                {subTableData.map((item: any) => {\n                                    let fieldValue = item.value;\n                                    const fieldName = item.field;\n                                    if (typeof fieldValue === 'object') {\n                                        fieldValue = JSON.stringify(fieldValue);\n                                    }\n                                    const tableRowStyle = css`\n                                        &:hover {\n                                            .filter-table-content {\n                                                visibility: visible;\n                                            }\n                                        }\n                                    `;\n                                    return (\n                                        <tr className={`${tableRowStyle}`} key={fieldName}>\n                                            <td\n                                                className={css`\n                                                    height: 32px;\n                                                    width: 70px;\n                                                `}\n                                            >\n                                                <div\n                                                    className={`filter-table-content ${css`\n                                                        visibility: hidden;\n                                                    `}`}\n                                                >\n                                                    <SurroundingContentTableActions fieldName={fieldName} fieldValue={fieldValue} />\n                                                </div>\n                                            </td>\n                                            <td className=\"h-8 text-xs\">{fieldName || '-'}</td>\n                                            <td className=\"h-8 whitespace-normal text-xs\">\n                                                <div className=\"w-full break-all\">{fieldValue || '-'}</div>\n                                            </td>\n                                        </tr>\n                                    );\n                                })}\n                            </tbody>\n                        </table>\n                    )}\n                    {state[1].active && (\n                        <div>\n                            <pre\n                                className={css`\n                                    padding: 16px;\n                                    margin: 0;\n                                    overflow-x: auto;\n                                    white-space: pre-wrap;\n                                    word-break: break-all;\n                                    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n                                    font-size: 12px;\n                                    line-height: 1.5;\n                                    ${theme.isDark ? 'background-color: #1e1e1e; color: #d4d4d4;' : 'background-color: #f5f5f5; color: #333;'}\n                                    border-radius: 4px;\n                                    max-height: 400px;\n                                    overflow-y: auto;\n                                `}\n                            >\n                                {JSON.stringify(processedData, null, 2)}\n                            </pre>\n                        </div>\n                    )}\n                </TabContent>\n                {/* Surrounding items link is handled by parent (DiscoverContent). No action here. */}\n             </div>\n         );\n     };\n\n     function generateSurroundingResult(result: any, timeField: string) {\n        const sortedResult = sortBy(result, timeField);\n        const _sourceResult = sortedResult.map((item: any) => {\n            let itemSource = '';\n            for (const key in item) {\n                let highlightValue = item[key];\n                //  Variant \n                if (typeof highlightValue === 'object') {\n                    highlightValue = JSON.stringify(highlightValue);\n                }\n                itemSource += `<span style=\"background-color: ${theme.isDark ? '#3F3F4F' : '#BED8FD'\n                    } ; padding: 0px 4px 2px; margin-right: 4px; border-radius: 4px;\">${key}:</span>${highlightValue} `;\n            }\n            return {\n                _original: item,\n                _source: itemSource,\n            };\n        });\n\n        return _sourceResult;\n    }\n\n    const columns = useMemo<Array<ColumnDef<any>>>(() => {\n        let dynamicColumns: Array<ColumnDef<any>> = [\n            {\n                accessorKey: 'collapse',\n                header: ``,\n                cell: ({ row, getValue }) => {\n                    return (\n                        row.getCanExpand() && (\n                            <div>\n                                {row.getIsExpanded() ? (\n                                    <IconButton onClick={row.getToggleExpandedHandler()} name=\"arrow-down\" tooltip=\"Collapse\" />\n                                ) : (\n                                    <IconButton onClick={row.getToggleExpandedHandler()} name=\"arrow-right\" tooltip=\"Expand\" />\n                                )}\n                                <div className=\"ml-1\">{getValue<string>()}</div>\n                            </div>\n                        )\n                    );\n                },\n            },\n            {\n                header: 'Time',\n                accessorKey: 'time',\n                cell: ({ row, getValue }) => {\n                    const fieldValue = getValue<string>();\n                    const fieldName = currentTimeField;\n                    const fieldType = 'DATE';\n                    const timeField = formatTimestampToDateTime(fieldValue);\n                    return (\n                        <div\n                            className={`${css`\n                                width: 230px;\n                            `} ${HoverStyle}`}\n                        >\n                            <div\n                                className={css`\n                                    display: flex;\n                                    align-items: center;\n                                `}\n                            >\n                                {timeField}\n                                <div\n                                    className={`filter-content ${css`\n                                        visibility: hidden;\n                                    `}`}\n                                >\n                                    <SurroundingContentItem fieldName={fieldName} fieldValue={fieldValue} fieldType={fieldType} />\n                                </div>\n                            </div>\n                        </div>\n                    );\n                },\n            },\n        ];\n        if (!hasSelectedFields) {\n            dynamicColumns.push({\n                accessorKey: '_source',\n                header: '_source',\n                cell: ({ row, getValue }) => {\n                    function createMarkup() {\n                        return { __html: getValue<string>() };\n                    }\n                    return (\n                        <div\n                            className={css`\n                                padding-top: 0.5rem;\n                                padding-bottom: 0.5rem;\n                                font-size: 0.875rem;\n                                line-height: 1.25rem;\n                            `}\n                        >\n                            <ColumnStyleWrapper\n                                className={css`\n                                    .field-key {\n                                        background-color: ${theme.isDark ? '#3f3f4f' : 'rgb(191, 217, 253)'};\n                                    }\n                                `}\n                            >\n                                <div\n                                    dangerouslySetInnerHTML={createMarkup()}\n                                    className={css`\n                                        max-height: 12rem;\n                                        overflow: auto;\n                                        word-break: break-all;\n                                        white-space: pre-wrap;\n                                    `}\n                                />\n                            </ColumnStyleWrapper>\n                        </div>\n                    );\n                },\n            });\n        } else {\n            dynamicColumns = [\n                ...dynamicColumns,\n                ...selectedSurroundingFields.map((field: any) => {\n                    return {\n                        accessorKey: field.Field,\n                        header: () => (\n                            <div\n                                className={css`\n                                    display: flex;\n                                    align-items: center;\n                                `}\n                            >\n                                <div>{field.Field}</div>\n                                <IconButton\n                                    name=\"times\"\n                                    tooltip=\"Remove\"\n                                    style={{\n                                        marginLeft: '8px',\n                                        cursor: 'pointer',\n                                        marginTop: '2px',\n                                    }}\n                                    onClick={e => {\n                                        handleRemove(field);\n                                        e.preventDefault();\n                                        e.stopPropagation();\n                                    }}\n                                />\n                            </div>\n                        ),\n                        cell: ({ row, getValue }: any) => {\n                            // let fieldValue = row.original._original[field.Field];\n                            let fieldValue = get(row.original._original, field.Field);\n                            const fieldName = field.Field;\n                            const fieldType = field.Type;\n                            if (typeof fieldValue === 'object') {\n                                fieldValue = JSON.stringify(fieldValue);\n                            }\n                            return (\n                                <div\n                                    className={`${HoverStyle} ${css`\n                                        display: flex;\n                                        align-items: center;\n                                        min-height: 48px;\n                                    `}`}\n                                >\n                                    <div className={`max-h-48 overflow-auto`}>\n                                        <div className=\"flex items-center break-all py-4\">\n                                            {field.value === 'trace_id' && fieldValue ? <Button>{fieldValue}</Button> : <span className=\"text-xs\">{fieldValue}</span>}\n                                        </div>\n                                    </div>\n                                    {\n                                        fieldValue ? <div\n                                            className={`filter-content ${css`\n                                            visibility: hidden;\n                                        `}`}\n                                        >\n                                            <SurroundingContentItem fieldName={fieldName} fieldValue={fieldValue} fieldType={fieldType} />\n                                        </div> : null\n                                    }\n\n                                </div>\n                            );\n                        },\n                    };\n                }),\n            ];\n        }\n        return dynamicColumns;\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [currentTimeField, handleRemove, hasSelectedFields, selectedSurroundingFields]);\n\n    return (\n        <div>\n            <SurroundingDiscoverFilter dataFilter={surroundingDataFilter} />\n            <div className=\"h-[2px] bg-b1 dark:bg-black\" />\n            <div style={{ position: 'relative' }}>\n                <SurroundingLogsActions\n                    getSurroundingData={getBeforeSurroundingData}\n                    getSurroundingDataLoading={getBeforeSurroundingDataLoading}\n                    time={beforeTime}\n                    type=\"before\"\n                    timeFieldPageSize={beforeTimeFieldPageSize}\n                    setTimeFieldPageSize={setBeforeTimeFieldPageSize}\n                    tips=\"Old records\"\n                    count={beforeCount}\n                />\n                {renderBeforeLoadingBar()}\n            </div>\n            <div style={{ height: 'calc(100vh - 220px)', overflow: 'auto', position: 'relative' }}>\n                <div className=\"mx-6 border\">\n                    <SDCollapsibleTable data={fields} columns={columns} getRowCanExpand={() => true} renderSubComponent={renderSubComponent} />\n                </div>\n                {/* {initLoading ? (\n                    <LoadingBar width={100} />\n                ) : (\n                    {renderBeforeLoadingBar}\n                    <div className=\"mx-6 border\">\n                        <SDCollapsibleTable data={fields} columns={columns} getRowCanExpand={() => true} renderSubComponent={renderSubComponent} />\n                    </div>\n                )} */}\n            </div>\n            <div style={{ position: 'relative' }}>\n                {renderAfterLoadingBar()}\n                <SurroundingLogsActions\n                    getSurroundingData={getAfterSurroundingData}\n                    getSurroundingDataLoading={getAfterSurroundingDataLoading}\n                    time={afterTime}\n                    type=\"after\"\n                    timeFieldPageSize={afterTimeFieldPageSize}\n                    setTimeFieldPageSize={setAfterTimeFieldPageSize}\n                    tips={`New records`}\n                    count={afterCount}\n                />\n            </div>\n        </div>\n    );\n}\n","'use client';\nimport { ColumnDef, Row } from '@tanstack/react-table';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { useAtom, useAtomValue, useSetAtom } from 'jotai';\nimport { Drawer, IconButton, Pagination, Tab, TabContent, TabsBar, useTheme2 } from '@grafana/ui';\nimport {\n    tableTotalCountAtom,\n    tableDataAtom,\n    selectedFieldsAtom,\n    selectedRowAtom,\n    surroundingTableDataAtom,\n    pageSizeAtom,\n    pageAtom,\n    afterCountAtom,\n    beforeCountAtom,\n    surroundingDataFilterAtom,\n    currentTimeFieldAtom,\n    discoverCurrentAtom,\n    selectedDatasourceAtom,\n    tableFieldsAtom\n} from 'store/discover';\nimport { get } from 'lodash-es';\nimport { Button as AntButton, Tooltip } from 'antd';\nimport SDCollapsibleTable from 'components/selectdb-ui/sd-collapsible-table';\nimport { ColumnStyleWrapper, HoverStyle } from './discover-content.style';\nimport { css } from '@emotion/css';\nimport { ContentTableActions } from './content-table-actions';\nimport { ContentItem } from './content-item';\nimport SurroundingLogs from 'components/surrounding-logs';\nimport TraceDetail from 'components/trace-detail';\nimport { usePluginContext } from '@grafana/data';\nimport type { AppPluginSettings } from 'components/AppConfig/AppConfig';\nimport { formatTimestampToDateTime, isValidTimeFieldType } from 'utils/data';\n\n\nexport default function DiscoverContent({ fetchNextPage, getTraceData }: { fetchNextPage: (page: number) => void; getTraceData: (traceId: string, table?: string, callback?: Function) => any }) {\n    const theme = useTheme2();\n    const [fields, setFields] = useState<any[]>([]);\n    const tableTotalCount = useAtomValue(tableTotalCountAtom);\n    const [tableData, _setTableData] = useAtom(tableDataAtom);\n    const [selectedFields, setSelectedFields] = useAtom(selectedFieldsAtom);\n    const hasSelectedFields = selectedFields.length > 0;\n    const currentTimeField = useAtomValue(currentTimeFieldAtom);\n    // const [surroundingOpen, setSurroundingOpen] = useState(false);\n    const [selectedRow, setSelectedRow] = useAtom(selectedRowAtom);\n    const setSurroundingTableData = useSetAtom(surroundingTableDataAtom);\n    const setSurroundingDataFilter = useSetAtom(surroundingDataFilterAtom);\n    const setBeforeCount = useSetAtom(beforeCountAtom);\n    const setAfterCount = useSetAtom(afterCountAtom);\n    const [pageSize, _setPageSize] = useAtom(pageSizeAtom);\n    const [page, setPage] = useAtom(pageAtom);\n    const [drawerOpen, setDrawerOpen] = useState(false);\n    const [surroundingLogsOpen, setSurroundingLogsOpen] = useState(false);\n    const [_fieldKeyBg, setFieldKeyBg] = useState<string>('#3f3f4f');\n    const discoverCurrent = useAtomValue(discoverCurrentAtom);\n    const currentDatasource = useAtomValue(selectedDatasourceAtom);\n    const tableFields = useAtomValue(tableFieldsAtom);\n    const context = usePluginContext();\n    // user settings\n    const jsonData = context.meta.jsonData || {};\n    console.log('jsonData', jsonData);\n\n    const { logsConfig = {} } = jsonData as AppPluginSettings;\n    const { database = \"\", datasource = {}, logsTable = \"\", targetTraceTable = \"\" } = logsConfig;\n    // local input state for page-jump control\n    const [jumpPage, setJumpPage] = useState<string>(String(page));\n\n    useEffect(() => {\n        setJumpPage(String(page));\n    }, [page]);\n\n    const isTargetLogTable = discoverCurrent.table === logsTable && discoverCurrent.database === database && currentDatasource?.id === datasource?.id;\n\n    useEffect(() => {\n        if (theme.isDark) {\n            setFieldKeyBg('#3f3f4f');\n        } else {\n            setFieldKeyBg('rgb(191, 217, 253)');\n        }\n    }, [theme.isDark]);\n\n    const [state, updateState] = useState([\n        {\n            label: 'Table',\n            value: 'Table',\n            active: true,\n        },\n        {\n            label: 'JSON',\n            value: 'JSON',\n            active: false,\n        },\n    ]);\n\n    useEffect(() => {\n        const data = tableData.map(item => {\n            return {\n                _original: item._original,\n                time: item._original?.[currentTimeField] || '',\n                _source: item._source,\n                _uid: item?._uid,\n            };\n        });\n        setFields(data);\n    }, [tableData, currentTimeField]);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    const handleRemove = React.useCallback(\n        (field: any) => {\n            const index = selectedFields.findIndex((item: any) => item.Field === field.Field);\n            selectedFields.splice(index, 1);\n            setSelectedFields([...selectedFields]);\n        },\n        [selectedFields, setSelectedFields],\n    );\n\n    const renderSubComponent = ({ row }: { row: Row<any> }) => {\n        // process object\n        const processObject = (obj: any): any => {\n            if (typeof obj !== 'object' || obj === null) {\n                return obj;\n            }\n\n            const result: any = {};\n            for (const key in obj) {\n                if (obj.hasOwnProperty(key)) {\n                    let value = obj[key];\n\n                    if (typeof value === 'string') {\n                        let cleanValue = value.trim();\n\n                        // check for escaped double quotes\n                        if (cleanValue.includes('\\\\\"')) {\n                            try {\n                                cleanValue = JSON.parse(`\"${cleanValue}\"`);\n                            } catch (e) {\n                                // if parsing fails, keep the original value\n                            }\n                        }\n\n                        // check for JSON\n                        if ((cleanValue.startsWith('{') && cleanValue.endsWith('}')) || (cleanValue.startsWith('[') && cleanValue.endsWith(']'))) {\n                            try {\n                                const parsed = JSON.parse(cleanValue);\n                                value = processObject(parsed);\n                            } catch (e) {\n                                value = obj[key];\n                            }\n                        } else {\n                            value = obj[key];\n                        }\n                    } else if (Array.isArray(value)) {\n                        value = value.map(item => {\n                            if (typeof item === 'string') {\n                                let cleanItem = item.trim();\n\n                                if (cleanItem.includes('\\\\\"')) {\n                                    try {\n                                        cleanItem = JSON.parse(`\"${cleanItem}\"`);\n                                    } catch (e) { }\n                                }\n\n                                if ((cleanItem.startsWith('{') && cleanItem.endsWith('}')) || (cleanItem.startsWith('[') && cleanItem.endsWith(']'))) {\n                                    try {\n                                        const parsed = JSON.parse(cleanItem);\n                                        return processObject(parsed);\n                                    } catch {\n                                        return item;\n                                    }\n                                }\n                                return item;\n                            }\n                            return typeof item === 'object' && item !== null ? processObject(item) : item;\n                        });\n                    } else if (typeof value === 'object' && value !== null) {\n                        value = processObject(value);\n                    }\n\n                    result[key] = value;\n                }\n            }\n            return result;\n        };\n\n        const processedData = processObject(row.original._original);\n\n        const subTableData = Object.keys(processedData).map(key => {\n            return {\n                field: key,\n                value: row.original._original[key],\n            };\n        });\n        return (\n            <div\n                className={css`\n                    position: relative;\n                `}\n            >\n                <TabsBar\n                    className={css`\n                        ${theme.isDark ? 'background-color: hsl(var(--n9) / 0.4);' : 'background-color: hsl(var(--b1) / 0.6);'}\n                    `}\n                >\n                    {state.map((tab, index) => {\n                        return (\n                            <Tab\n                                key={index}\n                                label={tab.label}\n                                active={tab.active}\n                                onChangeTab={() =>\n                                    updateState(\n                                        state.map((tab, idx) => ({\n                                            ...tab,\n                                            active: idx === index,\n                                        })),\n                                    )\n                                }\n                                counter={subTableData.length}\n                            />\n                        );\n                    })}\n                </TabsBar>\n\n                <TabContent>\n                    {state[0].active && (\n                        <table\n                            // className=\"bg-b1/20 pl-4 backdrop-blur-md dark:bg-n9/60\"\n                            className={css`\n                                padding-left: 16px;\n                                backdrop-filter: blur(12px);\n                                -webkit-backdrop-filter: blur(12px);\n                                width: 100%;\n                                ${theme.isDark ? 'background-color: hsl(var(--n9) / 0.6);' : 'background-color: hsl(var(--b1) / 0.2)'}\n                            `}\n                        >\n                            <tbody>\n                                {subTableData.map((item: any) => {\n                                    let fieldValue = item.value;\n                                    const fieldName = item.field;\n                                    if (typeof fieldValue === 'object') {\n                                        fieldValue = JSON.stringify(fieldValue);\n                                    }\n                                    const tableRowStyle = css`\n                                        &:hover {\n                                            .filter-table-content {\n                                                visibility: visible;\n                                            }\n                                        }\n                                    `;\n                                    return (\n                                        <tr className={`${tableRowStyle}`} key={fieldName}>\n                                            <td\n                                                className={css`\n                                                    height: 32px;\n                                                    width: 70px;\n                                                `}\n                                            >\n                                                <div\n                                                    className={`filter-table-content ${css`\n                                                        visibility: hidden;\n                                                    `}`}\n                                                >\n                                                    <ContentTableActions fieldName={fieldName} fieldValue={fieldValue} />\n                                                </div>\n                                            </td>\n                                            <td\n                                                className={css`\n                                                    height: 32px;\n                                                    font-size: 12px;\n                                                `}\n                                            >\n                                                {fieldName || '-'}\n                                            </td>\n                                            <td\n                                                className={css`\n                                                    height: 32px;\n                                                    font-size: 12px;\n                                                    white-space: normal;\n                                                `}\n                                            >\n                                                <div\n                                                    className={css`\n                                                        width: 100%;\n                                                        word-break: break-all;\n                                                    `}\n                                                >\n                                                    {fieldValue || '-'}\n                                                </div>\n                                            </td>\n                                        </tr>\n                                    );\n                                })}\n                            </tbody>\n                        </table>\n                    )}\n                    {state[1].active && (\n                        <div>\n                            <pre\n                                className={css`\n                                    padding: 16px;\n                                    margin: 0;\n                                    overflow-x: auto;\n                                    white-space: pre-wrap;\n                                    word-break: break-all;\n                                    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n                                    font-size: 12px;\n                                    line-height: 1.5;\n                                    ${theme.isDark ? 'background-color: #1e1e1e; color: #d4d4d4;' : 'background-color: #f5f5f5; color: #333;'}\n                                    border-radius: 4px;\n                                    max-height: 400px;\n                                    overflow-y: auto;\n                                `}\n                            >\n                                {JSON.stringify(processedData, null, 2)}\n                            </pre>\n                        </div>\n                    )}\n                </TabContent>\n                <Tooltip title=\"Surrounding Items will ignore the existing interface's filter conditions and view the context through time.\">\n                    <a\n                        onClick={() => {\n                            console.log('row', row);\n                            setSurroundingLogsOpen(true);\n                            setSelectedRow(row.original);\n                        }}\n                        className={css`\n                        position: absolute;\n                        right: 1rem;\n                        top: 0;\n                        cursor: pointer;\n                        padding-top: 0.5rem;\n                        &:hover {\n                            color: #3D71D9;\n                        }\n                    `}\n                    >\n                        Surrounding items\n                    </a>\n                </Tooltip>\n            </div>\n        );\n    };\n\n    const callback = (status: number) => {\n        if (status >= 200 && status <= 299) {\n            setDrawerOpen(true)\n        }\n    }\n\n    const openTraceDrawer = (traceId: string, table?: string) => {\n        // request\n        getTraceData(traceId, table, callback);\n    };\n\n    const columns = useMemo<Array<ColumnDef<any>>>(() => {\n        let dynamicColumns: Array<ColumnDef<any>> = [\n            {\n                accessorKey: 'collapse',\n                header: ``,\n                cell: ({ row, getValue }) => {\n                    return (\n                        row.getCanExpand() && (\n                            <div className=\"flex items-center\">\n                                {row.getIsExpanded() ? (\n                                    <IconButton onClick={row.getToggleExpandedHandler()} name=\"arrow-down\" tooltip=\"Collapse\" />\n                                ) : (\n                                    <IconButton onClick={row.getToggleExpandedHandler()} name=\"arrow-right\" tooltip=\"Expand\" />\n                                )}\n                                <div className=\"ml-1\">{getValue<string>()}</div>\n                            </div>\n                        )\n                    );\n                },\n            },\n            {\n                header: () => currentTimeField || 'Time',\n                accessorKey: 'time',\n                cell: ({ row, getValue }) => {\n                    const fieldValue = getValue<string>();\n                    const fieldName = currentTimeField;\n                    // try to find field type from tableFields\n                    const fieldInfo = tableFields.find((f: any) => f.value === currentTimeField);\n                    const fieldType = fieldInfo?.Type || '';\n                    let timeField: any = fieldValue;\n\n                    // If this field is a valid time field type, try to format it\n                    try {\n                        if (fieldInfo && isValidTimeFieldType(String(fieldInfo.Type).toUpperCase())) {\n                            // if numeric timestamp, convert\n                            const num = Number(fieldValue);\n                            if (!Number.isNaN(num)) {\n                                timeField = formatTimestampToDateTime(num);\n                            } else {\n                                // otherwise keep raw string (or attempt Date parse)\n                                timeField = String(fieldValue || '');\n                            }\n                        }\n                    } catch (e) {\n                        // fallback to raw\n                        timeField = fieldValue;\n                    }\n                    return (\n                        <div\n                            className={`${css`\n                                 width: 240px;\n                             `} ${HoverStyle}`}\n                        >\n                            <div\n                                className={css`\n                                     display: flex;\n                                     align-items: center;\n                                 `}\n                            >\n                                {timeField}\n                                <div\n                                    className={`filter-content ${css`\n                                         visibility: hidden;\n                                     `}`}\n                                >\n                                    <ContentItem fieldName={fieldName} fieldValue={fieldValue} fieldType={fieldType} />\n                                </div>\n                            </div>\n                        </div>\n                    );\n                },\n            },\n        ];\n        if (!hasSelectedFields) {\n            dynamicColumns.push({\n                accessorKey: '_source',\n                header: '_source',\n                cell: ({ row, getValue, ...rest }) => {\n                    const html = getValue<string>();\n                    const handleClick: React.MouseEventHandler<HTMLDivElement> = e => {\n                        const target = e.target as HTMLElement | null;\n                        if (!target) {\n                            return;\n                        }\n\n                        const link = target.closest<HTMLElement>('[data-trace-id]');\n                        if (!link) {\n                            return;\n                        }\n\n                        const traceId = link.getAttribute('data-trace-id');\n                        if (!traceId) {\n                            return;\n                        }\n\n                        e.preventDefault();\n                        if (isTargetLogTable && targetTraceTable) {\n                            openTraceDrawer(traceId, targetTraceTable);\n                        } else {\n                            openTraceDrawer(traceId);\n                        }\n                    };\n\n                    return (\n                        <div\n                            className={css`\n                                padding-top: 0.5rem;\n                                padding-bottom: 0.5rem;\n                                font-size: 0.875rem;\n                                line-height: 1.25rem;\n                            `}\n                        >\n                            <ColumnStyleWrapper\n                                className={css`\n                                    & .field-key {\n                                        background-color: ${theme.isDark ? '#3f3f4f' : 'rgb(191, 217, 253)'};\n                                    }\n                                    & .trace-link {\n                                        cursor: pointer;\n                                        text-decoration: underline;\n                                        color: #3D71D9;\n                                    }\n                                `}\n                            >\n                                <div\n                                    onClick={handleClick}\n                                    dangerouslySetInnerHTML={{ __html: html }}\n                                    className={css`\n                                        max-height: 12rem;\n                                        overflow: auto;\n                                        word-break: break-all;\n                                        white-space: pre-wrap;\n                                    `}\n                                />\n                            </ColumnStyleWrapper>\n                        </div>\n                    );\n                },\n            });\n        } else {\n            dynamicColumns = [\n                ...dynamicColumns,\n                ...selectedFields.map((field: any) => {\n                    return {\n                        accessorKey: field.Field,\n                        header: () => (\n                            <div\n                                className={css`\n                                    display: flex;\n                                    align-items: center;\n                                `}\n                            >\n                                <div>{field.Field}</div>\n                                <IconButton\n                                    name=\"times\"\n                                    tooltip=\"Remove\"\n                                    style={{\n                                        marginLeft: '8px',\n                                        cursor: 'pointer',\n                                        marginTop: '2px',\n                                    }}\n                                    onClick={e => {\n                                        handleRemove(field);\n                                        e.preventDefault();\n                                        e.stopPropagation();\n                                    }}\n                                />\n                            </div>\n                        ),\n                        cell: ({ row, getValue }: any) => {\n                            // let fieldValue = row.original._original[field.Field];\n                            let fieldValue = get(row.original._original, field.Field);\n                            const fieldName = field.Field;\n                            const fieldType = field.Type;\n                            if (typeof fieldValue === 'object') {\n                                fieldValue = JSON.stringify(fieldValue);\n                            }\n                            return (\n                                <div\n                                    className={`${HoverStyle} ${css`\n                                        display: flex;\n                                        align-items: center;\n                                        min-height: 48px;\n                                    `}`}\n                                >\n                                    <div\n                                        className={css`\n                                            max-height: 192px;\n                                            overflow: auto;\n                                        `}\n                                    >\n                                        <div\n                                            className={css`\n                                                display: flex;\n                                                align-items: center;\n                                                padding: 16px 16px 16px 0;\n                                                word-break: break-all;\n                                            `}\n                                        >\n                                            {field.value === 'trace_id' ? <AntButton\n                                                className={css`padding-left: 0px;`}\n                                                onClick={() => {\n                                                    if (isTargetLogTable && targetTraceTable) {\n                                                        openTraceDrawer(fieldValue, targetTraceTable)\n                                                    } else {\n                                                        openTraceDrawer(fieldValue);\n                                                    }\n                                                }}\n                                                type=\"link\">\n                                                {fieldValue}\n                                            </AntButton> : (\n                                                <span\n                                                    className={css`\n                                                        font-size: 12px;\n                                                        white-space: nowrap;\n                                                        text-overflow: ellipsis;\n                                                        overflow: hidden;\n                                                        max-width: 200px;\n                                                    `}\n                                                >\n                                                    {fieldValue}\n                                                </span>\n                                            )}\n                                        </div>\n                                    </div>\n                                    <div\n                                        className={`filter-content ${css`\n                                            visibility: hidden;\n                                        `}`}\n                                    >\n                                        <ContentItem fieldName={fieldName} fieldValue={fieldValue} fieldType={fieldType} />\n                                    </div>\n                                </div>\n                            );\n                        },\n                    };\n                }),\n            ];\n        }\n        return dynamicColumns;\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [currentTimeField, handleRemove, hasSelectedFields, selectedFields, theme.isDark]);\n\n    return (\n        <div\n            className={css`\n                overflow-x: scroll;\n            `}\n        >\n            {/* {\n                loading.getTableDataCharts && <LoadingBar width={100} />\n            } */}\n            <SDCollapsibleTable\n                className={css`\n                    width: 100%;\n                `}\n                data={fields}\n                columns={columns}\n                getRowCanExpand={() => true}\n                renderSubComponent={renderSubComponent}\n            />\n            <div\n                className={css`\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: center;\n                    padding: 0.5rem 1rem;\n                    padding-bottom: 20px;\n                `}\n            >\n                <div>Total {tableTotalCount} rows</div>\n                <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                    <Pagination\n                        currentPage={page}\n                        numberOfPages={Math.ceil(tableTotalCount / pageSize) || 1}\n                        onNavigate={toPage => {\n                            setPage(toPage);\n                        }}\n                    />\n                    {/* Page jump input */}\n                    <div\n                        className={css`\n                            display: flex;\n                            align-items: center;\n                            gap: 8px;\n                        `}\n                    >\n                        {/* local controlled input for typing page number */}\n                        <input\n                            type=\"number\"\n                            min={1}\n                            step={1}\n                            value={jumpPage}\n                            onChange={e => {\n                                setJumpPage(e.target.value);\n                            }}\n                            onKeyDown={e => {\n                                if (e.key === 'Enter') {\n                                    const num = Number(jumpPage);\n                                    const total = Math.max(Math.ceil(tableTotalCount / pageSize) || 1, 1);\n                                    if (!Number.isNaN(num)) {\n                                        const target = Math.min(Math.max(1, Math.floor(num)), total);\n                                        setPage(target);\n                                        try {\n                                            fetchNextPage && fetchNextPage(target);\n                                        } catch { }\n                                        setJumpPage(String(target));\n                                    } else {\n                                        // reset to current page if invalid\n                                        setJumpPage(String(page));\n                                    }\n                                }\n                            }}\n                            className={css`\n                                width: 72px;\n                                padding: 6px 8px;\n                                border-radius: 4px;\n                                border: 1px solid rgba(0,0,0,0.15);\n                            `}\n                        />\n                        <button\n                            onClick={() => {\n                                const num = Number(jumpPage);\n                                const total = Math.max(Math.ceil(tableTotalCount / pageSize) || 1, 1);\n                                if (!Number.isNaN(num)) {\n                                    const target = Math.min(Math.max(1, Math.floor(num)), total);\n                                    setPage(target);\n                                    try {\n                                        fetchNextPage && fetchNextPage(target);\n                                    } catch { }\n                                    setJumpPage(String(target));\n                                } else {\n                                    setJumpPage(String(page));\n                                }\n                            }}\n                            className={css`\n                                padding: 6px 10px;\n                                border-radius: 4px;\n                                border: 1px solid rgba(0,0,0,0.15);\n                                background: transparent;\n                                cursor: pointer;\n                            `}\n                        >Go</button>\n                    </div>\n                </div>\n            </div>\n            <TraceDetail onClose={() => setDrawerOpen(false)} open={drawerOpen} traceId={selectedRow?.trace_id} traceTable=\"otel_traces\" />\n\n            {surroundingLogsOpen && (\n                <Drawer\n                    size=\"lg\"\n                    title=\"Surrounding items\"\n                    onClose={() => {\n                        setSurroundingTableData([]);\n                        setSurroundingDataFilter([]);\n                        setBeforeCount(0);\n                        setAfterCount(0);\n                        // setSelectedSurroundingFields([]);\n                        setSurroundingLogsOpen(false);\n                    }}\n                >\n                    <SurroundingLogs />\n                </Drawer>\n            )}\n        </div>\n    );\n}\n","import { css } from '@emotion/css';\nimport styled from '@emotion/styled';\n\nexport const DiscoverHeaderSearch = styled.div`\n    flex: 2;\n    display: flex;\n    border-radius: 6px;\n    align-items: center;\n    margin-right: 8px;\n    .ant-select-open {\n        .ant-select-arrow {\n            .anticon {\n                transform: rotate(-180deg);\n            }\n        }\n    }\n    .select-database {\n        width: 160px;\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n    }\n    .ant-select-single {\n        height: 30px;\n    }\n`;\n\nexport const DiscoverHeaderTimeSelect = styled.div`\n    flex: 1;\n    display: flex;\n    border-radius: 6px;\n    align-items: center;\n    margin-right: 8px;\n\n    div.trp-time-label {\n        border: 0px;\n    }\n`;\n\nexport const CascaderStyle = css`\n    width: 184px;\n    .ant-select-selector {\n        padding: 0 16px 0 40px !important;\n    }\n    .ant-select-selection-placeholder,\n    .ant-select-selection-item {\n        margin-top: 2px;\n    }\n    .ant-select-selector>.ant-select-selection-search>.ant-select-selection-search-input {\n        margin-left: 1.8rem;\n    }\n`;\n","import { useAtom, useAtomValue, useSetAtom } from 'jotai';\nimport React from 'react';\nimport { currentIndexAtom, disabledOptionsAtom, indexesAtom, searchTypeAtom, searchValueAtom, selectedIndexesAtom } from 'store/discover';\nimport { useTheme2, ActionMeta, Icon, MultiSelect, RadioButtonGroup, Toggletip } from '@grafana/ui';\nimport { css } from '@emotion/css';\nimport { SelectableValue } from '@grafana/data';\nimport { useTranslation } from 'react-i18next';\n\nexport default function SearchType() {\n    const { t } = useTranslation();\n    const [searchType, setSearchType] = useAtom(searchTypeAtom);\n    const setSearchValue = useSetAtom(searchValueAtom);\n    const disabledOptions = useAtomValue(disabledOptionsAtom);\n    const indexes = useAtomValue(indexesAtom);\n    const setSelectedIndexes = useSetAtom(selectedIndexesAtom);\n    const [currentIndex, setCurrentIndex] = useAtom(currentIndexAtom);\n    const searchMode = searchType === 'Search';\n    const theme = useTheme2();\n       \n    const options = [\n        // {\n        //     label: t`Search`,\n        //     value: 'Search',\n        //     disabled: indexes.length === 0,\n        //     tips: t`Discover.SearchType.Search.DisabledText`,\n        // },\n        { label: 'SQL', value: 'SQL' },\n        { label: 'Lucene', value: 'Lucene' },\n    ];\n\n    function DropdownQueryType() {\n        return (\n            <div className=\"w-[232px]\">\n                <RadioButtonGroup\n                    options={options}\n                    disabledOptions={disabledOptions}\n                    value={searchType}\n                    onChange={val => {\n                        setSearchType(val as 'Search' | 'SQL' | 'Lucene');\n                        setSearchValue('');\n                    }}\n                />\n                {indexes && searchMode ? (\n                    <div className=\"mt-4\">\n                        <MultiSelect\n                            options={indexes.filter((item: any) => item.type === 'INVERTED')}\n                            value={currentIndex}\n                            onChange={(item: Array<SelectableValue<any>>, actionMeta: ActionMeta) => {\n                                const selectedIndexes: any[] = [];\n                                item.forEach(selectedValue => {\n                                    indexes.forEach((item: any) => {\n                                        if (item.value === selectedValue) {\n                                            selectedIndexes.push(item);\n                                        }\n                                    });\n                                });\n                                setSelectedIndexes(selectedIndexes);\n                                setCurrentIndex(item as any);\n                            }}\n                        />\n                    </div>\n                ) : (\n                    <></>\n                )}\n            </div>\n        );\n    }\n    return (\n        <>\n            <Toggletip closeButton={false} content={<DropdownQueryType />} placement=\"bottom\">\n                <div\n                    className={css`\n                        cursor: pointer;\n                        border: 1px solid rgba(204, 204, 220, 0.2);\n                        width: 80px;\n                        height: 32px;\n                        line-height: 32px;\n                        background-color: ${theme.isDark ? 'rgb(17, 18, 23)' : '#FFF'};\n                        padding-left: 8px;\n                        border-radius: 2px;\n                        display: flex;\n                        justify-content: space-between;\n                    `}\n                >\n                    <span >{searchType}</span>\n                    <span style={{ marginRight: 6 }}>\n                        <Icon name=\"angle-down\" />\n                    </span>\n                </div>\n            </Toggletip>\n        </>\n    );\n}\n","import React, { CSSProperties } from 'react';\nimport { useAtom, useAtomValue } from 'jotai';\n// import { useTranslation } from 'react-i18next';\n// import { SQL_OPERATORS } from 'utils/data';\n// import { cn } from 'utils/tailwind';\nimport {\n  searchTypeAtom,\n  searchValueAtom,\n  // currentTimeFieldAtom,\n} from 'store/discover';\nimport { Input } from '@grafana/ui';\n// import { CodeEditor, CodeEditorSuggestionItem, ReactMonacoEditor } from '@grafana/ui';\n\n\nexport default function SQLSearch({ style, onQuerying }: { style?: CSSProperties; onQuerying: () => void }) {\n  const searchType = useAtomValue(searchTypeAtom);\n  // const setSearchFocus = useSetAtom(searchFocusAtom);\n  // const [tableFields, setTableFields] = useAtom(tableFieldsAtom);\n  const [searchValue, setSearchValue] = useAtom(searchValueAtom);\n  // const currentTimeField = useAtomValue(currentTimeFieldAtom);\n  if (process.env.NODE_ENV !== 'production') {\n    searchValueAtom.debugLabel = 'searchValue';\n  }\n  // const [options, setOptions] = useState<Array<{ value: string; label: string }>>([]);\n  // const inputRef = useRef<any>(null);\n\n  // let disableEnter = false;\n\n  //   const getSuggestions = (): CodeEditorSuggestionItem[] => {\n  //     return [];\n  //   };\n\n  return (\n    <Input\n      value={searchValue}\n      onChange={(e: any) => {\n        console.log(e);\n        setSearchValue(e.target?.value);\n      }}\n      onKeyDown={(e: React.KeyboardEvent<HTMLInputElement>) => {\n        // Ignore composition (IME) events\n        const native = (e as any).nativeEvent;\n        if (e.key === 'Enter' && !(native && native.isComposing)) {\n          // Trigger query callback if provided\n          try {\n            onQuerying?.();\n          } catch (err) {\n            // swallow errors from callback to avoid breaking the input\n            // eslint-disable-next-line no-console\n            console.error('onQuerying handler error:', err);\n          }\n        }\n      }}\n      placeholder={\n        searchType === 'SQL' ? \"SQL WHERE. e.g.(event_type = 'ForkApplyEvent AND action = 'none')\" : 'Keyword'\n      }\n      style={style}\n    />\n    // <CodeEditor language=\"mysql\" value={searchValue} height={28} width={600} getSuggestions={getSuggestions} showMiniMap={false} showLineNumbers={false} />\n    // <AutoComplete\n    //     className=\"h-8\"\n    //     popupClassName={cn(AutoCompletePopupStyle)}\n    //     options={\n    //         searchType === 'SQL'\n    //             ? options.length > 0\n    //                 ? options\n    //                 : [\n    //                       ...tableFields.map((e: any) => {\n    //                           return { label: e.Field, value: e.Field };\n    //                       }),\n    //                       ...SQL_OPERATORS.map(e => {\n    //                           return { label: e, value: e };\n    //                       }),\n    //                   ]\n    //             : []\n    //     }\n    //     onSelect={value => {\n    //         disableEnter = true;\n    //         const pos = inputRef.current?.input?.selectionStart;\n    //         if (pos !== null && pos !== undefined) {\n    //             const [posL, posR] = getWordPosLR(searchValue, pos - 1);\n    //             let res = '';\n    //             if (posL !== -1) {res += searchValue.substring(0, posL) + ' ';}\n    //             res += value;\n    //             if (posR !== searchValue.length) {res += ' ' + searchValue.substring(posR + 1);}\n    //             setSearchValue(res);\n    //         } else {\n    //             setSearchValue(searchValue + value);\n    //         }\n    //     }}\n    //     value={searchValue}\n    //     onChange={e => {\n    //         setSearchValue(e);\n    //     }}\n    //     onKeyDown={e => {\n    //         if (e.key === 'Enter' && !e.nativeEvent.isComposing && !disableEnter) {\n    //             if (currentTimeField) {\n    //                 onQuerying();\n    //             } else {\n    //                 message.warning(t`Discover.SQLSearch.NoTimeField.Tips`);\n    //             }\n    //         }\n    //     }}\n    //     filterOption={(inputValue, option) => {\n    //         const pos = inputRef.current?.input?.selectionStart;\n    //         if (pos !== null && pos !== undefined) {\n    //             const [posL, posR] = getWordPosLR(searchValue, pos - 1);\n    //             const str = inputValue.substring(posL + 1, posR);\n    //             return option?.value.toUpperCase().indexOf(str.toUpperCase()) !== -1;\n    //         }\n    //         const inputArr = inputValue.split(' ');\n    //         const value = inputArr[inputArr.length - 1];\n    //         return option?.value.toUpperCase().indexOf(value.toUpperCase()) !== -1;\n    //     }}\n    //     style={style}\n    // >\n    //     <Input\n    //         onBlur={() => setSearchFocus(false)}\n    //         onFocus={() => setSearchFocus(true)}\n    //         className=\"-mt-[2px] h-[32px] border-none hover:placeholder:text-n1 focus:placeholder:text-n6\"\n    //         ref={inputRef}\n    //         placeholder={searchType === 'SQL' ? \"SQL WHERE. e.g.(event_type = 'ForkApplyEvent AND action = 'none')\" : 'Keyword'}\n    //     />\n    // </AutoComplete>\n  );\n}\n","import React from 'react';\nimport { useAtom } from 'jotai';\nimport { searchValueAtom } from 'store/discover';\nimport { Input } from '@grafana/ui';\n\nexport default function Lucene({ onQuerying }: { onQuerying?: () => void }) {\n    const [searchValue, setSearchValue] = useAtom(searchValueAtom);\n    if (process.env.NODE_ENV !== 'production') {\n        searchValueAtom.debugLabel = 'searchValue';\n    }\n\n    return (\n        <Input\n            value={searchValue}\n            onChange={(e: any) => {\n                console.log(e);\n                setSearchValue(e.target?.value);\n            }}\n            onKeyDown={(e: React.KeyboardEvent<HTMLInputElement>) => {\n                const native = (e as any).nativeEvent;\n                if (e.key === 'Enter' && !(native && native.isComposing)) {\n                    try {\n                        onQuerying?.();\n                    } catch (err) {\n                        // eslint-disable-next-line no-console\n                        console.error('onQuerying handler error:', err);\n                    }\n                }\n            }}\n            placeholder=\"usage: field:value AND field2:value2\"\n        />\n    );\n}\n","'use client';\nimport React, { PropsWithChildren, useEffect } from 'react';\nimport dayjs from 'dayjs';\nimport { DiscoverHeaderSearch } from './discover-header.style';\nimport SearchType from './search-type';\nimport SQLSearch from './sql-search';\nimport { useAtom, useAtomValue, useSetAtom } from 'jotai';\nimport { DataSourcePicker } from '@grafana/runtime';\nimport { css } from '@emotion/css';\nimport {\n    indexesAtom,\n    searchTypeAtom,\n    discoverCurrentAtom,\n    locationAtom,\n    // currentClusterAtom,\n    tableFieldsAtom,\n    timeFieldsAtom,\n    currentDateAtom,\n    currentTimeFieldAtom,\n    currentIndexAtom,\n    searchFocusAtom,\n    activeShortcutAtom,\n    datasourcesAtom,\n    selectedDatasourceAtom,\n    timeRangeAtom,\n    databasesAtom,\n    tablesAtom,\n    currentTableAtom,\n} from 'store/discover';\nimport { getLatestTime, isValidTimeFieldType } from 'utils/data';\nimport { Select, Field, Button, useTheme2, TimeRangeInput } from '@grafana/ui';\nimport { FORMAT_DATE } from '../../constants';\nimport { getDatabases, getFieldsService, getIndexesService, getTablesService } from 'services/metaservice';\nimport { Subscription } from 'rxjs';\nimport { toDataFrame } from '@grafana/data';\nimport Lucene from './lucene';\n\nexport default function DiscoverHeader(\n    props: PropsWithChildren & {\n        onQuerying: () => void;\n        loading: boolean;\n    },\n) {\n    // const catalog = 'internal';\n    // const catalogs = useAtomValue(catalogAtom);\n    const setIndexes = useSetAtom(indexesAtom);\n    // const setSearchType = useSetAtom(searchTypeAtom);\n    const [discoverCurrent, setDiscoverCurrent] = useAtom(discoverCurrentAtom);\n    if (process.env.NODE_ENV !== 'production') {\n        discoverCurrentAtom.debugLabel = 'current';\n    }\n    const [_loc, setLoc] = useAtom(locationAtom);\n    // const [currentCluster, setCurrentCluster] = useAtom(currentClusterAtom);\n    const setTableFields = useSetAtom(tableFieldsAtom);\n    const [timeFields, setTimeFields] = useAtom(timeFieldsAtom);\n    const [_currentDate, setCurrentDate] = useAtom(currentDateAtom);\n    const currentTimeField = useAtomValue(currentTimeFieldAtom);\n    const [, setCurrentIndex] = useAtom(currentIndexAtom);\n    const searchFocus = useAtomValue(searchFocusAtom);\n    // const { databaseList } = useDatabaseList();\n    const [activeItem, _setActiveItem] = useAtom(activeShortcutAtom);\n    // const [clusters, setClusters] = useState<any[]>([]);\n    // const database = loc.searchParams?.get('database');\n    // const table = loc.searchParams?.get('table');\n    // const cluster = loc.searchParams?.get('cluster');\n    // const startTime = loc.searchParams?.get('startTime');\n    // const endTime = loc.searchParams?.get('endTime');\n    const [selectedDatasource, setSelectedDatasource] = useAtom(selectedDatasourceAtom);\n    const [timeRange, setTimeRange] = useAtom(timeRangeAtom);\n    const [currentTable, setCurrentTable] = useAtom(currentTableAtom);\n    const [databases, setDatabases] = useAtom(databasesAtom);\n    const [tables, setTables] = useAtom(tablesAtom);\n    const [_datasources] = useAtom(datasourcesAtom);\n    const searchType = useAtomValue(searchTypeAtom);\n    const searchMode = searchType === 'Search';\n\n    const selectdbDS = useAtomValue(selectedDatasourceAtom);\n    const theme = useTheme2();\n\n    const fetchDatabases = React.useCallback((ds: any) => {\n        if (!ds) {\n            return undefined;\n        }\n\n        return getDatabases(ds).subscribe({\n            next: (resp: any) => {\n                const { data, ok } = resp;\n                if (ok) {\n                    const frame = toDataFrame(data.results.getDatabases.frames[0]);\n                    const values = Array.from(frame.fields[0].values);\n                    const options = values.map((item: string) => ({ label: item, value: item }));\n                    setDatabases(options);\n                }\n            },\n            error: (err: any) => console.log('Fetch Error', err),\n        });\n    }, [setDatabases]);\n\n    useEffect(() => {\n        if (!selectdbDS) {\n            return;\n        }\n\n        const subscription: Subscription | undefined = fetchDatabases(selectdbDS);\n\n        return () => subscription?.unsubscribe();\n    }, [selectdbDS, fetchDatabases]);\n\n    function getFields(selectedTable: any) {\n        getFieldsService({\n            selectdbDS,\n            database: discoverCurrent.database,\n            table: selectedTable.value,\n        }).subscribe({\n            next: ({ data, ok }: any) => {\n                if (ok) {\n                    const frame = toDataFrame(data.results.getFields.frames[0]);\n                    console.log('frame', frame);\n                    const values = Array.from(frame.fields[0].values);\n                    const fieldTypes = Array.from(frame.fields[1].values);\n\n                    const tableFields = values.map((item: any, index: number) => {\n                        return {\n                            label: item,\n                            Field: item,\n                            value: item,\n                            Type: fieldTypes[index],\n                        };\n                    });\n\n                    setTableFields(tableFields);\n\n                    if (values) {\n                        const options = values\n                            .filter((field: any, index: number) => {\n                                return isValidTimeFieldType(fieldTypes[index].toUpperCase());\n                            })\n                            .map((item: any) => {\n                                return {\n                                    label: item,\n                                    value: item,\n                                };\n                            });\n                            console.log('bbb,',discoverCurrent);\n                            \n                        setDiscoverCurrent({\n                            ...discoverCurrent,\n                            table: selectedTable.value,\n                            timeField: options[0]?.value || '',\n                        });\n                        setTimeFields(options);\n                    }\n                }\n            },\n            error: (err: any) => {\n                console.log('Fetch Error', err);\n            },\n        });\n    }\n\n    function getIndexes(selectedTable: any) {\n        getIndexesService({\n            selectdbDS,\n            database: discoverCurrent.database,\n            table: selectedTable.value,\n        }).subscribe({\n            next: ({ data, ok }: any) => {\n                if (ok) {\n                    const frame = toDataFrame(data.results.getIndexes.frames[0]);\n                    const values = Array.from(frame.fields[2].values);\n                    const columnNames = Array.from(frame.fields[4].values);\n                    const indexesTypes = Array.from(frame.fields[10].values);\n\n                    if (!values || values.length === 0) {\n                        setIndexes([]);\n                        setCurrentIndex([]);\n                        return;\n                    }\n\n                    const tableIndexes = values?.map((item: any, index: number) => {\n                        return {\n                            label: item,\n                            value: item,\n                            type: indexesTypes[index],\n                            columnName: columnNames[index],\n                        };\n                    });\n\n                    setIndexes(tableIndexes);\n\n                    if (tableIndexes) {\n                        setCurrentIndex(tableIndexes);\n                    }\n                }\n            },\n            error: (err: any) => {\n                console.log('Fetch Error', err);\n            },\n        });\n    }\n\n    return (\n        <div\n            className={css`\n                padding: 1rem;\n                padding-top: 1.5rem;\n                background-color: ${theme.isDark ? 'rgb(24, 27, 31)' : '#FFF'};\n                display: flex;\n                border-radius: 0.25rem 0.25rem 0 0;\n            `}\n        >\n            <DiscoverHeaderSearch className=\"h-8 rounded border border-solid border-n9 dark:border-n7\">\n                <Field label=\"Datasource\">\n                    {/* filter  */}\n                    <DataSourcePicker\n                         width={20}\n                         type={'mysql'}\n                         current={selectedDatasource}\n                         placeholder=\"Choose\"\n                         noDefault\n                         filter={ds => ds.type === 'mysql'}\n                         onChange={item => {\n                             console.log('item', item);\n                             setSelectedDatasource(item);\n                             // Always fetch databases even if the same datasource is selected\n                             fetchDatabases(item);\n                         }}\n                     />\n                 </Field>\n                {/*  */}\n                <Field label=\"Database\" style={{ marginLeft: 8 }}>\n                    <Select\n                        width={15}\n                        options={databases}\n                        value={discoverCurrent.database}\n                        onChange={(selectedDatabase: any) => {\n                            setDiscoverCurrent({\n                                ...discoverCurrent,\n                                database: selectedDatabase.value,\n                            });\n                            getTablesService({\n                                selectdbDS,\n                                database: selectedDatabase.value,\n                            }).subscribe({\n                                next: (resp: any) => {\n                                    const { data, ok } = resp;\n                                    if (ok) {\n                                        const frame = toDataFrame(data.results.getTables.frames[0]);\n                                        const values = Array.from(frame.fields[0].values);\n                                        const options = values.map((item: string) => ({ label: item, value: item }));\n                                        setTables(options);\n                                    }\n                                },\n                                error: (err: any) => console.log('Fetch Error', err),\n                            });\n                        }}\n                    ></Select>\n                </Field>\n\n                <Field label=\"Table\" style={{ marginLeft: 8 }}>\n                    <Select\n                        options={tables}\n                        width={15}\n                        value={currentTable}\n                        onChange={(selectedTable: any) => {\n                            console.log('selectedTable.value',selectedTable.value);\n                            \n                            setDiscoverCurrent({\n                                ...discoverCurrent,\n                                table: selectedTable.value,\n                            });\n                            setCurrentTable(selectedTable.value);\n                            getFields(selectedTable);\n                            getIndexes(selectedTable);\n                        }}\n                    />\n                </Field>\n                <Field label=\"Mode\" style={{ marginLeft: 8, marginRight: 8, width: '120px' }}>\n                    <SearchType />\n                </Field>\n                {searchType === 'Lucene' ? (\n                    <Field label=\"Lucene\" style={{ width: '100%' }}>\n                        <Lucene onQuerying={() => props?.onQuerying()} />\n                    </Field>\n                ) : (\n                    <Field label={searchMode ? 'Search' : 'SQL'} style={{ width: '100%' }}>\n                        <SQLSearch\n                            style={{ flex: '1' }}\n                            onQuerying={() => {\n                                props?.onQuerying();\n                            }}\n                        />\n                    </Field>\n                )}\n            </DiscoverHeaderSearch>\n            {!searchFocus && (\n                <>\n                    <Field label=\"Time Field\">\n                        <Select\n                            value={currentTimeField}\n                            options={timeFields}\n                            onChange={(selectdbTimeFiled: any) => {\n                                setDiscoverCurrent({\n                                    ...discoverCurrent,\n                                    timeField: selectdbTimeFiled.value,\n                                });\n                                setLoc((prev: any) => {\n                                    const searchParams = prev.searchParams;\n                                    searchParams?.set('timeField', selectdbTimeFiled.value);\n                                    return {\n                                        ...prev,\n                                        searchParams,\n                                    };\n                                });\n                            }}\n                            placeholder={'Time Field'}\n                        />\n                    </Field>\n                    <Field label=\"Time Range\" style={{ marginLeft: 8, marginRight: 8 }}>\n                        <TimeRangeInput\n                            isReversed={false}\n                            onChange={timeRange => {\n                                const start = dayjs(timeRange.from.toDate());\n                                const end = dayjs(timeRange.to.toDate());\n                                setLoc(prev => {\n                                    const searchParams = prev.searchParams;\n                                    searchParams?.set('startTime', start.format(FORMAT_DATE));\n                                    searchParams?.set('endTime', end.format(FORMAT_DATE));\n                                    return {\n                                        ...prev,\n                                        searchParams,\n                                    };\n                                });\n                                setCurrentDate([start, end]);\n                                setTimeRange(timeRange);\n                            }}\n                            value={timeRange}\n                        />\n                    </Field>\n                </>\n            )}\n            <Field label=\"\">\n                <Button\n                    onClick={() => {\n                        const latestTime = getLatestTime(activeItem?.key as string);\n                        if (latestTime) {\n                            const [latestStartTime, latestEndTime] = latestTime;\n                            setLoc(prev => {\n                                const searchParams = prev.searchParams;\n                                searchParams?.set('startTime', dayjs(latestStartTime).format(FORMAT_DATE));\n                                searchParams?.set('endTime', dayjs(latestEndTime).format(FORMAT_DATE));\n                                return {\n                                    ...prev,\n                                    searchParams,\n                                };\n                            });\n                        }\n                        props?.onQuerying();\n                    }}\n                    variant=\"primary\"\n                    className=\"h-8\"\n                    icon={props?.loading ? 'fa fa-spinner' : 'sync'}\n                    disabled={!currentTimeField}\n                >\n                    {`Query`}\n                </Button>\n            </Field>\n        </div>\n    );\n}\n","export function encodeSpecialTokens(query: string): string {\n    return query\n        .replace(/\\\\\\\\/g, 'HDX_BACKSLASH_LITERAL')\n        .replace('http://', 'http_COLON_//')\n        .replace('https://', 'https_COLON_//')\n        .replace(/localhost:(\\d{1,5})/, 'localhost_COLON_$1')\n        .replace(/\\\\:/g, 'HDX_COLON');\n}\n\nexport function decodeSpecialTokens(query: string): string {\n    return query\n        .replace(/\\\\\"/g, '\"')\n        .replace(/HDX_BACKSLASH_LITERAL/g, '\\\\')\n        .replace('http_COLON_//', 'http://')\n        .replace('https_COLON_//', 'https://')\n        .replace(/localhost_COLON_(\\d{1,5})/, 'localhost:$1')\n        .replace(/HDX_COLON/g, ':');\n}\n","export const IMPLICIT_FIELD = '<implicit>';\n\nexport const CLICK_HOUSE_JSON_NUMBER_TYPES = [\n    'Int8',\n    'Int16',\n    'Int32',\n    'Int64',\n    'Int128',\n    'Int256',\n    'UInt8',\n    'UInt16',\n    'UInt32',\n    'UInt64',\n    'UInt128',\n    'UInt256',\n    'Float32',\n    'Float64',\n];\n","type Primitive = string | number | boolean | bigint | null | undefined | Date;\n\ntype RawSql = {\n    __raw: true;\n    value: string;\n};\n\nconst RAW_FLAG = '__raw';\n\nconst escapeString = (value: string): string => {\n    const escaped = value.replace(/\\\\/g, '\\\\\\\\').replace(/'/g, \"\\\\'\");\n    return `'${escaped}'`;\n};\n\nconst formatDate = (value: Date): string => {\n    const pad = (input: number) => input.toString().padStart(2, '0');\n    const year = value.getFullYear();\n    const month = pad(value.getMonth() + 1);\n    const day = pad(value.getDate());\n    const hours = pad(value.getHours());\n    const minutes = pad(value.getMinutes());\n    const seconds = pad(value.getSeconds());\n\n    return `'${year}-${month}-${day} ${hours}:${minutes}:${seconds}'`;\n};\n\nconst escapePrimitive = (value: Primitive | RawSql): string => {\n    if (isRaw(value)) {\n        return value.value;\n    }\n\n    if (value === null || value === undefined) {\n        return 'NULL';\n    }\n\n    if (value instanceof Date) {\n        return formatDate(value);\n    }\n\n    switch (typeof value) {\n        case 'number':\n        case 'bigint':\n            return `${value}`;\n        case 'boolean':\n            return value ? '1' : '0';\n        default:\n            return escapeString(String(value));\n    }\n};\n\nconst escapeIdentifier = (identifier: string | RawSql): string => {\n    if (isRaw(identifier)) {\n        return identifier.value;\n    }\n\n    return identifier\n        .split('.')\n        .map(part => {\n            if (part === '*') {\n                return '*';\n            }\n            return `\\`${part.replace(/`/g, '``')}\\``;\n        })\n        .join('.');\n};\n\nconst escapeValue = (value: any): string => {\n    if (isRaw(value)) {\n        return value.value;\n    }\n\n    if (Array.isArray(value)) {\n        const list = value.map(item => escapeValue(item));\n        return `(${list.join(', ')})`;\n    }\n\n    if (value && typeof value === 'object' && !(value instanceof Date)) {\n        return escapeString(JSON.stringify(value));\n    }\n\n    return escapePrimitive(value as Primitive);\n};\n\nconst isRaw = (value: unknown): value is RawSql => Boolean(value && typeof value === 'object' && RAW_FLAG in (value as any));\n\nconst format = (sql: string, values?: any[]): string => {\n    if (!values || values.length === 0) {\n        return sql;\n    }\n\n    let index = 0;\n\n    return sql.replace(/\\?\\?|\\?/g, placeholder => {\n        if (index >= values.length) {\n            return placeholder;\n        }\n\n        const value = values[index++];\n\n        if (placeholder === '??') {\n            if (Array.isArray(value)) {\n                return value.map(v => escapeIdentifier(v)).join(', ');\n            }\n            return escapeIdentifier(value);\n        }\n\n        return escapeValue(value);\n    });\n};\n\nconst raw = (value: string): RawSql => ({\n    __raw: true,\n    value,\n});\n\nconst SqlString = {\n    format,\n    raw,\n};\n\nexport default SqlString;\n","export enum JSDataType {\n    Array = 'array',\n    Date = 'date',\n    Map = 'map',\n    Number = 'number',\n    String = 'string',\n    Tuple = 'tuple',\n    Bool = 'bool',\n    JSON = 'json',\n    Dynamic = 'dynamic', // json type will store anything as Dynamic type by default\n}\n\nexport const convertCHDataTypeToJSType = (dataType: string): JSDataType | null => {\n    if (dataType.startsWith('Date')) {\n        return JSDataType.Date;\n    } else if (dataType.startsWith('Tuple')) {\n        return JSDataType.Tuple;\n    } else if (dataType.startsWith('Map')) {\n        return JSDataType.Map;\n    } else if (dataType.startsWith('Array')) {\n        return JSDataType.Array;\n    } else if (\n        dataType.startsWith('Int') ||\n        dataType.startsWith('UInt') ||\n        dataType.startsWith('Float') ||\n        // Nullable types are possible (charts)\n        dataType.startsWith('Nullable(Int') ||\n        dataType.startsWith('Nullable(UInt') ||\n        dataType.startsWith('Nullable(Float')\n    ) {\n        return JSDataType.Number;\n    } else if (\n        dataType.startsWith('String') ||\n        dataType.startsWith('FixedString') ||\n        dataType.startsWith('Enum') ||\n        dataType.startsWith('UUID') ||\n        dataType.startsWith('IPv4') ||\n        dataType.startsWith('IPv6')\n    ) {\n        return JSDataType.String;\n    } else if (dataType === 'Bool') {\n        return JSDataType.Bool;\n    } else if (dataType.startsWith('JSON')) {\n        return JSDataType.JSON;\n    } else if (dataType.startsWith('Dynamic')) {\n        return JSDataType.Dynamic;\n    } else if (dataType.startsWith('LowCardinality')) {\n        return convertCHDataTypeToJSType(dataType.slice(15, -1));\n    }\n\n    return null;\n};\n\nexport const convertCHTypeToPrimitiveJSType = (dataType: string) => {\n    const jsType = convertCHDataTypeToJSType(dataType);\n\n    if (jsType === JSDataType.Map || jsType === JSDataType.Array || jsType === JSDataType.Tuple) {\n        throw new Error('Map, Array or Tuple type is not a primitive type');\n    } else if (jsType === JSDataType.Date) {\n        return JSDataType.Number;\n    }\n\n    return jsType;\n};\n","// Replace splitAndTrimCSV, should remove splitAndTrimCSV later\nexport function splitAndTrimWithBracket(input: string): string[] {\n    let parenCount = 0;\n    let squareCount = 0;\n    let inSingleQuote = false;\n    let inDoubleQuote = false;\n\n    const res: string[] = [];\n    let cur = '';\n    for (const c of input + ',') {\n        if (c === '\"' && !inSingleQuote) {\n            inDoubleQuote = !inDoubleQuote;\n            cur += c;\n            continue;\n        }\n\n        if (c === \"'\" && !inDoubleQuote) {\n            inSingleQuote = !inSingleQuote;\n            cur += c;\n            continue;\n        }\n        // Only count brackets when not in quotes\n        if (!inSingleQuote && !inDoubleQuote) {\n            if (c === '(') {\n                parenCount++;\n            } else if (c === ')') {\n                parenCount--;\n            } else if (c === '[') {\n                squareCount++;\n            } else if (c === ']') {\n                squareCount--;\n            }\n        }\n\n        if (c === ',' && parenCount === 0 && squareCount === 0 && !inSingleQuote && !inDoubleQuote) {\n            const trimString = cur.trim();\n            if (trimString) {\n                res.push(trimString)\n            };\n            cur = '';\n        } else {\n            cur += c;\n        }\n    }\n    return res;\n}\n","// @ts-ignore: no type declarations for '@hyperdx/lucene'\nimport lucene from '@hyperdx/lucene';\nimport SqlString from './sqlstring-browser';\nimport { getColumn as getColumnMetadata, getInvertedIndexColumns } from '../../services/metaservice';\nimport { convertCHTypeToPrimitiveJSType, JSDataType } from './enums';\nimport { splitAndTrimWithBracket } from './utils';\nimport { CLICK_HOUSE_JSON_NUMBER_TYPES, IMPLICIT_FIELD } from './constants';\n\nexport type ColumnLookup = {\n    name: string;\n    type: string;\n    dataType?: string;\n    columnType?: string;\n};\n\nexport type LegacyMetadataProvider = {\n    getColumn: (params: {\n        databaseName: string;\n        tableName: string;\n        column: string;\n        connectionId: string;\n    }) => Promise<{ name: string; type: string } | null>;\n};\n\ntype ImplicitTextSearchTarget = {\n    column: string;\n    sourceColumn: string;\n    propertyType?: JSDataType;\n    supportsTextSearch?: boolean;\n};\n\nexport interface Serializer {\n    operator(op: lucene.Operator): string;\n    eq(field: string, term: string, isNegatedField: boolean): Promise<string>;\n    isNotNull(field: string, isNegatedField: boolean): Promise<string>;\n    gte(field: string, term: string): Promise<string>;\n    lte(field: string, term: string): Promise<string>;\n    lt(field: string, term: string): Promise<string>;\n    gt(field: string, term: string): Promise<string>;\n    fieldSearch(\n        field: string,\n        term: string,\n        isNegatedField: boolean,\n        prefixWildcard: boolean,\n        suffixWildcard: boolean,\n        isPhrase: boolean,\n    ): Promise<string>;\n    range(field: string, start: string, end: string, isNegatedField: boolean): Promise<string>;\n}\n\nexport class EnglishSerializer implements Serializer {\n    private translateField(field: string) {\n        if (field === IMPLICIT_FIELD) {\n            return 'event';\n        }\n\n        return `'${field}'`;\n    }\n\n    operator(op: lucene.Operator) {\n        switch (op) {\n            case 'NOT':\n            case 'AND NOT':\n                return 'AND NOT';\n            case 'OR NOT':\n                return 'OR NOT';\n            // @ts-ignore TODO: Types need to be fixed upstream\n            case '&&':\n            case '<implicit>':\n            case 'AND':\n                return 'AND';\n            // @ts-ignore TODO: Types need to be fixed upstream\n            case '||':\n            case 'OR':\n                return 'OR';\n            default:\n                throw new Error(`Unexpected operator. ${op}`);\n        }\n    }\n\n    async eq(field: string, term: string, isNegatedField: boolean) {\n        return `${this.translateField(field)} ${isNegatedField ? 'is not' : 'is'} ${term}`;\n    }\n\n    async isNotNull(field: string, isNegatedField: boolean) {\n        return `${this.translateField(field)} ${isNegatedField ? 'is null' : 'is not null'}`;\n    }\n\n    async gte(field: string, term: string) {\n        return `${this.translateField(field)} is greater than or equal to ${term}`;\n    }\n\n    async lte(field: string, term: string) {\n        return `${this.translateField(field)} is less than or equal to ${term}`;\n    }\n\n    async lt(field: string, term: string) {\n        return `${this.translateField(field)} is less than ${term}`;\n    }\n\n    async gt(field: string, term: string) {\n        return `${this.translateField(field)} is greater than ${term}`;\n    }\n\n    async fieldSearch(\n        field: string,\n        term: string,\n        isNegatedField: boolean,\n        prefixWildcard: boolean,\n        suffixWildcard: boolean,\n        isPhrase: boolean,\n    ) {\n        if (field === IMPLICIT_FIELD) {\n            return `${this.translateField(field)} ${\n                prefixWildcard && suffixWildcard\n                    ? isNegatedField\n                        ? 'does not contain'\n                        : 'contains'\n                    : prefixWildcard\n                      ? isNegatedField\n                          ? 'does not end with'\n                          : 'ends with'\n                      : suffixWildcard\n                        ? isNegatedField\n                            ? 'does not start with'\n                            : 'starts with'\n                        : isNegatedField\n                          ? 'does not have whole word'\n                          : 'has whole word'\n            } ${term}`;\n        }\n\n        return `${this.translateField(field)} ${isNegatedField ? 'does not contain' : 'contains'} ${term}`;\n    }\n\n    async range(field: string, start: string, end: string, isNegatedField: boolean) {\n        return `${field} ${isNegatedField ? 'is not' : 'is'} between ${start} and ${end}`;\n    }\n}\n\nexport abstract class SQLSerializer implements Serializer {\n    private NOT_FOUND_QUERY = '(1 = 0)';\n\n    abstract getColumnForField(field: string): Promise<{\n        column?: string;\n        columnJSON?: { string: string; number: string };\n        propertyType?: JSDataType;\n        supportsTextSearch?: boolean;\n        sourceColumn?: string;\n        implicitTargets?: ImplicitTextSearchTarget[];\n        found: boolean;\n    }>;\n\n    operator(op: lucene.Operator) {\n        switch (op) {\n            case 'NOT':\n            case 'AND NOT':\n                return 'AND NOT';\n            case 'OR NOT':\n                return 'OR NOT';\n            // @ts-ignore TODO: Types need to be fixed upstream\n            case '&&':\n            case '<implicit>':\n            case 'AND':\n                return 'AND';\n            // @ts-ignore TODO: Types need to be fixed upstream\n            case '||':\n            case 'OR':\n                return 'OR';\n            default:\n                throw new Error(`Unexpected operator. ${op}`);\n        }\n    }\n\n    async eq(field: string, term: string, isNegatedField: boolean) {\n        const { column, columnJSON, found, propertyType, supportsTextSearch, sourceColumn } =\n            await this.getColumnForField(field);\n        if (!found) {\n            return this.NOT_FOUND_QUERY;\n        }\n        if (propertyType === JSDataType.Bool) {\n            const normTerm = `${term}`.trim().toLowerCase();\n            return SqlString.format(`(?? ${isNegatedField ? '!' : ''}= ?)`, [\n                column,\n                normTerm === 'true' ? 1 : normTerm === 'false' ? 0 : parseInt(normTerm, 10),\n            ]);\n        } else if (propertyType === JSDataType.Number) {\n            return SqlString.format(`(${column} ${isNegatedField ? '!' : ''}= CAST(?, 'Float64'))`, [term]);\n        } else if (propertyType === JSDataType.JSON) {\n            return SqlString.format(`(${columnJSON?.string} ${isNegatedField ? '!' : ''}= ?)`, [term]);\n        } else if (propertyType === JSDataType.String && supportsTextSearch) {\n            const searchTarget = column && column.length > 0 ? column : sourceColumn;\n            if (!searchTarget) {\n                return this.NOT_FOUND_QUERY;\n            }\n            return SqlString.format(`(? ${isNegatedField ? 'NOT ' : ''}MATCH_PHRASE ?)`, [\n                SqlString.raw(searchTarget),\n                term,\n            ]);\n        }\n        return SqlString.format(`(${column} ${isNegatedField ? '!' : ''}= ?)`, [term]);\n    }\n\n    async isNotNull(field: string, isNegatedField: boolean) {\n        const { column, columnJSON, found, propertyType } = await this.getColumnForField(field);\n        if (!found) {\n            return this.NOT_FOUND_QUERY;\n        }\n        if (propertyType === JSDataType.JSON) {\n            return `notEmpty(${columnJSON?.string}) ${isNegatedField ? '!' : ''}= 1`;\n        }\n        return `notEmpty(${column}) ${isNegatedField ? '!' : ''}= 1`;\n    }\n\n    async gte(field: string, term: string) {\n        const { column, columnJSON, found, propertyType } = await this.getColumnForField(field);\n        if (!found) {\n            return this.NOT_FOUND_QUERY;\n        }\n        if (propertyType === JSDataType.JSON) {\n            return SqlString.format(`(${columnJSON?.number} >= ?)`, [term]);\n        }\n        return SqlString.format(`(${column} >= ?)`, [term]);\n    }\n\n    async lte(field: string, term: string) {\n        const { column, columnJSON, found, propertyType } = await this.getColumnForField(field);\n        if (!found) {\n            return this.NOT_FOUND_QUERY;\n        }\n        if (propertyType === JSDataType.JSON) {\n            return SqlString.format(`(${columnJSON?.number} <= ?)`, [term]);\n        }\n        return SqlString.format(`(${column} <= ?)`, [term]);\n    }\n\n    async lt(field: string, term: string) {\n        const { column, columnJSON, found, propertyType } = await this.getColumnForField(field);\n        if (!found) {\n            return this.NOT_FOUND_QUERY;\n        }\n        if (propertyType === JSDataType.JSON) {\n            return SqlString.format(`(${columnJSON?.number} < ?)`, [term]);\n        }\n        return SqlString.format(`(${column} < ?)`, [term]);\n    }\n\n    async gt(field: string, term: string) {\n        const { column, columnJSON, found, propertyType } = await this.getColumnForField(field);\n        if (!found) {\n            return this.NOT_FOUND_QUERY;\n        }\n        if (propertyType === JSDataType.JSON) {\n            return SqlString.format(`(${columnJSON?.number} > ?)`, [term]);\n        }\n        return SqlString.format(`(${column} > ?)`, [term]);\n    }\n\n    private attemptToParseNumber(term: string): string | number {\n        const number = Number.parseFloat(term);\n        if (Number.isNaN(number)) {\n            return term;\n        }\n        return number;\n    }\n\n    private tokenizeTerm(term: string): string[] {\n        return term.split(/[ -/:-@[-`{-~\\t\\n\\r]+/).filter(t => t.length > 0);\n    }\n\n    private termHasSeperators(term: string): boolean {\n        return term.match(/[ -/:-@[-`{-~\\t\\n\\r]+/) != null;\n    }\n\n    async fieldSearch(\n        field: string,\n        term: string,\n        isNegatedField: boolean,\n        prefixWildcard: boolean,\n        suffixWildcard: boolean,\n        isPhrase: boolean,\n    ) {\n        const isImplicitField = field === IMPLICIT_FIELD;\n        const { column, found, propertyType, supportsTextSearch, sourceColumn, implicitTargets } =\n            await this.getColumnForField(field);\n        if (!found) {\n            return this.NOT_FOUND_QUERY;\n        }\n\n        if (propertyType === JSDataType.Bool) {\n            const normTerm = `${term}`.trim().toLowerCase();\n            return SqlString.format(`(?? ${isNegatedField ? '!' : ''}= ?)`, [\n                column,\n                normTerm === 'true' ? 1 : normTerm === 'false' ? 0 : parseInt(normTerm, 10),\n            ]);\n        } else if (propertyType === JSDataType.Number) {\n            return SqlString.format(`(?? ${isNegatedField ? '!' : ''}= CAST(?, 'Float64'))`, [column, term]);\n        } else if (propertyType === JSDataType.JSON && supportsTextSearch === false) {\n            return this.NOT_FOUND_QUERY;\n        }\n\n        if (term.length === 0) {\n            return '(1=1)';\n        }\n\n        if (isImplicitField) {\n            if (implicitTargets && implicitTargets.length > 0) {\n                const usePhrasePrefix = !isPhrase && suffixWildcard && !prefixWildcard;\n                const matchTerm = isPhrase\n                    ? term\n                    : usePhrasePrefix\n                        ? term\n                        : `${prefixWildcard ? '*' : ''}${term}${suffixWildcard ? '*' : ''}`;\n                const clauses = implicitTargets\n                    .map(target => {\n                        if (!target) {\n                            return null;\n                        }\n\n                        if (\n                            isPhrase &&\n                            target.propertyType !== JSDataType.String &&\n                            target.propertyType !== JSDataType.JSON\n                        ) {\n                            return null;\n                        }\n\n                        if (\n                            (target.propertyType === JSDataType.String || target.propertyType === JSDataType.JSON) &&\n                            target.supportsTextSearch\n                        ) {\n                            const identifier = target.sourceColumn ?? target.column;\n                            if (!identifier) {\n                                return null;\n                            }\n                            const operator = isPhrase\n                                ? 'MATCH_PHRASE'\n                                : usePhrasePrefix\n                                    ? 'MATCH_PHRASE_PREFIX'\n                                    : 'MATCH_ANY';\n                            return SqlString.format(`(?? ${operator} ?)`, [identifier, matchTerm]);\n                        }\n\n                        if (target.propertyType === JSDataType.Number) {\n                            const identifier = target.sourceColumn ?? target.column;\n                            if (!identifier) {\n                                return null;\n                            }\n                            return SqlString.format(`(?? = CAST(?, 'Float64'))`, [identifier, term]);\n                        }\n\n                        if (target.propertyType === JSDataType.Bool) {\n                            const identifier = target.sourceColumn ?? target.column;\n                            if (!identifier) {\n                                return null;\n                            }\n                            const normTerm = `${term}`.trim().toLowerCase();\n                            const boolValue =\n                                normTerm === 'true' ? 1 : normTerm === 'false' ? 0 : parseInt(normTerm, 10);\n                            return SqlString.format(`(?? = ?)`, [identifier, boolValue]);\n                        }\n\n                        return null;\n                    })\n                    .filter((clause): clause is string => clause != null);\n\n                if (clauses.length === 0) {\n                    return this.NOT_FOUND_QUERY;\n                }\n\n                const orClause = clauses.join(' OR ');\n                const wrapped = clauses.length === 1 ? clauses[0] : `(${orClause})`;\n\n                if (isNegatedField) {\n                    return `(NOT ${wrapped})`;\n                }\n\n                return wrapped;\n            }\n\n            if (column) {\n                if (prefixWildcard || suffixWildcard) {\n                    return SqlString.format(\n                        `(lower(?) ${isNegatedField ? 'NOT ' : ''}LIKE lower(?))`,\n                        [\n                            SqlString.raw(column ?? ''),\n                            `${prefixWildcard ? '%' : ''}${term}${suffixWildcard ? '%' : ''}`,\n                        ],\n                    );\n                } else {\n                    const hasSeperators = this.termHasSeperators(term);\n                    if (hasSeperators) {\n                        const tokens = this.tokenizeTerm(term);\n                        return `(${isNegatedField ? 'NOT (' : ''}${[\n                            ...tokens.map(token =>\n                                SqlString.format(`hasToken(lower(?), lower(?))`, [SqlString.raw(column ?? ''), token]),\n                            ),\n                            SqlString.format(`(lower(?) LIKE lower(?))`, [SqlString.raw(column ?? ''), `%${term}%`]),\n                        ].join(' AND ')}${isNegatedField ? ')' : ''})`;\n                    }\n\n                    return SqlString.format(\n                        `(${isNegatedField ? 'NOT ' : ''}hasToken(lower(?), lower(?)))`,\n                        [SqlString.raw(column ?? ''), term],\n                    );\n                }\n            }\n\n            return this.NOT_FOUND_QUERY;\n        } else {\n            if (supportsTextSearch === false) {\n                return this.NOT_FOUND_QUERY;\n            }\n\n            const searchTarget = column && column.length > 0 ? column : sourceColumn;\n            if (!searchTarget) {\n                return this.NOT_FOUND_QUERY;\n            }\n\n            const usePhrasePrefix = !isPhrase && suffixWildcard && !prefixWildcard;\n            const matchTerm = isPhrase\n                ? term\n                : usePhrasePrefix\n                    ? term\n                    : `${prefixWildcard ? '*' : ''}${term}${suffixWildcard ? '*' : ''}`;\n            const operator = isPhrase\n                ? 'MATCH_PHRASE'\n                : usePhrasePrefix\n                    ? 'MATCH_PHRASE_PREFIX'\n                    : 'MATCH_ANY';\n            return SqlString.format(`(? ${isNegatedField ? 'NOT ' : ''}${operator} ?)`, [\n                SqlString.raw(searchTarget),\n                matchTerm,\n            ]);\n        }\n    }\n\n    async range(field: string, start: string, end: string, isNegatedField: boolean) {\n        const { column, found } = await this.getColumnForField(field);\n        if (!found) {\n            return this.NOT_FOUND_QUERY;\n        }\n        return SqlString.format(`(${column} ${isNegatedField ? 'NOT ' : ''}BETWEEN ? AND ?)`, [\n            this.attemptToParseNumber(start),\n            this.attemptToParseNumber(end),\n        ]);\n    }\n}\n\nexport type CustomSchemaConfig = {\n    databaseName: string;\n    implicitColumnExpression?: string;\n    tableName: string;\n    connectionId: string;\n    datasourceType?: string;\n};\n\nexport class CustomSchemaSQLSerializerV2 extends SQLSerializer {\n    private tableName: string;\n    private databaseName: string;\n    private implicitColumnExpression?: string;\n    private connectionId: string;\n    private datasourceType?: string;\n    private legacyMetadataProvider?: LegacyMetadataProvider;\n    private columnMetadataCache = new Map<string, ColumnLookup | null>();\n    private invertedIndexColumns?: Set<string>;\n    private invertedIndexColumnsPromise?: Promise<Set<string>>;\n\n    constructor({\n        metadata,\n        databaseName,\n        tableName,\n        connectionId,\n        implicitColumnExpression,\n        datasourceType,\n    }: { metadata?: LegacyMetadataProvider } & CustomSchemaConfig) {\n        super();\n        this.legacyMetadataProvider = metadata;\n        this.databaseName = databaseName;\n        this.tableName = tableName;\n        this.implicitColumnExpression = implicitColumnExpression;\n        this.connectionId = connectionId;\n        this.datasourceType = datasourceType;\n    }\n\n    private async fetchColumnMetadata(column: string): Promise<ColumnLookup | null> {\n        if (this.columnMetadataCache.has(column)) {\n            return this.columnMetadataCache.get(column) ?? null;\n        }\n\n        let resolved: ColumnLookup | null = null;\n\n        try {\n            const result = await getColumnMetadata({\n                connectionId: this.connectionId,\n                database: this.databaseName,\n                table: this.tableName,\n                column,\n                datasourceType: this.datasourceType,\n            });\n\n            if (result) {\n                resolved = {\n                    name: result.name,\n                    type: result.normalizedType || result.columnType || result.dataType || 'Unknown',\n                    dataType: result.dataType,\n                    columnType: result.columnType,\n                };\n            }\n        } catch (error) {\n            // ignore service errors and fallback to legacy metadata provider if available\n        }\n\n        if (!resolved && this.legacyMetadataProvider?.getColumn) {\n            try {\n                const legacy = await this.legacyMetadataProvider.getColumn({\n                    databaseName: this.databaseName,\n                    tableName: this.tableName,\n                    column,\n                    connectionId: this.connectionId,\n                });\n\n                if (legacy) {\n                    resolved = {\n                        name: legacy.name,\n                        type: legacy.type || 'Unknown',\n                    };\n                }\n            } catch (legacyError) {\n                // swallow legacy metadata errors\n            }\n        }\n\n        this.columnMetadataCache.set(column, resolved);\n        return resolved;\n    }\n\n    private async loadInvertedIndexColumns(): Promise<Set<string>> {\n        if (this.invertedIndexColumns) {\n            return this.invertedIndexColumns;\n        }\n\n        if (!this.invertedIndexColumnsPromise) {\n            this.invertedIndexColumnsPromise = (async () => {\n                try {\n                    const columns = await getInvertedIndexColumns({\n                        connectionId: this.connectionId,\n                        database: this.databaseName,\n                        table: this.tableName,\n                        datasourceType: this.datasourceType,\n                    });\n                    return new Set(columns.map(name => name.toLowerCase()));\n                } catch (error) {\n                    return new Set<string>();\n                }\n            })();\n        }\n\n        const resolved = await this.invertedIndexColumnsPromise;\n        this.invertedIndexColumns = resolved;\n        return resolved;\n    }\n\n    private async columnHasInvertedIndex(column: string): Promise<boolean> {\n        if (!column) {\n            return false;\n        }\n\n        const indexes = await this.loadInvertedIndexColumns();\n        return indexes.has(column.toLowerCase());\n    }\n\n    private async buildColumnExpressionFromField(field: string) {\n        const exactMatch = await this.fetchColumnMetadata(field);\n\n        if (exactMatch) {\n            return {\n                found: true,\n                columnType: exactMatch.type,\n                columnExpression: exactMatch.name,\n                sourceColumn: exactMatch.name,\n            };\n        }\n\n        const fieldPrefix = field.split('.')[0];\n        const prefixMatch = await this.fetchColumnMetadata(fieldPrefix);\n\n        if (prefixMatch) {\n            const fieldPostfix = field.split('.').slice(1).join('.');\n\n            if (prefixMatch.type.startsWith('Map')) {\n                const valueType = prefixMatch.type.match(/,\\s+(\\w+)\\)$/)?.[1];\n                return {\n                    found: true,\n                    columnExpression: SqlString.format(`??[?]`, [prefixMatch.name, fieldPostfix]),\n                    columnType: valueType ?? 'Unknown',\n                    sourceColumn: prefixMatch.name,\n                };\n            } else if (prefixMatch.type.startsWith('JSON')) {\n                return {\n                    found: true,\n                    columnExpression: '',\n                    columnExpressionJSON: {\n                        string: SqlString.format(`toString(??)`, [field]),\n                        number: SqlString.format(`dynamicType(??) in (?) and ??`, [\n                            field,\n                            CLICK_HOUSE_JSON_NUMBER_TYPES,\n                            field,\n                        ]),\n                    },\n                    columnType: 'JSON',\n                    sourceColumn: prefixMatch.name,\n                };\n            } else if (prefixMatch.type === 'String') {\n                const nestedPaths = fieldPostfix.split('.');\n                return {\n                    found: true,\n                    columnExpression: SqlString.format(\n                        `JSONExtractString(??, ${Array(nestedPaths.length).fill('?').join(',')})`,\n                        [prefixMatch.name, ...nestedPaths],\n                    ),\n                    columnType: 'String',\n                    sourceColumn: prefixMatch.name,\n                };\n            }\n\n            throw new Error('Unsupported column type for prefix match');\n        }\n\n        return {\n            found: true,\n            columnExpression: field,\n            columnType: 'Unknown',\n            sourceColumn: field,\n        };\n    }\n\n    async getColumnForField(field: string) {\n        if (field === IMPLICIT_FIELD) {\n            if (!this.implicitColumnExpression) {\n                throw new Error('Can not search bare text without an implicit column set.');\n            }\n\n            const expressions = splitAndTrimWithBracket(this.implicitColumnExpression);\n            const implicitFieldCandidates = Array.from(\n                new Set(\n                    expressions\n                        .reduce<string[]>((acc, expression) => {\n                            acc.push(...this.extractFieldNamesFromExpression(expression));\n                            return acc;\n                        }, [])\n                        .filter((name): name is string => !!name),\n                ),\n            );\n\n            const implicitTargets: any[] = (\n                await Promise.all(\n                    implicitFieldCandidates.map(async candidate => {\n                        try {\n                            const candidateExpression = await this.buildColumnExpressionFromField(candidate);\n                            const candidatePropertyType =\n                                convertCHTypeToPrimitiveJSType(candidateExpression.columnType) ?? undefined;\n\n                            let candidateSupportsTextSearch: boolean | undefined;\n                            if (\n                                (candidatePropertyType === JSDataType.String ||\n                                    candidatePropertyType === JSDataType.JSON) &&\n                                candidateExpression.sourceColumn &&\n                                candidateExpression.columnExpression === candidateExpression.sourceColumn\n                            ) {\n                                candidateSupportsTextSearch = await this.columnHasInvertedIndex(\n                                    candidateExpression.sourceColumn,\n                                );\n                            } else if (\n                                candidatePropertyType === JSDataType.String ||\n                                candidatePropertyType === JSDataType.JSON\n                            ) {\n                                candidateSupportsTextSearch = false;\n                            }\n\n                            return {\n                                column: candidateExpression.columnExpression,\n                                sourceColumn: candidateExpression.sourceColumn ?? candidate,\n                                propertyType: candidatePropertyType,\n                                supportsTextSearch: candidateSupportsTextSearch,\n                            };\n                        } catch (error) {\n                            return null;\n                        }\n                    }),\n                )\n            ).filter((target) => target !== null);\n\n            return {\n                column:\n                    expressions.length > 1\n                        ? `concatWithSeparator(';',${expressions.join(',')})`\n                        : this.implicitColumnExpression,\n                columnJSON: undefined,\n                propertyType: JSDataType.String,\n                supportsTextSearch: undefined,\n                sourceColumn: undefined,\n                implicitTargets,\n                found: true,\n            };\n        }\n\n        const expression = await this.buildColumnExpressionFromField(field);\n        const propertyType = convertCHTypeToPrimitiveJSType(expression.columnType) ?? undefined;\n\n        let supportsTextSearch: boolean | undefined;\n        if (\n            (propertyType === JSDataType.String || propertyType === JSDataType.JSON) &&\n            expression.sourceColumn &&\n            expression.columnExpression === expression.sourceColumn\n        ) {\n            supportsTextSearch = await this.columnHasInvertedIndex(expression.sourceColumn);\n        } else if (propertyType === JSDataType.String || propertyType === JSDataType.JSON) {\n            supportsTextSearch = false;\n        }\n\n        return {\n            column: expression.columnExpression,\n            columnJSON: expression?.columnExpressionJSON,\n            propertyType,\n            supportsTextSearch,\n            sourceColumn: expression.sourceColumn,\n            implicitTargets: undefined,\n            found: expression.found,\n        };\n    }\n\n    private extractFieldNamesFromExpression(expression: string): string[] {\n        const matches = expression.match(/`([^`]+)`/g);\n        if (!matches) {\n            return [];\n        }\n        return matches.map(match => match.slice(1, -1));\n    }\n}\n","// @ts-ignore: no type declarations for '@hyperdx/lucene'\nimport lucene from '@hyperdx/lucene';\nimport { decodeSpecialTokens, encodeSpecialTokens } from './tokenUtils';\nimport { IMPLICIT_FIELD } from './constants';\nimport { EnglishSerializer, Serializer } from './serializers';\n\nexport function parse(query: string): lucene.AST {\n    return lucene.parse(encodeSpecialTokens(query));\n}\n\nasync function nodeTerm(node: lucene.Node, serializer: Serializer): Promise<string> {\n    const field = node.field[0] === '-' ? node.field.slice(1) : node.field;\n    let isNegatedField = node.field[0] === '-';\n    const isImplicitField = node.field === IMPLICIT_FIELD;\n\n    if ((node as lucene.NodeTerm).term != null) {\n        const nodeTermInstance = node as lucene.NodeTerm;\n        let term = decodeSpecialTokens(nodeTermInstance.term);\n        if (isImplicitField && nodeTermInstance.prefix === '-') {\n            isNegatedField = true;\n        }\n        if (!isImplicitField && nodeTermInstance.prefix === '-') {\n            term = nodeTermInstance.prefix + decodeSpecialTokens(nodeTermInstance.term);\n        }\n\n        if (nodeTermInstance.quoted && !isImplicitField) {\n            return serializer.eq(field, term, isNegatedField);\n        }\n\n        if (!nodeTermInstance.quoted && term === '*') {\n            return serializer.isNotNull(field, isNegatedField);\n        }\n\n        if (!nodeTermInstance.quoted && term.substring(0, 2) === '>=') {\n            if (isNegatedField) {\n                return serializer.lt(field, term.slice(2));\n            }\n            return serializer.gte(field, term.slice(2));\n        }\n        if (!nodeTermInstance.quoted && term.substring(0, 2) === '<=') {\n            if (isNegatedField) {\n                return serializer.gt(field, term.slice(2));\n            }\n            return serializer.lte(field, term.slice(2));\n        }\n        if (!nodeTermInstance.quoted && term[0] === '>') {\n            if (isNegatedField) {\n                return serializer.lte(field, term.slice(1));\n            }\n            return serializer.gt(field, term.slice(1));\n        }\n        if (!nodeTermInstance.quoted && term[0] === '<') {\n            if (isNegatedField) {\n                return serializer.gte(field, term.slice(1));\n            }\n            return serializer.lt(field, term.slice(1));\n        }\n\n        let prefixWildcard = false;\n        let suffixWildcard = false;\n        if (!nodeTermInstance.quoted && term[0] === '*') {\n            prefixWildcard = true;\n            term = term.slice(1);\n        }\n        if (!nodeTermInstance.quoted && term[term.length - 1] === '*') {\n            suffixWildcard = true;\n            term = term.slice(0, -1);\n        }\n\n        return serializer.fieldSearch(field, term, isNegatedField, prefixWildcard, suffixWildcard, nodeTermInstance.quoted);\n    }\n\n    if ((node as lucene.NodeRangedTerm).inclusive != null) {\n        const rangedTerm = node as lucene.NodeRangedTerm;\n        return serializer.range(field, rangedTerm.term_min, rangedTerm.term_max, isNegatedField);\n    }\n\n    throw new Error(`Unexpected Node type. ${node}`);\n}\n\nasync function serialize(ast: lucene.AST | lucene.Node, serializer: Serializer): Promise<string> {\n    if ((ast as lucene.NodeTerm).term != null) {\n        return await nodeTerm(ast as lucene.NodeTerm, serializer);\n    }\n    if ((ast as lucene.NodeRangedTerm).inclusive != null) {\n        return await nodeTerm(ast as lucene.NodeTerm, serializer);\n    }\n\n    if ((ast as lucene.BinaryAST).right != null) {\n        const binaryAST = ast as lucene.BinaryAST;\n        const operator = serializer.operator(binaryAST.operator);\n        const parenthesized = binaryAST.parenthesized;\n        return `${parenthesized ? '(' : ''}${await serialize(binaryAST.left, serializer)} ${operator} ${await serialize(\n            binaryAST.right,\n            serializer,\n        )}${parenthesized ? ')' : ''}`;\n    }\n\n    if ((ast as lucene.LeftOnlyAST).left != null) {\n        const leftOnlyAST = ast as lucene.LeftOnlyAST;\n        const parenthesized = leftOnlyAST.parenthesized;\n        return `${parenthesized ? '(' : ''}${\n            leftOnlyAST.start !== undefined ? `${leftOnlyAST.start} ` : ''\n        }${await serialize(leftOnlyAST.left, serializer)}${parenthesized ? ')' : ''}`;\n    }\n\n    return '';\n}\n\nexport async function genWhereSQL(ast: lucene.AST, serializer: Serializer): Promise<string> {\n    return await serialize(ast, serializer);\n}\n\nexport async function genEnglishExplanation(query: string): Promise<string> {\n    try {\n        const parsedQ = parse(query);\n\n        if (parsedQ) {\n            const serializer = new EnglishSerializer();\n            return await serialize(parsedQ, serializer);\n        }\n    } catch (e) {\n        console.warn('Parse failure', query, e);\n    }\n\n    return `Message containing ${query}`;\n}\n","import { genWhereSQL, parse } from './ast';\nimport { SQLSerializer } from './serializers';\n\nexport { parse, genWhereSQL, genEnglishExplanation } from './ast';\nexport { SQLSerializer, CustomSchemaSQLSerializerV2 } from './serializers';\n\nexport class SearchQueryBuilder {\n    private readonly searchQ: string;\n    private readonly conditions: string[];\n    private serializer: SQLSerializer;\n\n    constructor(searchQ: string, serializer: SQLSerializer) {\n        this.conditions = [];\n        this.searchQ = searchQ;\n        this.serializer = serializer;\n    }\n\n    setSerializer(serializer: SQLSerializer) {\n        this.serializer = serializer;\n        return this;\n    }\n\n    getSerializer() {\n        return this.serializer;\n    }\n\n    private async genSearchQuery() {\n        if (!this.searchQ) {\n            return '';\n        }\n\n        const parsedQ = parse(this.searchQ);\n\n        return await genWhereSQL(parsedQ, this.serializer);\n    }\n\n    and(condition: string) {\n        if (condition && condition.trim()) {\n            this.conditions.push(`(${condition})`);\n        }\n        return this;\n    }\n\n    async build() {\n        const searchQuery = await this.genSearchQuery();\n        if (this.searchQ) {\n            this.and(searchQuery);\n        }\n        return this.conditions.join(' AND ');\n    }\n}\n","import { CustomSchemaSQLSerializerV2, genWhereSQL, parse } from 'utils/query-parser/query-parser';\n\ntype GetWhereSQLParams = {\n    query: string;\n    databaseName: string;\n    tableName: string;\n    connectionId: string;\n    implicitColumnExpression?: string;\n    datasourceType?: string;\n};\n\nexport async function getWhereSQLViaLucene({ query, databaseName, tableName, connectionId, implicitColumnExpression, datasourceType }: GetWhereSQLParams): Promise<string> {\n    const trimmedQuery = query?.trim();\n    if (!trimmedQuery) {\n        return '';\n    }\n\n    const serializer = new CustomSchemaSQLSerializerV2({\n        databaseName,\n        tableName,\n        connectionId,\n        implicitColumnExpression,\n        datasourceType,\n    });\n\n    try {\n        const ast = parse(trimmedQuery);\n        const whereSQL =  await genWhereSQL(ast, serializer);\n        console.log({\n            query,\n            whereSQL,\n        });\n        return whereSQL;\n    } catch (error) {\n        console.error('Failed to generate Lucene WHERE SQL', error);\n        throw error;\n    }\n}\n","import { useCallback } from 'react';\nimport { useAtomValue } from 'jotai';\nimport {\n    currentDatabaseAtom,\n    currentTableAtom,\n    currentTimeFieldAtom,\n    searchTypeAtom,\n    searchValueAtom,\n    selectedDatasourceAtom,\n    tableFieldsAtom,\n} from 'store/discover';\nimport { getWhereSQLViaLucene } from 'services/lucene';\n\nexport function useLuceneWhereClause() {\n    const searchType = useAtomValue(searchTypeAtom);\n    const searchValue = useAtomValue(searchValueAtom);\n    const currentTable = useAtomValue(currentTableAtom);\n    const currentDatabase = useAtomValue(currentDatabaseAtom);\n    const selectdbDS = useAtomValue(selectedDatasourceAtom);\n    const tableFields = useAtomValue(tableFieldsAtom);\n    const currentTimeField = useAtomValue(currentTimeFieldAtom);\n\n    return useCallback(async (): Promise<string> => {\n        if (searchType !== 'Lucene') {\n            return '';\n        }\n\n        const trimmedQuery = searchValue?.trim();\n        if (!trimmedQuery || !currentTable || !currentDatabase || !selectdbDS) {\n            return '';\n        }\n\n        const candidateFieldNames = (tableFields || [])\n            .map((field: any) => {\n                const rawName = field?.Field ?? field?.value ?? field?.name;\n                const type = String(field?.Type ?? '').toUpperCase();\n                if (!rawName) {\n                    return null;\n                }\n\n                if (!type) {\n                    return rawName;\n                }\n\n                return /(CHAR|TEXT|STRING|JSON|VARIANT)/.test(type) ? rawName : null;\n            })\n            .filter(Boolean) as string[];\n\n        const implicitExpressions = candidateFieldNames.slice(0, 10).map(name => `coalesce(\\`${name}\\`, '')`);\n\n        let implicitColumnExpression: string | undefined;\n        if (implicitExpressions.length > 0) {\n            implicitColumnExpression = implicitExpressions.join(',\\n');\n        } else if (currentTimeField) {\n            implicitColumnExpression = `coalesce(\\`${currentTimeField}\\`, '')`;\n        }\n\n        return await getWhereSQLViaLucene({\n            query: trimmedQuery,\n            databaseName: currentDatabase,\n            tableName: currentTable,\n            connectionId: selectdbDS.uid,\n            datasourceType: selectdbDS.type,\n            implicitColumnExpression,\n        });\n    }, [currentDatabase, currentTable, currentTimeField, searchType, searchValue, selectdbDS, tableFields]);\n}\n","import { useCallback, useEffect } from 'react';\nimport { Dayjs } from 'dayjs';\nimport { useAtom, useAtomValue, useSetAtom } from 'jotai';\nimport {\n    currentCatalogAtom,\n    currentDatabaseAtom,\n    currentDateAtom,\n    currentIndexAtom,\n    currentTableAtom,\n    currentTimeFieldAtom,\n    dataFilterAtom,\n    discoverLoadingAtom,\n    intervalAtom,\n    pageAtom,\n    pageSizeAtom,\n    searchTypeAtom,\n    searchValueAtom,\n    selectedDatasourceAtom,\n    tableDataAtom,\n    tableDataChartsAtom,\n    tableFieldsAtom,\n    tableTotalCountAtom,\n    tableTracesDataAtom,\n    topDataAtom,\n} from 'store/discover';\nimport { getTableDataChartsService, getTableDataCountService, getTableDataService, getTopDataService } from 'services/discover';\nimport { getTableDataTraceService } from 'services/traces';\nimport {\n    encodeBase64,\n    getChartsData,\n    convertColumnToRow,\n    convertColumnToRowViaFieldsType,\n    generateHighlightedResults,\n    formatTracesResData,\n    getIndexesStatement,\n} from 'utils/data';\nimport { generateTableDataUID } from 'utils/utils';\nimport { message } from 'antd';\nimport { FORMAT_DATE, getAutoInterval, IntervalEnum } from '../../constants';\nimport { toDataFrame } from '@grafana/data';\nimport { useLuceneWhereClause } from './useLuceneWhereClause';\n\ntype RefreshOptions = {\n    skipPageReset?: boolean;\n};\n\nexport function useDiscoverData() {\n    const [page, setPage] = useAtom(pageAtom);\n    const pageSize = useAtomValue(pageSizeAtom);\n    const setTableData = useSetAtom(tableDataAtom);\n    const setTableDataCharts = useSetAtom(tableDataChartsAtom);\n    const selectdbDS = useAtomValue(selectedDatasourceAtom);\n    const currentTimeField = useAtomValue(currentTimeFieldAtom);\n    const interval = useAtomValue(intervalAtom);\n    const currentIndexes = useAtomValue(currentIndexAtom);\n    const tableFields = useAtomValue(tableFieldsAtom);\n    const searchType = useAtomValue(searchTypeAtom);\n    const dataFilter = useAtomValue(dataFilterAtom);\n    const searchValue = useAtomValue(searchValueAtom);\n    const setTopData = useSetAtom(topDataAtom);\n    const currentTable = useAtomValue(currentTableAtom);\n    const currentCatalog = useAtomValue(currentCatalogAtom);\n    const currentDatabase = useAtomValue(currentDatabaseAtom);\n    const currentDate = useAtomValue(currentDateAtom);\n    const setTableTotalCount = useSetAtom(tableTotalCountAtom);\n    const setTraceData = useSetAtom(tableTracesDataAtom);\n    const [loading, setLoading] = useAtom(discoverLoadingAtom);\n    const buildLuceneWhereClause = useLuceneWhereClause();\n\n    const getTableData = useCallback(async () => {\n        if (!currentTable || !currentDatabase || !selectdbDS) {\n            return;\n        }\n        setLoading(prev => ({ ...prev, getTableData: true }));\n        const indexesStatement = getIndexesStatement(currentIndexes, tableFields, searchValue);\n        const payload: any = {\n            catalog: currentCatalog,\n            database: currentDatabase,\n            table: currentTable,\n            timeField: currentTimeField,\n            startDate: currentDate[0]?.format(FORMAT_DATE),\n            endDate: (currentDate[1] as Dayjs).format(FORMAT_DATE),\n            cluster: '',\n            sort: 'DESC',\n            search_type: searchType,\n            indexes: '',\n            page: page,\n            page_size: pageSize,\n        };\n\n        if (searchType === 'Search') {\n            payload.indexes_statement = indexesStatement;\n        }\n        payload.data_filters = dataFilter.length > 0 ? dataFilter : [];\n\n        if (searchType === 'Lucene') {\n            try {\n                const luceneWhere = await buildLuceneWhereClause();\n                if (luceneWhere) {\n                    payload.lucene_where = luceneWhere;\n                }\n            } catch (error) {\n                setLoading(prev => ({ ...prev, getTableData: false }));\n                setTableData([]);\n                console.error('Lucene query build failed', error);\n                return;\n            }\n        }\n\n        if (searchValue && searchType !== 'Lucene') {\n            payload.search_value = searchType === 'Search' ? encodeBase64(searchValue) : searchValue;\n        }\n\n        getTableDataService({\n            selectdbDS,\n            ...payload,\n        }).subscribe({\n            next: async ({ data, ok }: any) => {\n                setLoading(prev => ({ ...prev, getTableData: false }));\n                if (!ok) {\n                    // Clear table data when backend reports failure so UI does not display stale results\n                    setTableData([]);\n                    return;\n                }\n                const frames = data?.results?.getTableData?.frames;\n                if (!frames || !frames[0]) {\n                    setTableData([]);\n                    return;\n                }\n                const rowsData = convertColumnToRow(frames[0]);\n                const resData = generateHighlightedResults(\n                    {\n                        search_value: searchValue,\n                        indexes: currentIndexes || [],\n                    },\n                    rowsData,\n                );\n\n                const rowsDataWithUid = await generateTableDataUID(resData);\n                setTableData(rowsDataWithUid);\n            },\n            error: (err: any) => {\n                setLoading(prev => ({ ...prev, getTableData: false }));\n                // Clear table data on network / connection errors to ensure UI refreshes\n                setTableData([]);\n                console.log('Fetch Error', err);\n            },\n        });\n    }, [\n        buildLuceneWhereClause,\n        currentCatalog,\n        currentDate,\n        currentDatabase,\n        currentIndexes,\n        currentTable,\n        currentTimeField,\n        dataFilter,\n        page,\n        pageSize,\n        searchType,\n        searchValue,\n        selectdbDS,\n        setLoading,\n        setTableData,\n        tableFields,\n    ]);\n\n    const getTableDataCharts = useCallback(async () => {\n        if (!currentTable || !currentDatabase || !selectdbDS) {\n            return;\n        }\n        setLoading(prev => ({ ...prev, getTableDataCharts: true }));\n        const autoInterval = getAutoInterval(currentDate as any);\n        const timeInterval = interval === IntervalEnum.Auto ? autoInterval.interval_unit : interval;\n        const timeIntervalValue = interval === IntervalEnum.Auto ? autoInterval.interval_value : 1;\n        const indexesStatement = getIndexesStatement(currentIndexes, tableFields, searchValue);\n        const payload: any = {\n            catalog: 'internal',\n            database: currentDatabase,\n            table: currentTable,\n            timeField: currentTimeField,\n            startDate: currentDate[0]?.format(FORMAT_DATE),\n            endDate: (currentDate[1] as Dayjs).format(FORMAT_DATE),\n            cluster: '',\n            data_filters: [],\n            sort: 'DESC',\n            interval: timeInterval,\n            interval_value: timeIntervalValue,\n            search_type: searchType,\n            indexes: indexesStatement,\n        };\n\n        if (dataFilter.length > 0) {\n            payload.data_filters = dataFilter;\n        }\n\n        if (searchType === 'Lucene') {\n            try {\n                const luceneWhere = await buildLuceneWhereClause();\n                if (luceneWhere) {\n                    payload.lucene_where = luceneWhere;\n                }\n            } catch (error) {\n                setLoading(prev => ({ ...prev, getTableDataCharts: false }));\n                setTableDataCharts([]);\n                console.error('Lucene query build failed', error);\n                return;\n            }\n        }\n\n        if (searchValue && searchType !== 'Lucene') {\n            payload.search_value = searchType === 'Search' ? encodeBase64(searchValue) : searchValue;\n        }\n\n        getTableDataChartsService({\n            selectdbDS,\n            ...payload,\n        }).subscribe({\n            next: ({ data, ok }: any) => {\n                setLoading(prev => ({ ...prev, getTableDataCharts: false }));\n                if (!ok) {\n                    // Clear charts when backend reports failure\n                    setTableDataCharts([]);\n                    return;\n                }\n                const frame = toDataFrame(data.results.getTableDataCharts.frames[0]);\n                const times = Array.from(frame?.fields[0]?.values || []);\n                const values = Array.from(frame?.fields[1]?.values || []);\n                if (!times.length || !values.length) {\n                    setTableDataCharts([]);\n                    return;\n                }\n                const tableDataCharts = times.map((item: any, index: number) => ({\n                    TT: item,\n                    'sum(cnt)': values[index],\n                }));\n                const chartsData = getChartsData(tableDataCharts, currentDate as [Dayjs, Dayjs]);\n                setTableDataCharts(chartsData);\n            },\n            error: (err: any) => {\n                setLoading(prev => ({ ...prev, getTableDataCharts: false }));\n                // Clear charts on network / connection errors\n                setTableDataCharts([]);\n                console.log('Fetch Error', err);\n            },\n        });\n    }, [\n        buildLuceneWhereClause,\n        currentDate,\n        currentDatabase,\n        currentIndexes,\n        currentTable,\n        currentTimeField,\n        dataFilter,\n        interval,\n        searchType,\n        searchValue,\n        selectdbDS,\n        setLoading,\n        setTableDataCharts,\n        tableFields,\n    ]);\n\n    const getTopData = useCallback(async () => {\n        if (!currentTable || !currentDatabase || !selectdbDS) {\n            return;\n        }\n        const indexesStatement = getIndexesStatement(currentIndexes, tableFields, searchValue);\n        const payload: any = {\n            catalog: currentCatalog,\n            database: currentDatabase,\n            table: currentTable,\n            timeField: currentTimeField,\n            startDate: currentDate[0]?.format(FORMAT_DATE),\n            endDate: (currentDate[1] as Dayjs).format(FORMAT_DATE),\n            cluster: '',\n            sort: 'DESC',\n            search_type: searchType,\n            indexes: '',\n            page: page,\n            page_size: 500,\n        };\n\n        if (searchType === 'Search') {\n            payload.indexes_statement = indexesStatement;\n        }\n        payload.data_filters = dataFilter.length > 0 ? dataFilter : [];\n\n        if (searchValue && searchType !== 'Lucene') {\n            payload.search_value = searchType === 'Search' ? encodeBase64(searchValue) : searchValue;\n        }\n\n        if (searchType === 'Lucene') {\n            try {\n                const luceneWhere = await buildLuceneWhereClause();\n                if (luceneWhere) {\n                    payload.lucene_where = luceneWhere;\n                }\n            } catch (error) {\n                console.error('Lucene query build failed', error);\n                setTopData([]);\n                return;\n            }\n        }\n\n        getTopDataService({\n            selectdbDS,\n            ...payload,\n        }).subscribe({\n            next: ({ data, ok }: any) => {\n                if (!ok) {\n                    return;\n                }\n                const frames = data?.results?.getTableTopData?.frames;\n                if (!frames || !frames[0]) {\n                    setTopData([]);\n                    return;\n                }\n                const rowsData = convertColumnToRowViaFieldsType(frames[0], tableFields);\n                setTopData(rowsData);\n            },\n            error: (err: any) => {\n                console.log('Fetch Error', err);\n                setTopData([]);\n            },\n        });\n    }, [\n        buildLuceneWhereClause,\n        currentCatalog,\n        currentDate,\n        currentDatabase,\n        currentIndexes,\n        currentTable,\n        currentTimeField,\n        dataFilter,\n        page,\n        searchType,\n        searchValue,\n        selectdbDS,\n        setTopData,\n        tableFields,\n    ]);\n\n    const getTableDataCount = useCallback(async () => {\n        if (!currentTable || !currentDatabase || !selectdbDS) {\n            return;\n        }\n        const autoInterval = getAutoInterval(currentDate as any);\n        const timeInterval = interval === IntervalEnum.Auto ? autoInterval.interval_unit : interval;\n        const timeIntervalValue = interval === IntervalEnum.Auto ? autoInterval.interval_value : 1;\n        const indexesStatement = getIndexesStatement(currentIndexes, tableFields, searchValue);\n        const payload: any = {\n            catalog: 'internal',\n            database: currentDatabase,\n            table: currentTable,\n            timeField: currentTimeField,\n            startDate: currentDate[0]?.format(FORMAT_DATE),\n            endDate: (currentDate[1] as Dayjs).format(FORMAT_DATE),\n            cluster: '',\n            sort: 'DESC',\n            interval: timeInterval,\n            data_filters: [],\n            interval_value: timeIntervalValue,\n            search_type: searchType,\n            indexes: indexesStatement,\n        };\n\n        if (dataFilter.length > 0) {\n            payload.data_filters = dataFilter;\n        }\n\n        if (searchType === 'Lucene') {\n            try {\n                const luceneWhere = await buildLuceneWhereClause();\n                if (luceneWhere) {\n                    payload.lucene_where = luceneWhere;\n                }\n            } catch (error) {\n                console.error('Lucene query build failed', error);\n                setTableTotalCount(0);\n                return;\n            }\n        }\n\n        if (searchValue && searchType !== 'Lucene') {\n            payload.search_value = searchType === 'Search' ? encodeBase64(searchValue) : searchValue;\n        }\n\n        getTableDataCountService({\n            selectdbDS,\n            ...payload,\n        }).subscribe({\n            next: ({ data, ok }: any) => {\n                setLoading(prev => ({ ...prev, getTableDataCount: false }));\n                if (!ok) {\n                    // Clear count when backend reports failure\n                    setTableTotalCount(0);\n                    return;\n                }\n                const frame = toDataFrame(data.results.getTableCountData.frames[0]);\n                const totalCount = frame.fields[0]?.values[0] as number;\n                if (!totalCount) {\n                    setTableTotalCount(0);\n                    return;\n                }\n                setTableTotalCount(totalCount);\n            },\n            error: (err: any) => {\n                // Ensure we clear the count on error so UI doesn't keep previous value\n                setTableTotalCount(0);\n                console.log('Fetch Error', err);\n            },\n        });\n    }, [\n        buildLuceneWhereClause,\n        currentDate,\n        currentDatabase,\n        currentIndexes,\n        currentTable,\n        currentTimeField,\n        dataFilter,\n        interval,\n        searchType,\n        searchValue,\n        selectdbDS,\n        setTableTotalCount,\n        tableFields,\n    ]);\n\n    const getTraceData = useCallback(\n        (trace_id: string, table?: string, callback?: Function) => {\n            const indexesStatement = getIndexesStatement(currentIndexes, tableFields, searchValue);\n            const payload: any = {\n                catalog: currentCatalog,\n                database: currentDatabase,\n                table: table || currentTable || 'otel_traces',\n                timeField: currentTimeField,\n                startDate: currentDate[0]?.format(FORMAT_DATE),\n                endDate: (currentDate[1] as Dayjs).format(FORMAT_DATE),\n                cluster: '',\n                sort: 'DESC',\n                search_type: searchType,\n                indexes: '',\n                page: page,\n                page_size: pageSize,\n                trace_id,\n            };\n            if (searchType === 'Search') {\n                payload.indexes_statement = indexesStatement;\n            }\n\n            payload.data_filters = dataFilter.length > 0 ? dataFilter : [];\n\n            if (searchValue) {\n                payload.search_value = encodeBase64(searchValue);\n            }\n\n            getTableDataTraceService({\n                selectdbDS,\n                ...payload,\n            }).subscribe({\n                next: ({ data, ok }: any) => {\n                    callback && callback(data.results.getTableDataTrace.status)\n                    if (!ok) {\n                        message.error('Failed to request trace');\n                        return;\n                    }\n                    const formattedData = formatTracesResData(data.results.getTableDataTrace.frames[0]);\n                    setTraceData(formattedData);\n                },\n                error: (err: any) => {\n                    // Clear trace data on error\n                    setTraceData([]);\n                    console.log('Fetch Error', err);\n                    callback && callback(err.status)\n                    message.error('Failed to request trace');\n                    setTraceData(null);\n                },\n            });\n        },\n        [\n            currentCatalog,\n            currentDate,\n            currentDatabase,\n            currentIndexes,\n            currentTable,\n            currentTimeField,\n            dataFilter,\n            page,\n            pageSize,\n            searchType,\n            searchValue,\n            selectdbDS,\n            setTraceData,\n            tableFields,\n        ],\n    );\n\n    const clearData = useCallback(() => {\n        setTableDataCharts([]);\n        setTableTotalCount(0);\n        setTableData([]);\n        setTopData([]);\n    }, [setTableData, setTableDataCharts, setTableTotalCount, setTopData]);\n\n    const refreshData = useCallback(\n        ({ skipPageReset = false }: RefreshOptions = {}) => {\n            if (!skipPageReset) {\n                setPage(1);\n            }\n            if (!currentTimeField) {\n                clearData();\n                return;\n            }\n            void getTableDataCharts();\n            void getTableDataCount();\n            void getTableData();\n            void getTopData();\n        },\n        [\n            clearData,\n            currentTimeField,\n            getTableData,\n            getTableDataCharts,\n            getTableDataCount,\n            getTopData,\n            setPage,\n        ],\n    );\n\n    const handleQuerying = useCallback(() => {\n        if (!currentTimeField) {\n            clearData();\n            return;\n        }\n        refreshData();\n    }, [clearData, currentTimeField, refreshData]);\n\n    useEffect(() => {\n        if (!currentTimeField) {\n            return;\n        }\n        void getTableData();\n        void getTopData();\n        void getTableDataCharts();\n        void getTableDataCount();\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [currentTimeField, page]);\n\n    useEffect(() => {\n        refreshData({ skipPageReset: false });\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [currentDate, currentTimeField, dataFilter, interval]);\n\n    return {\n        loading,\n        onQuerying: handleQuerying,\n        getTraceData,\n    };\n}\n","import React from 'react';\nimport { css } from '@emotion/css';\nimport { PluginPage } from '@grafana/runtime';\nimport { LoadingBar, useTheme2 } from '@grafana/ui';\n\nimport DiscoverFilter from 'components/discover-filter';\nimport DiscoverSidebar from 'components/discover-sidebar';\nimport { DiscoverHistogram } from 'components/discover-histogram';\nimport DiscoverContent from 'components/discover-content';\nimport DiscoverHeader from '../components/discover-header';\nimport { testIds } from '../components/testIds';\nimport { useDiscoverData } from './PageDiscover/useDiscoverData';\n\nexport default function PageDiscover() {\n    const theme = useTheme2();\n    const { loading, onQuerying, getTraceData } = useDiscoverData();\n\n    return (\n        <div\n            className={css`\n                & > div > div {\n                    background-color: ${theme.isDark ? '#111217' : '#F4F5F5'};\n                    padding: 0 1rem;\n                }\n            `}\n        >\n            <PluginPage pageNav={{ text: '' }}>\n                <div data-testid={testIds.pageTwo.container}>\n                    <DiscoverHeader onQuerying={onQuerying} loading={loading.getTableData || loading.getTableDataCharts} />\n                    <DiscoverFilter />\n                </div>\n                <section\n                    className={css`\n                        display: grid;\n                        grid-template-columns: 2fr 8fr;\n                        grid-template-rows: 1fr;\n                        grid-template-areas: 'sidebar content';\n                        padding-top: 0.5rem;\n                        gap: 0.5rem;\n                    `}\n                >\n                    <div\n                        style={{\n                            height: 'calc(100vh - 210px)',\n                        }}\n                    >\n                        <DiscoverSidebar />\n                    </div>\n                    <div\n                        className={css`\n                            grid-area: content;\n                            display: flex;\n                            flex-direction: column;\n                            overflow: auto;\n                            height: calc(100vh - 210px);\n                            background-color: ${theme.isDark ? 'rgb(24, 27, 31)' : '#FFF'};\n                            position: relative;\n                            padding: 16px 0;\n                        `}\n                    >\n                        <div style={{ position: 'absolute', top: 0, width: '100%' }}>{loading.getTableDataCharts && <LoadingBar width={100} />}</div>\n                        <DiscoverHistogram />\n                        <div\n                            className={css`\n                                margin-top: 24px;\n                            `}\n                        >\n                            <DiscoverContent getTraceData={getTraceData} fetchNextPage={() => {}} />\n                        </div>\n                    </div>\n                </section>\n            </PluginPage>\n        </div>\n    );\n}\n","export const testIds = {\n  appConfig: {\n    apiKey: 'data-testid ac-api-key',\n    apiUrl: 'data-testid ac-api-url',\n    submit: 'data-testid ac-submit-form',\n  },\n  pageOne: {\n    container: 'data-testid pg-one-container',\n    navigateToFour: 'data-testid navigate-to-four',\n  },\n  pageTwo: {\n    container: 'data-testid pg-two-container',\n  },\n  pageThree: {\n    container: 'data-testid pg-three-container',\n  },\n  pageFour: {\n    container: 'data-testid pg-four-container',\n    navigateBack: 'data-testid navigate-back',\n  },\n};\n"],"names":["css","styled","DiscoverFilterWrapper","div","containerStyle","rowStyle","colStyle","footerStyle","useAtom","useAtomValue","React","nanoid","Select","InlineField","InlineFieldRow","InlineSwitch","Button","Input","Field","tableFieldsAtom","dataFilterAtom","tableFieldValuesAtom","tableDataAtom","indexesAtom","OPERATORS","getFieldType","Controller","useForm","uniqBy","FilterContent","onHide","dataFilterValue","errors","tableFields","dataFilter","setDataFilter","tableFieldValue","setTableFieldValue","tableData","indexes","control","handleSubmit","watch","register","setValue","formState","defaultValues","field","label","fieldName","value","operator","minValue","Array","isArray","maxValue","showLabel","useEffect","id","prev","changed","updated","map","f","selectedFieldType","useMemo","tf","find","Type","isNumberField","isBooleanField","isTimeField","operatorOptions","normalized","op","matchOnlyOps","allowed","Set","filter","opItem","has","String","isNumberOrTime","v","toLowerCase","includes","hasInverted","some","idx","columnName","t","type","toUpperCase","e","getValue","isNaN","convertValue","undefined","onSubmit","formValues","opField","current","opValue","newValue","newItem","renderFiledComponent","console","log","currentOperator","className","invalid","error","message","required","validate","name","rules","render","isMulti","options","item","placeholder","onChange","selected","s","form","length","_original","variant","onClick","preventDefault","useRef","useState","useTranslation","locationAtom","getFilterSQL","Badge","Icon","IconButton","Toggletip","useTheme2","DiscoverFilter","open","setOpen","dataFilterOpen","setDataFilterOpen","discoverFilterRef","_loc","setLoc","theme","ref","isDark","index","key","toString","show","onOpen","onClose","closeButton","content","placement","text","span","data_filters","searchParams","set","JSON","stringify","color","tooltip","style","marginLeft","FIELD_TYPES","icon","complex","getFieldIcon","columnType","currentColumnType","val","toLocaleUpperCase","clsx","twMerge","cn","inputs","Progress","get","topDataAtom","tableTotalCountAtom","isComplexType","countValueDistribution","jsonArray","valueCountMap","Map","forEach","obj","result","times","valueStr","TopData","topData","tableTotalCount","canDisplayTopData","res","Object","entries","sort","a","b","count","small","toFixed","size","width","height","percent","status","showInfo","stopPropagation","FieldItem","props","children","colors","background","secondary","primary","onAdd","onRemove","searchableAtom","aggregatableAtom","fieldTypeAtom","AGGREGATABLE","SEARCHABLE","RadioButtonGroup","searchable","setSearchable","aggregatable","setAggregatable","fieldType","setFieldType","selectedFieldsAtom","surroundingSelectedFieldsAtom","AggregatableEnum","SearchableEnum","FieldTypeEnum","CollapsableSection","DiscoverSidebar","selectedFields","setSelectedFields","selectedSurroundingFields","setSelectedSurroundingFields","_setSearchable","_setAggregatable","_setFieldType","searchValue","setSearchValue","filteredFields","ANY","YES","NO","hasSelectedFields","availableFields","filed","handleAdd","handleRemove","findIndex","splice","surIndex","target","isOpen","fill","fullWidth","ReactECharts","useSetAtom","dayjs","IntervalEnum","TIME_INTERVALS","getAutoInterval","FORMAT_DATE","translationDateIntervalType","currentDateAtom","discoverCurrentAtom","activeShortcutAtom","tableDataChartsAtom","intervalAtom","pageSizeAtom","pageAtom","timeRangeAtom","DiscoverHistogram","currentDate","setCurrentDate","ReactEChartsInstance","discoverCurrent","setDiscoverCurrent","setActiveItem","tableDataCharts","process","env","NODE_ENV","debugLabel","interval_value","setInterval_value","interval","setInterval","_timeRange","setTimeRange","_pageSize","setPageSize","setPage","timeInterval","Auto","base","Date","oneDay","data","Math","random","i","now","push","round","title","subtext","left","top","grid","right","bottom","containLabel","xAxis","axisLabel","fontSize","fontStyle","fontWeight","axisLine","lineStyle","axisTick","toolbox","brush","xAxisIndex","yAxis","nameTextStyle","align","padding","splitLine","trigger","axisPointer","borderWidth","backgroundColor","formatter","params","html","series","barWidth","animation","chart","handler","areas","startIndex","endIndex","coordRange","interval_unit","chartsEndDate","add","date","timeRange","from","format","to","raw","getEchartsInstance","dispatchAction","command","ele","brushOption","brushType","on","off","replace","selectdbInterval","option","Fragment","flexRender","getCoreRowModel","getExpandedRowModel","useReactTable","EmptySearchResult","SDCollapsibleTable","columns","renderSubComponent","getRowCanExpand","table","thead","getHeaderGroups","headerGroup","tr","headers","header","th","colSpan","isLight","isPlaceholder","column","columnDef","getContext","tbody","getRowModel","rows","row","original","getIsExpanded","getVisibleCells","cell","td","HoverStyle","ColumnStyleWrapper","ContentTableActions","fieldValue","hasField","filterValue","display","justifyContent","ContentItem","surroundingDataFilterAtom","SurroundingContentItem","surroundingDataFilter","setSurroundingDataFilter","SurroundingLogsActions","getSurroundingData","getSurroundingDataLoading","time","timeFieldPageSize","tips","aria-label","currentShowLabel","SurroundingDiscoverFilter","getQueryTableResultSQL","indexesStatement","indexes_statement","statement","database","search_type","timeField","startDate","endDate","reduce","curr","addSqlFilter","search_value","lucene_where","page_size","page","getQueryTableChartsSQL","getQueryTableResultCountSQL","getSurroundingSQL","orderSymbol","pageSize","valueString","transformedFieldName","transformFieldPath","sql","fieldPath","parts","split","slice","part","join","getBackendSrv","getTableDataService","payload","selectdbDS","rest","QueryTableResultSQL","response","fetch","url","method","queries","refId","datasource","uid","rawSql","credentials","getTableDataChartsService","QueryTableChartsSQL","getTopDataService","getTableDataCountService","QueryTableResultCountSQL","getSurroundingDataService","surroundingSQL","SurroundingContentTableActions","useRequest","LoadingBar","Tab","TabContent","TabsBar","selectedRowAtom","currentTimeFieldAtom","currentClusterAtom","currentTableAtom","currentCatalogAtom","currentDatabaseAtom","surroundingTableDataAtom","selectedDatasourceAtom","afterCountAtom","afterTimeAtom","afterTimeFieldPageSizeAtom","beforeCountAtom","beforeTimeAtom","beforeTimeFieldPageSizeAtom","sortBy","lastValueFrom","convertColumnToRow","formatTimestampToDateTime","generateTableDataUID","SurroundingLogs","selectedRow","currentTimeField","fields","setFields","currentCluster","currentTable","currentCatalog","currentDatabase","surroundingTableData","setSurroundingTableData","beforeCount","setBeforeCount","afterCount","setAfterCount","beforeTimeFieldPageSize","setBeforeTimeFieldPageSize","afterTimeFieldPageSize","setAfterTimeFieldPageSize","beforeTime","setBeforeTime","afterTime","setAfterTime","state","updateState","active","getAfterResultWrap","_","newResult","loading","getAfterSurroundingDataLoading","run","getAfterSurroundingData","getQueryParams","manual","onSuccess","ok","rowsData","results","frames","generateSurroundingResult","catalog","cluster","getBeforeSurroundingDataLoading","getBeforeSurroundingData","unshift","scrollToSelectedRow","selectedElement","document","getElementById","scrollIntoView","block","behavior","initLoading","prevTimeParams","afterTimeParams","Promise","all","refreshDeps","rowsData1","rowsData2","result1","result2","selectedResult","rowsDataWithUID","setTimeout","onError","err","_source","_uid","renderBeforeLoadingBar","renderAfterLoadingBar","processObject","hasOwnProperty","cleanValue","trim","parse","startsWith","endsWith","parsed","cleanItem","processedData","subTableData","keys","tab","onChangeTab","counter","tableRowStyle","pre","sortedResult","_sourceResult","itemSource","highlightValue","dynamicColumns","accessorKey","getCanExpand","getToggleExpandedHandler","createMarkup","__html","dangerouslySetInnerHTML","cursor","marginTop","position","setTimeFieldPageSize","overflow","Drawer","Pagination","AntButton","Tooltip","TraceDetail","usePluginContext","isValidTimeFieldType","DiscoverContent","fetchNextPage","getTraceData","_setTableData","setSelectedRow","_setPageSize","drawerOpen","setDrawerOpen","surroundingLogsOpen","setSurroundingLogsOpen","_fieldKeyBg","setFieldKeyBg","currentDatasource","context","jsonData","meta","logsConfig","logsTable","targetTraceTable","jumpPage","setJumpPage","isTargetLogTable","useCallback","callback","openTraceDrawer","traceId","fieldInfo","num","Number","handleClick","link","closest","getAttribute","alignItems","gap","currentPage","numberOfPages","ceil","onNavigate","toPage","input","min","step","onKeyDown","total","max","floor","button","trace_id","traceTable","DiscoverHeaderSearch","DiscoverHeaderTimeSelect","CascaderStyle","currentIndexAtom","disabledOptionsAtom","searchTypeAtom","searchValueAtom","selectedIndexesAtom","MultiSelect","SearchType","searchType","setSearchType","disabledOptions","setSelectedIndexes","currentIndex","setCurrentIndex","searchMode","DropdownQueryType","actionMeta","selectedIndexes","selectedValue","marginRight","SQLSearch","onQuerying","native","nativeEvent","isComposing","Lucene","DataSourcePicker","timeFieldsAtom","searchFocusAtom","datasourcesAtom","databasesAtom","tablesAtom","getLatestTime","TimeRangeInput","getDatabases","getFieldsService","getIndexesService","getTablesService","toDataFrame","DiscoverHeader","setIndexes","setTableFields","timeFields","setTimeFields","_currentDate","searchFocus","activeItem","_setActiveItem","selectedDatasource","setSelectedDatasource","setCurrentTable","databases","setDatabases","tables","setTables","_datasources","fetchDatabases","ds","subscribe","next","resp","frame","values","subscription","unsubscribe","getFields","selectedTable","fieldTypes","getIndexes","columnNames","indexesTypes","tableIndexes","noDefault","selectedDatabase","getTables","flex","selectdbTimeFiled","isReversed","start","toDate","end","latestTime","latestStartTime","latestEndTime","disabled","encodeSpecialTokens","query","decodeSpecialTokens","IMPLICIT_FIELD","CLICK_HOUSE_JSON_NUMBER_TYPES","RAW_FLAG","escapeString","escaped","formatDate","pad","padStart","year","getFullYear","month","getMonth","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","escapePrimitive","isRaw","escapeIdentifier","identifier","escapeValue","list","Boolean","__raw","SqlString","JSDataType","convertCHDataTypeToJSType","dataType","convertCHTypeToPrimitiveJSType","jsType","Error","splitAndTrimWithBracket","parenCount","squareCount","inSingleQuote","inDoubleQuote","cur","c","trimString","getColumn","getColumnMetadata","getInvertedIndexColumns","EnglishSerializer","translateField","eq","term","isNegatedField","isNotNull","gte","lte","lt","gt","fieldSearch","prefixWildcard","suffixWildcard","isPhrase","range","SQLSerializer","columnJSON","found","propertyType","supportsTextSearch","sourceColumn","getColumnForField","NOT_FOUND_QUERY","Bool","normTerm","parseInt","string","searchTarget","number","attemptToParseNumber","parseFloat","tokenizeTerm","termHasSeperators","match","isImplicitField","implicitTargets","usePhrasePrefix","matchTerm","clauses","boolValue","clause","orClause","wrapped","hasSeperators","tokens","token","CustomSchemaSQLSerializerV2","fetchColumnMetadata","columnMetadataCache","resolved","connectionId","databaseName","tableName","datasourceType","normalizedType","legacyMetadataProvider","legacy","legacyError","loadInvertedIndexColumns","invertedIndexColumns","invertedIndexColumnsPromise","columnHasInvertedIndex","buildColumnExpressionFromField","exactMatch","columnExpression","fieldPrefix","prefixMatch","fieldPostfix","valueType","columnExpressionJSON","nestedPaths","implicitColumnExpression","expressions","implicitFieldCandidates","acc","expression","extractFieldNamesFromExpression","candidate","candidateExpression","candidatePropertyType","candidateSupportsTextSearch","matches","metadata","lucene","nodeTerm","node","serializer","nodeTermInstance","prefix","quoted","substring","inclusive","rangedTerm","term_min","term_max","serialize","ast","binaryAST","parenthesized","leftOnlyAST","genWhereSQL","genEnglishExplanation","parsedQ","warn","SearchQueryBuilder","setSerializer","getSerializer","genSearchQuery","searchQ","and","condition","conditions","build","searchQuery","getWhereSQLViaLucene","trimmedQuery","whereSQL","useLuceneWhereClause","candidateFieldNames","rawName","test","implicitExpressions","discoverLoadingAtom","tableTracesDataAtom","getTableDataTraceService","encodeBase64","getChartsData","convertColumnToRowViaFieldsType","generateHighlightedResults","formatTracesResData","getIndexesStatement","useDiscoverData","setTableData","setTableDataCharts","currentIndexes","setTopData","setTableTotalCount","setTraceData","setLoading","buildLuceneWhereClause","getTableData","luceneWhere","resData","rowsDataWithUid","getTableDataCharts","autoInterval","timeIntervalValue","TT","chartsData","getTopData","getTableTopData","getTableDataCount","getTableCountData","totalCount","getTableDataTrace","formattedData","clearData","refreshData","skipPageReset","handleQuerying","PluginPage","testIds","PageDiscover","pageNav","data-testid","pageTwo","container","section","appConfig","apiKey","apiUrl","submit","pageOne","navigateToFour","pageThree","pageFour","navigateBack"],"sourceRoot":""}